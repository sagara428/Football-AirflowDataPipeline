[0m13:22:29.468067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f95071b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f951ffc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f94ca0dd0>]}


============================== 13:22:29.473782 | 0e9a9e6f-ac8b-4156-aa55-fde45ed698bd ==============================
[0m13:22:29.473782 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:22:29.475711 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'write_json': 'True', 'target_path': 'None', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None'}
[0m13:22:30.221246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e9a9e6f-ac8b-4156-aa55-fde45ed698bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f92f17a90>]}
[0m13:22:30.236929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e9a9e6f-ac8b-4156-aa55-fde45ed698bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f92f17ad0>]}
[0m13:22:30.239635 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:22:30.290648 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m13:22:30.307984 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:22:30.310038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0e9a9e6f-ac8b-4156-aa55-fde45ed698bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f94f3d390>]}
[0m13:22:33.062636 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_matches.sql
[0m13:22:33.075381 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_players.sql
[0m13:22:33.080574 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_teams.sql
[0m13:22:33.085679 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_tournaments.sql
[0m13:22:33.090619 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_home_win.sql
[0m13:22:33.095837 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_match_results.sql
[0m13:22:33.180180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e9a9e6f-ac8b-4156-aa55-fde45ed698bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f92d22490>]}
[0m13:22:33.198733 [error] [MainThread]: Encountered an error:
Found a cycle: model.international_football.dim_matches
[0m13:22:33.205339 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 584, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/compile.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.international_football.dim_matches

[0m13:22:33.207572 [debug] [MainThread]: Command `dbt run` failed at 13:22:33.207330 after 3.77 seconds
[0m13:22:33.209475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f94f96690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f94ed3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f94d57c50>]}
[0m13:22:33.210909 [debug] [MainThread]: Flushing usage events
[0m13:25:40.546013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeccae4450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecc5dae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeccadd8d0>]}


============================== 13:25:40.551735 | ecc38ca8-b197-4675-8182-59a4b82bef9c ==============================
[0m13:25:40.551735 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:25:40.553353 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'no_print': 'None'}
[0m13:25:40.583528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecc38ca8-b197-4675-8182-59a4b82bef9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeccf4c7d0>]}
[0m13:25:40.591906 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uuqtm6km'
[0m13:25:40.593732 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:25:40.779677 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:25:40.784498 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:25:40.873010 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:25:40.884067 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:25:48.005791 [info ] [MainThread]: Installed from version 1.1.1
[0m13:25:48.007381 [info ] [MainThread]: Up to date!
[0m13:25:48.008927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ecc38ca8-b197-4675-8182-59a4b82bef9c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecd0b9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeccb3be10>]}
[0m13:25:48.010832 [debug] [MainThread]: Command `dbt deps` succeeded at 13:25:48.010633 after 7.50 seconds
[0m13:25:48.012156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecca71090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed0b4bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed0a901d0>]}
[0m13:25:48.013363 [debug] [MainThread]: Flushing usage events
[0m13:26:52.521647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b647ca0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b64c4e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b64c77e50>]}


============================== 13:26:52.527876 | ae1365c4-a613-407d-bf52-8e32822d99db ==============================
[0m13:26:52.527876 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:26:52.530186 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'log_format': 'default', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:52.946006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae1365c4-a613-407d-bf52-8e32822d99db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b64826fd0>]}
[0m13:26:52.961352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae1365c4-a613-407d-bf52-8e32822d99db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b643a3c50>]}
[0m13:26:52.963766 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:26:53.021869 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m13:26:55.304284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:55.306061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:55.312062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae1365c4-a613-407d-bf52-8e32822d99db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b626df210>]}
[0m13:26:55.331460 [error] [MainThread]: Encountered an error:
Found a cycle: model.international_football.dim_matches
[0m13:26:55.334121 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 584, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/compile.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.international_football.dim_matches

[0m13:26:55.336009 [debug] [MainThread]: Command `dbt run` failed at 13:26:55.335675 after 2.86 seconds
[0m13:26:55.337577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b64c61d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b65209cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6887c850>]}
[0m13:26:55.338812 [debug] [MainThread]: Flushing usage events
[0m13:30:29.700031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde88323e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde87eace10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde88315190>]}


============================== 13:30:29.706025 | ccb115bc-5eaa-4b3e-97fc-289575109348 ==============================
[0m13:30:29.706025 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:30:29.708358 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'introspect': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'quiet': 'False'}
[0m13:30:30.092979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccb115bc-5eaa-4b3e-97fc-289575109348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde85d072d0>]}
[0m13:30:30.106669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccb115bc-5eaa-4b3e-97fc-289575109348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde87e39710>]}
[0m13:30:30.108719 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:30:30.154333 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m13:30:31.846824 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m13:30:31.848289 [debug] [MainThread]: Partial parsing: added file: international_football://models/sources/dim_matches.sql
[0m13:30:31.849533 [debug] [MainThread]: Partial parsing: added file: international_football://models/sources/fact_home_win.sql
[0m13:30:31.850762 [debug] [MainThread]: Partial parsing: added file: international_football://models/sources/fact_match_results.sql
[0m13:30:31.851953 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/dim_matches.sql
[0m13:30:31.853060 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/fact_home_win.sql
[0m13:30:31.854166 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/fact_match_results.sql
[0m13:30:31.878664 [debug] [MainThread]: 1699: static parser successfully parsed sources/dim_matches.sql
[0m13:30:31.891805 [debug] [MainThread]: 1699: static parser successfully parsed sources/fact_home_win.sql
[0m13:30:31.897428 [debug] [MainThread]: 1699: static parser successfully parsed sources/fact_match_results.sql
[0m13:30:31.919976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccb115bc-5eaa-4b3e-97fc-289575109348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde85d1b590>]}
[0m13:30:31.938299 [error] [MainThread]: Encountered an error:
Found a cycle: model.international_football.dim_matches
[0m13:30:31.941577 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 584, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/compile.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.international_football.dim_matches

[0m13:30:31.943431 [debug] [MainThread]: Command `dbt run` failed at 13:30:31.943195 after 2.29 seconds
[0m13:30:31.944873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde88315190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde883493d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8bd7a250>]}
[0m13:30:31.946433 [debug] [MainThread]: Flushing usage events
[0m13:39:17.694963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213c9b1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213c595010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213c841b90>]}


============================== 13:39:17.701718 | d884d1b9-aa82-406d-85a9-561f491dc530 ==============================
[0m13:39:17.701718 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:39:17.703409 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m13:39:17.733152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd884d1b9-aa82-406d-85a9-561f491dc530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213c99c610>]}
[0m13:39:17.741905 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pokop2iu'
[0m13:39:17.744355 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:39:18.348104 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:39:18.352814 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:39:18.443811 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:39:18.454052 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:39:25.809789 [info ] [MainThread]: Installed from version 1.1.1
[0m13:39:25.812071 [info ] [MainThread]: Up to date!
[0m13:39:25.813871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd884d1b9-aa82-406d-85a9-561f491dc530', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213c01ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213c990cd0>]}
[0m13:39:25.815842 [debug] [MainThread]: Command `dbt deps` succeeded at 13:39:25.815676 after 8.16 seconds
[0m13:39:25.817151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21403f6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21404d41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213cb0d990>]}
[0m13:39:25.818942 [debug] [MainThread]: Flushing usage events
[0m13:40:04.486229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0aa4fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0be6a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0be6a490>]}


============================== 13:40:04.494100 | 4c3ae814-1a41-4d4b-a248-083af97f6dd1 ==============================
[0m13:40:04.494100 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:40:04.498786 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'debug': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True'}
[0m13:40:04.971052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c3ae814-1a41-4d4b-a248-083af97f6dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0aa80bd0>]}
[0m13:40:04.987355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c3ae814-1a41-4d4b-a248-083af97f6dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0a765b10>]}
[0m13:40:04.989563 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:40:05.034665 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m13:40:06.695946 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m13:40:06.697607 [debug] [MainThread]: Partial parsing: added file: international_football://models/transform/fact_match_results.sql
[0m13:40:06.698954 [debug] [MainThread]: Partial parsing: added file: international_football://models/transform/dim_matches.sql
[0m13:40:06.700032 [debug] [MainThread]: Partial parsing: added file: international_football://models/transform/fact_home_win.sql
[0m13:40:06.701319 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/sources/fact_home_win.sql
[0m13:40:06.702483 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/sources/dim_matches.sql
[0m13:40:06.703831 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/sources/fact_match_results.sql
[0m13:40:06.724759 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_match_results.sql
[0m13:40:06.736548 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_matches.sql
[0m13:40:06.742462 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_home_win.sql
[0m13:40:06.763665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c3ae814-1a41-4d4b-a248-083af97f6dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0849df90>]}
[0m13:40:06.787499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c3ae814-1a41-4d4b-a248-083af97f6dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee083c9a50>]}
[0m13:40:06.789618 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m13:40:06.791620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c3ae814-1a41-4d4b-a248-083af97f6dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0d6cb310>]}
[0m13:40:06.794350 [info ] [MainThread]: 
[0m13:40:06.797171 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:40:06.800603 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m13:40:06.802302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:07.457928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m13:40:07.459480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:08.039327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c3ae814-1a41-4d4b-a248-083af97f6dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0b40a8d0>]}
[0m13:40:08.041818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:08.043330 [info ] [MainThread]: 
[0m13:40:08.062533 [debug] [Thread-1 (]: Began running node model.international_football.dim_matches
[0m13:40:08.064651 [info ] [Thread-1 (]: 1 of 6 START sql table model international_football.dim_matches ................ [RUN]
[0m13:40:08.066865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_matches)
[0m13:40:08.068735 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_matches
[0m13:40:08.077027 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_matches"
[0m13:40:08.109287 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (compile): 13:40:08.070318 => 13:40:08.108905
[0m13:40:08.111108 [debug] [Thread-1 (]: Began executing node model.international_football.dim_matches
[0m13:40:08.144149 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_matches"
[0m13:40:08.182846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:08.189336 [debug] [Thread-1 (]: On model.international_football.dim_matches: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_matches"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_matches`
    
    

    OPTIONS()
    as (
      -- dim_matches.sql

-- Create a dimension table for matches
WITH matches AS (
    SELECT
        ROW_NUMBER() OVER () AS match_id,
        date AS match_date,
        home_team AS home_team_name,
        away_team AS away_team_name,
        tournament AS tournament_name,
        city AS match_city,
        country AS match_country,
        neutral AS match_neutral
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM matches
    );
  
[0m13:40:12.146383 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:b0da308c-33ee-45cf-bf62-8237de0d7ba8&page=queryresults
[0m13:40:12.160052 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (execute): 13:40:08.112423 => 13:40:12.159861
[0m13:40:12.162206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c3ae814-1a41-4d4b-a248-083af97f6dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0847c090>]}
[0m13:40:12.164776 [info ] [Thread-1 (]: 1 of 6 OK created sql table model international_football.dim_matches ........... [[32mCREATE TABLE (45.1k rows, 2.9 MiB processed)[0m in 4.10s]
[0m13:40:12.167098 [debug] [Thread-1 (]: Finished running node model.international_football.dim_matches
[0m13:40:12.168523 [debug] [Thread-1 (]: Began running node model.international_football.dim_players
[0m13:40:12.169788 [info ] [Thread-1 (]: 2 of 6 START sql table model international_football.dim_players ................ [RUN]
[0m13:40:12.171501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_matches, now model.international_football.dim_players)
[0m13:40:12.172714 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_players
[0m13:40:12.176527 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_players"
[0m13:40:12.190914 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (compile): 13:40:12.173907 => 13:40:12.190486
[0m13:40:12.192542 [debug] [Thread-1 (]: Began executing node model.international_football.dim_players
[0m13:40:12.207390 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_players"
[0m13:40:12.222609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:12.230783 [debug] [Thread-1 (]: On model.international_football.dim_players: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_players"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_players`
    
    

    OPTIONS()
    as (
      -- dim_players.sql

-- Create a dimension table for players
WITH players AS (
    SELECT
        ROW_NUMBER() OVER () AS player_id,
        scorer AS player_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers`
)
SELECT * FROM players
    );
  
[0m13:40:16.061503 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:61aaca84-0cea-4e7a-86d1-5c6ce9e28ba0&page=queryresults
[0m13:40:16.066378 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (execute): 13:40:12.194073 => 13:40:16.066198
[0m13:40:16.069488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c3ae814-1a41-4d4b-a248-083af97f6dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0851fd10>]}
[0m13:40:16.072063 [info ] [Thread-1 (]: 2 of 6 OK created sql table model international_football.dim_players ........... [[32mCREATE TABLE (41.1k rows, 649.2 KiB processed)[0m in 3.90s]
[0m13:40:16.074688 [debug] [Thread-1 (]: Finished running node model.international_football.dim_players
[0m13:40:16.076700 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m13:40:16.078422 [info ] [Thread-1 (]: 3 of 6 START sql table model international_football.dim_teams .................. [RUN]
[0m13:40:16.080429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_players, now model.international_football.dim_teams)
[0m13:40:16.082025 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m13:40:16.086931 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m13:40:16.102215 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 13:40:16.083440 => 13:40:16.101830
[0m13:40:16.103640 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m13:40:16.107363 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m13:40:16.123710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:16.129969 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- dim_teams.sql

-- Create a dimension table for teams
WITH teams AS (
    SELECT
        ROW_NUMBER() OVER () AS team_id,
        home_team AS team_name,
        country AS team_country
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    UNION
    SELECT
        ROW_NUMBER() OVER () AS team_id,
        away_team AS team_name,
        country AS team_country
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM teams
    );
  
[0m13:40:16.857387 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [22:5]')
[0m13:40:17.318587 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:8066cd68-7e1e-4317-b35c-0baa6ffcb8e4&page=queryresults
[0m13:40:17.320945 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 13:40:16.104850 => 13:40:17.320636
[0m13:40:17.332262 [debug] [Thread-1 (]: Database Error in model dim_teams (models/transform/dim_teams.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [22:5]
  compiled Code at target/run/international_football/models/transform/dim_teams.sql
[0m13:40:17.333708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c3ae814-1a41-4d4b-a248-083af97f6dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0851f590>]}
[0m13:40:17.335378 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model international_football.dim_teams ......... [[31mERROR[0m in 1.25s]
[0m13:40:17.337239 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m13:40:17.338692 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m13:40:17.340313 [info ] [Thread-1 (]: 4 of 6 START sql table model international_football.dim_tournaments ............ [RUN]
[0m13:40:17.342295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m13:40:17.343691 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m13:40:17.349951 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m13:40:17.366893 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 13:40:17.347341 => 13:40:17.366467
[0m13:40:17.368648 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m13:40:17.373291 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m13:40:17.390632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:17.398628 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create a dimension table for tournaments
WITH tournaments AS (
    SELECT
        ROW_NUMBER() OVER () AS tournament_id,
        tournament AS tournament_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM tournaments
    );
  
[0m13:40:21.807730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:ef27ffaa-b7ca-4711-868f-35bcb2bd25db&page=queryresults
[0m13:40:21.812408 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 13:40:17.370252 => 13:40:21.812156
[0m13:40:21.815485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c3ae814-1a41-4d4b-a248-083af97f6dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee07865390>]}
[0m13:40:21.817743 [info ] [Thread-1 (]: 4 of 6 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (45.1k rows, 831.3 KiB processed)[0m in 4.47s]
[0m13:40:21.820136 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m13:40:21.821964 [debug] [Thread-1 (]: Began running node model.international_football.fact_match_results
[0m13:40:21.823405 [info ] [Thread-1 (]: 5 of 6 SKIP relation international_football.fact_match_results ................. [[33mSKIP[0m]
[0m13:40:21.824855 [debug] [Thread-1 (]: Finished running node model.international_football.fact_match_results
[0m13:40:21.826645 [debug] [Thread-1 (]: Began running node model.international_football.fact_home_win
[0m13:40:21.827797 [info ] [Thread-1 (]: 6 of 6 SKIP relation international_football.fact_home_win ...................... [[33mSKIP[0m]
[0m13:40:21.829193 [debug] [Thread-1 (]: Finished running node model.international_football.fact_home_win
[0m13:40:21.831977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:21.834029 [debug] [MainThread]: Connection 'model.international_football.dim_tournaments' was properly closed.
[0m13:40:21.835269 [info ] [MainThread]: 
[0m13:40:21.836869 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 15.04 seconds (15.04s).
[0m13:40:21.839464 [debug] [MainThread]: Command end result
[0m13:40:21.865668 [info ] [MainThread]: 
[0m13:40:21.867398 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:40:21.868685 [info ] [MainThread]: 
[0m13:40:21.869946 [error] [MainThread]: [33mDatabase Error in model dim_teams (models/transform/dim_teams.sql)[0m
[0m13:40:21.871277 [error] [MainThread]:   Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [22:5]
[0m13:40:21.872538 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_teams.sql
[0m13:40:21.873774 [info ] [MainThread]: 
[0m13:40:21.875102 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m13:40:21.877774 [debug] [MainThread]: Command `dbt run` failed at 13:40:21.877529 after 17.44 seconds
[0m13:40:21.879255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0a9647d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0a123610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0a123490>]}
[0m13:40:21.880807 [debug] [MainThread]: Flushing usage events
[0m13:43:12.680967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c18a1650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c1c9d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c1b80ad0>]}


============================== 13:43:12.686550 | 9cffef0e-aed0-4765-b3b2-1bc204e010e4 ==============================
[0m13:43:12.686550 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:43:12.688489 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'quiet': 'False', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'introspect': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m13:43:13.082223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cffef0e-aed0-4765-b3b2-1bc204e010e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c132b190>]}
[0m13:43:13.100537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cffef0e-aed0-4765-b3b2-1bc204e010e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c126b690>]}
[0m13:43:13.103167 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:43:13.159831 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m13:43:14.916651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:14.918408 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_teams.sql
[0m13:43:14.940530 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_teams.sql
[0m13:43:14.967236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cffef0e-aed0-4765-b3b2-1bc204e010e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bf6b8150>]}
[0m13:43:14.993402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cffef0e-aed0-4765-b3b2-1bc204e010e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bf71d610>]}
[0m13:43:14.995252 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m13:43:14.997016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cffef0e-aed0-4765-b3b2-1bc204e010e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c48eba10>]}
[0m13:43:14.999483 [info ] [MainThread]: 
[0m13:43:15.001672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:43:15.004244 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m13:43:15.005731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:15.585344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m13:43:15.588195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:16.160996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cffef0e-aed0-4765-b3b2-1bc204e010e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bf70ff90>]}
[0m13:43:16.163247 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:16.164908 [info ] [MainThread]: 
[0m13:43:16.180510 [debug] [Thread-1 (]: Began running node model.international_football.dim_matches
[0m13:43:16.183086 [info ] [Thread-1 (]: 1 of 6 START sql table model international_football.dim_matches ................ [RUN]
[0m13:43:16.185758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_matches)
[0m13:43:16.188003 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_matches
[0m13:43:16.197320 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_matches"
[0m13:43:16.219049 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (compile): 13:43:16.189563 => 13:43:16.218624
[0m13:43:16.221442 [debug] [Thread-1 (]: Began executing node model.international_football.dim_matches
[0m13:43:16.237398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:17.014393 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_matches"
[0m13:43:17.035047 [debug] [Thread-1 (]: On model.international_football.dim_matches: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_matches"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_matches`
    
    

    OPTIONS()
    as (
      -- dim_matches.sql

-- Create a dimension table for matches
WITH matches AS (
    SELECT
        ROW_NUMBER() OVER () AS match_id,
        date AS match_date,
        home_team AS home_team_name,
        away_team AS away_team_name,
        tournament AS tournament_name,
        city AS match_city,
        country AS match_country,
        neutral AS match_neutral
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM matches
    );
  
[0m13:43:21.977021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:1b0508be-0ce2-4e01-91fe-86341eff4d3a&page=queryresults
[0m13:43:21.994150 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (execute): 13:43:16.223471 => 13:43:21.993929
[0m13:43:21.996629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cffef0e-aed0-4765-b3b2-1bc204e010e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bf743190>]}
[0m13:43:21.998671 [info ] [Thread-1 (]: 1 of 6 OK created sql table model international_football.dim_matches ........... [[32mCREATE TABLE (45.1k rows, 2.9 MiB processed)[0m in 5.81s]
[0m13:43:22.000779 [debug] [Thread-1 (]: Finished running node model.international_football.dim_matches
[0m13:43:22.002396 [debug] [Thread-1 (]: Began running node model.international_football.dim_players
[0m13:43:22.003882 [info ] [Thread-1 (]: 2 of 6 START sql table model international_football.dim_players ................ [RUN]
[0m13:43:22.005836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_matches, now model.international_football.dim_players)
[0m13:43:22.007326 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_players
[0m13:43:22.011482 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_players"
[0m13:43:22.025588 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (compile): 13:43:22.008517 => 13:43:22.025062
[0m13:43:22.027303 [debug] [Thread-1 (]: Began executing node model.international_football.dim_players
[0m13:43:22.030271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:22.635750 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_players"
[0m13:43:22.651595 [debug] [Thread-1 (]: On model.international_football.dim_players: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_players"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_players`
    
    

    OPTIONS()
    as (
      -- dim_players.sql

-- Create a dimension table for players
WITH players AS (
    SELECT
        ROW_NUMBER() OVER () AS player_id,
        scorer AS player_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers`
)
SELECT * FROM players
    );
  
[0m13:43:26.250359 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:ee4f12fc-f05b-4986-840f-9da7b8e5ed81&page=queryresults
[0m13:43:26.255694 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (execute): 13:43:22.028327 => 13:43:26.255520
[0m13:43:26.257639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cffef0e-aed0-4765-b3b2-1bc204e010e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c132b2d0>]}
[0m13:43:26.259518 [info ] [Thread-1 (]: 2 of 6 OK created sql table model international_football.dim_players ........... [[32mCREATE TABLE (41.1k rows, 649.2 KiB processed)[0m in 4.25s]
[0m13:43:26.261616 [debug] [Thread-1 (]: Finished running node model.international_football.dim_players
[0m13:43:26.263470 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m13:43:26.264803 [info ] [Thread-1 (]: 3 of 6 START sql table model international_football.dim_teams .................. [RUN]
[0m13:43:26.266476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_players, now model.international_football.dim_teams)
[0m13:43:26.267850 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m13:43:26.274076 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m13:43:26.288520 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 13:43:26.269016 => 13:43:26.288158
[0m13:43:26.290256 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m13:43:26.294482 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m13:43:26.308608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:26.316133 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- dim_teams.sql

-- Create a dimension table for teams
WITH teams AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS team_id,
        home_team AS team_name,
        country AS team_country
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    UNION
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS team_id,
        away_team AS team_name,
        country AS team_country
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM teams;
    );
  
[0m13:43:26.865243 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [22:5]')
[0m13:43:27.537436 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:52ae8a57-0f77-4f53-9b2a-577e1b035cb3&page=queryresults
[0m13:43:27.541221 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 13:43:26.291800 => 13:43:27.540556
[0m13:43:27.548247 [debug] [Thread-1 (]: Database Error in model dim_teams (models/transform/dim_teams.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [22:5]
  compiled Code at target/run/international_football/models/transform/dim_teams.sql
[0m13:43:27.550464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cffef0e-aed0-4765-b3b2-1bc204e010e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bf6aafd0>]}
[0m13:43:27.552851 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model international_football.dim_teams ......... [[31mERROR[0m in 1.28s]
[0m13:43:27.554834 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m13:43:27.556486 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m13:43:27.558052 [info ] [Thread-1 (]: 4 of 6 START sql table model international_football.dim_tournaments ............ [RUN]
[0m13:43:27.560124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m13:43:27.561910 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m13:43:27.566461 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m13:43:27.582011 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 13:43:27.563288 => 13:43:27.581644
[0m13:43:27.583596 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m13:43:27.588976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:28.528297 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m13:43:28.545526 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create a dimension table for tournaments
WITH tournaments AS (
    SELECT
        ROW_NUMBER() OVER () AS tournament_id,
        tournament AS tournament_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM tournaments
    );
  
[0m13:43:31.802243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:c963d704-d9aa-4a11-9100-b9673f2b3898&page=queryresults
[0m13:43:31.808184 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 13:43:27.585232 => 13:43:31.807995
[0m13:43:31.810186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cffef0e-aed0-4765-b3b2-1bc204e010e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4be6de5d0>]}
[0m13:43:31.812173 [info ] [Thread-1 (]: 4 of 6 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (45.1k rows, 831.3 KiB processed)[0m in 4.25s]
[0m13:43:31.814360 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m13:43:31.815953 [debug] [Thread-1 (]: Began running node model.international_football.fact_match_results
[0m13:43:31.817299 [info ] [Thread-1 (]: 5 of 6 SKIP relation international_football.fact_match_results ................. [[33mSKIP[0m]
[0m13:43:31.818831 [debug] [Thread-1 (]: Finished running node model.international_football.fact_match_results
[0m13:43:31.820956 [debug] [Thread-1 (]: Began running node model.international_football.fact_home_win
[0m13:43:31.822360 [info ] [Thread-1 (]: 6 of 6 SKIP relation international_football.fact_home_win ...................... [[33mSKIP[0m]
[0m13:43:31.824061 [debug] [Thread-1 (]: Finished running node model.international_football.fact_home_win
[0m13:43:31.827190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:31.828834 [debug] [MainThread]: Connection 'model.international_football.dim_tournaments' was properly closed.
[0m13:43:31.831086 [info ] [MainThread]: 
[0m13:43:31.832770 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 16.83 seconds (16.83s).
[0m13:43:31.835106 [debug] [MainThread]: Command end result
[0m13:43:31.857202 [info ] [MainThread]: 
[0m13:43:31.858894 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:43:31.860346 [info ] [MainThread]: 
[0m13:43:31.861675 [error] [MainThread]: [33mDatabase Error in model dim_teams (models/transform/dim_teams.sql)[0m
[0m13:43:31.862921 [error] [MainThread]:   Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [22:5]
[0m13:43:31.864135 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_teams.sql
[0m13:43:31.865448 [info ] [MainThread]: 
[0m13:43:31.867307 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m13:43:31.869803 [debug] [MainThread]: Command `dbt run` failed at 13:43:31.869607 after 19.22 seconds
[0m13:43:31.871609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c1af05d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c1335e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c1ae7bd0>]}
[0m13:43:31.873294 [debug] [MainThread]: Flushing usage events
[0m13:45:05.461909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f71b92f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7151a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7151ad10>]}


============================== 13:45:05.467040 | 6f91adbc-fe4e-41fc-b335-0e62cf17aac0 ==============================
[0m13:45:05.467040 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:45:05.469066 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'target_path': 'None', 'log_format': 'default'}
[0m13:45:05.845409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f91adbc-fe4e-41fc-b335-0e62cf17aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6fa5e7d0>]}
[0m13:45:05.859681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f91adbc-fe4e-41fc-b335-0e62cf17aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6f883a90>]}
[0m13:45:05.862030 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:45:05.909059 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m13:45:07.666011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:45:07.667620 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_teams.sql
[0m13:45:07.689284 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_teams.sql
[0m13:45:07.717750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f91adbc-fe4e-41fc-b335-0e62cf17aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6f7bf890>]}
[0m13:45:07.745929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f91adbc-fe4e-41fc-b335-0e62cf17aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6f910ed0>]}
[0m13:45:07.747779 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m13:45:07.749550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f91adbc-fe4e-41fc-b335-0e62cf17aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6f8e7150>]}
[0m13:45:07.752407 [info ] [MainThread]: 
[0m13:45:07.754320 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:45:07.756536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m13:45:07.757824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:08.391827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m13:45:08.397212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:08.947677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f91adbc-fe4e-41fc-b335-0e62cf17aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7280ead0>]}
[0m13:45:08.949721 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:08.951252 [info ] [MainThread]: 
[0m13:45:08.965135 [debug] [Thread-1 (]: Began running node model.international_football.dim_matches
[0m13:45:08.967028 [info ] [Thread-1 (]: 1 of 6 START sql table model international_football.dim_matches ................ [RUN]
[0m13:45:08.969047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_matches)
[0m13:45:08.970417 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_matches
[0m13:45:08.978483 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_matches"
[0m13:45:08.993709 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (compile): 13:45:08.971500 => 13:45:08.993038
[0m13:45:08.996137 [debug] [Thread-1 (]: Began executing node model.international_football.dim_matches
[0m13:45:09.013696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:09.857697 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_matches"
[0m13:45:09.879219 [debug] [Thread-1 (]: On model.international_football.dim_matches: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_matches"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_matches`
    
    

    OPTIONS()
    as (
      -- dim_matches.sql

-- Create a dimension table for matches
WITH matches AS (
    SELECT
        ROW_NUMBER() OVER () AS match_id,
        date AS match_date,
        home_team AS home_team_name,
        away_team AS away_team_name,
        tournament AS tournament_name,
        city AS match_city,
        country AS match_country,
        neutral AS match_neutral
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM matches
    );
  
[0m13:45:13.962822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:44e9f2ac-9f54-4ece-9bb9-867dda47a73e&page=queryresults
[0m13:45:13.979132 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (execute): 13:45:08.997630 => 13:45:13.978954
[0m13:45:13.981592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f91adbc-fe4e-41fc-b335-0e62cf17aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6fa67810>]}
[0m13:45:13.983549 [info ] [Thread-1 (]: 1 of 6 OK created sql table model international_football.dim_matches ........... [[32mCREATE TABLE (45.1k rows, 2.9 MiB processed)[0m in 5.01s]
[0m13:45:13.985817 [debug] [Thread-1 (]: Finished running node model.international_football.dim_matches
[0m13:45:13.987806 [debug] [Thread-1 (]: Began running node model.international_football.dim_players
[0m13:45:13.989410 [info ] [Thread-1 (]: 2 of 6 START sql table model international_football.dim_players ................ [RUN]
[0m13:45:13.991381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_matches, now model.international_football.dim_players)
[0m13:45:13.992877 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_players
[0m13:45:13.997136 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_players"
[0m13:45:14.011420 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (compile): 13:45:13.994430 => 13:45:14.011053
[0m13:45:14.012768 [debug] [Thread-1 (]: Began executing node model.international_football.dim_players
[0m13:45:14.016722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:14.605360 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_players"
[0m13:45:14.619401 [debug] [Thread-1 (]: On model.international_football.dim_players: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_players"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_players`
    
    

    OPTIONS()
    as (
      -- dim_players.sql

-- Create a dimension table for players
WITH players AS (
    SELECT
        ROW_NUMBER() OVER () AS player_id,
        scorer AS player_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers`
)
SELECT * FROM players
    );
  
[0m13:45:18.543747 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:9effa9b4-1fe9-4abc-ad20-f85758496651&page=queryresults
[0m13:45:18.549219 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (execute): 13:45:14.014118 => 13:45:18.548944
[0m13:45:18.551126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f91adbc-fe4e-41fc-b335-0e62cf17aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f71414290>]}
[0m13:45:18.552819 [info ] [Thread-1 (]: 2 of 6 OK created sql table model international_football.dim_players ........... [[32mCREATE TABLE (41.1k rows, 649.2 KiB processed)[0m in 4.56s]
[0m13:45:18.555051 [debug] [Thread-1 (]: Finished running node model.international_football.dim_players
[0m13:45:18.556769 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m13:45:18.558405 [info ] [Thread-1 (]: 3 of 6 START sql table model international_football.dim_teams .................. [RUN]
[0m13:45:18.560454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_players, now model.international_football.dim_teams)
[0m13:45:18.561928 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m13:45:18.568043 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m13:45:18.583070 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 13:45:18.563169 => 13:45:18.582700
[0m13:45:18.584472 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m13:45:18.588315 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m13:45:18.604695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:18.610737 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- dim_teams.sql

-- Create a dimension table for teams
WITH teams AS (
    SELECT
        ROW_NUMBER() OVER () AS team_id,
        team_name,
        team_country
    FROM (
        SELECT home_team AS team_name, country AS team_country
        FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
        UNION
        SELECT away_team AS team_name, country AS team_country
        FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    )
)
SELECT * FROM teams
    );
  
[0m13:45:19.167857 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:9]')
[0m13:45:19.838008 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:de8aafdf-7fce-4d59-a7a4-ddbdfe90ce71&page=queryresults
[0m13:45:19.842678 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 13:45:18.585697 => 13:45:19.842087
[0m13:45:19.850038 [debug] [Thread-1 (]: Database Error in model dim_teams (models/transform/dim_teams.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:9]
  compiled Code at target/run/international_football/models/transform/dim_teams.sql
[0m13:45:19.851974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f91adbc-fe4e-41fc-b335-0e62cf17aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6f770490>]}
[0m13:45:19.854179 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model international_football.dim_teams ......... [[31mERROR[0m in 1.29s]
[0m13:45:19.856152 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m13:45:19.857817 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m13:45:19.859438 [info ] [Thread-1 (]: 4 of 6 START sql table model international_football.dim_tournaments ............ [RUN]
[0m13:45:19.861647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m13:45:19.863338 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m13:45:19.867301 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m13:45:19.882904 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 13:45:19.864674 => 13:45:19.882517
[0m13:45:19.884372 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m13:45:19.887760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:20.604271 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m13:45:20.622294 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create a dimension table for tournaments
WITH tournaments AS (
    SELECT
        ROW_NUMBER() OVER () AS tournament_id,
        tournament AS tournament_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM tournaments
    );
  
[0m13:45:23.997049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:778980b8-c0ad-4c35-a8aa-a964530ac09f&page=queryresults
[0m13:45:24.000447 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 13:45:19.885623 => 13:45:24.000265
[0m13:45:24.002182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f91adbc-fe4e-41fc-b335-0e62cf17aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6e66af90>]}
[0m13:45:24.003612 [info ] [Thread-1 (]: 4 of 6 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (45.1k rows, 831.3 KiB processed)[0m in 4.14s]
[0m13:45:24.005530 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m13:45:24.006827 [debug] [Thread-1 (]: Began running node model.international_football.fact_match_results
[0m13:45:24.007998 [info ] [Thread-1 (]: 5 of 6 SKIP relation international_football.fact_match_results ................. [[33mSKIP[0m]
[0m13:45:24.009458 [debug] [Thread-1 (]: Finished running node model.international_football.fact_match_results
[0m13:45:24.011442 [debug] [Thread-1 (]: Began running node model.international_football.fact_home_win
[0m13:45:24.012635 [info ] [Thread-1 (]: 6 of 6 SKIP relation international_football.fact_home_win ...................... [[33mSKIP[0m]
[0m13:45:24.013966 [debug] [Thread-1 (]: Finished running node model.international_football.fact_home_win
[0m13:45:24.016698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:24.018005 [debug] [MainThread]: Connection 'model.international_football.dim_tournaments' was properly closed.
[0m13:45:24.019565 [info ] [MainThread]: 
[0m13:45:24.021134 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 16.27 seconds (16.27s).
[0m13:45:24.023331 [debug] [MainThread]: Command end result
[0m13:45:24.045123 [info ] [MainThread]: 
[0m13:45:24.047050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:45:24.048928 [info ] [MainThread]: 
[0m13:45:24.050473 [error] [MainThread]: [33mDatabase Error in model dim_teams (models/transform/dim_teams.sql)[0m
[0m13:45:24.052174 [error] [MainThread]:   Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:9]
[0m13:45:24.053549 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_teams.sql
[0m13:45:24.054850 [info ] [MainThread]: 
[0m13:45:24.056170 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m13:45:24.058078 [debug] [MainThread]: Command `dbt run` failed at 13:45:24.057896 after 18.63 seconds
[0m13:45:24.059303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f71e98550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f71e5b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f71ba8150>]}
[0m13:45:24.060755 [debug] [MainThread]: Flushing usage events
[0m13:46:34.717790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a5894bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a7a19710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a574b0d0>]}


============================== 13:46:34.722773 | c2b1dee6-3d0b-44d3-9e26-bc60a36264eb ==============================
[0m13:46:34.722773 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:46:34.724570 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m13:46:35.111954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a55acf10>]}
[0m13:46:35.126713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a5882310>]}
[0m13:46:35.128929 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:46:35.176415 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m13:46:36.855360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:46:36.857279 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_teams.sql
[0m13:46:36.879226 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_teams.sql
[0m13:46:36.907249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a371ec10>]}
[0m13:46:36.931139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a35cce50>]}
[0m13:46:36.932831 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m13:46:36.934369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a35aa7d0>]}
[0m13:46:36.937039 [info ] [MainThread]: 
[0m13:46:36.938956 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:46:36.941281 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m13:46:36.942605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:37.674122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m13:46:37.676567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:38.497176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a371ffd0>]}
[0m13:46:38.499508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:38.500935 [info ] [MainThread]: 
[0m13:46:38.514630 [debug] [Thread-1 (]: Began running node model.international_football.dim_matches
[0m13:46:38.517121 [info ] [Thread-1 (]: 1 of 6 START sql table model international_football.dim_matches ................ [RUN]
[0m13:46:38.519497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_matches)
[0m13:46:38.521184 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_matches
[0m13:46:38.529609 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_matches"
[0m13:46:38.544237 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (compile): 13:46:38.522595 => 13:46:38.543859
[0m13:46:38.545841 [debug] [Thread-1 (]: Began executing node model.international_football.dim_matches
[0m13:46:38.561151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:39.374809 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_matches"
[0m13:46:39.393794 [debug] [Thread-1 (]: On model.international_football.dim_matches: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_matches"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_matches`
    
    

    OPTIONS()
    as (
      -- dim_matches.sql

-- Create a dimension table for matches
WITH matches AS (
    SELECT
        ROW_NUMBER() OVER () AS match_id,
        date AS match_date,
        home_team AS home_team_name,
        away_team AS away_team_name,
        tournament AS tournament_name,
        city AS match_city,
        country AS match_country,
        neutral AS match_neutral
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM matches
    );
  
[0m13:46:42.770554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:c528346b-76d8-4939-b671-413c44ee4cf0&page=queryresults
[0m13:46:42.786133 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (execute): 13:46:38.547067 => 13:46:42.785888
[0m13:46:42.788430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a347ec10>]}
[0m13:46:42.791202 [info ] [Thread-1 (]: 1 of 6 OK created sql table model international_football.dim_matches ........... [[32mCREATE TABLE (45.1k rows, 2.9 MiB processed)[0m in 4.27s]
[0m13:46:42.793499 [debug] [Thread-1 (]: Finished running node model.international_football.dim_matches
[0m13:46:42.795548 [debug] [Thread-1 (]: Began running node model.international_football.dim_players
[0m13:46:42.797443 [info ] [Thread-1 (]: 2 of 6 START sql table model international_football.dim_players ................ [RUN]
[0m13:46:42.799458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_matches, now model.international_football.dim_players)
[0m13:46:42.800984 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_players
[0m13:46:42.806198 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_players"
[0m13:46:42.822296 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (compile): 13:46:42.802236 => 13:46:42.821873
[0m13:46:42.824129 [debug] [Thread-1 (]: Began executing node model.international_football.dim_players
[0m13:46:42.827640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:43.647414 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_players"
[0m13:46:43.665657 [debug] [Thread-1 (]: On model.international_football.dim_players: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_players"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_players`
    
    

    OPTIONS()
    as (
      -- dim_players.sql

-- Create a dimension table for players
WITH players AS (
    SELECT
        ROW_NUMBER() OVER () AS player_id,
        scorer AS player_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers`
)
SELECT * FROM players
    );
  
[0m13:46:47.359210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:4cfd92fe-0f34-4fca-a9a1-9d46a4e2a21f&page=queryresults
[0m13:46:47.366210 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (execute): 13:46:42.825600 => 13:46:47.365930
[0m13:46:47.368220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a25b3850>]}
[0m13:46:47.370770 [info ] [Thread-1 (]: 2 of 6 OK created sql table model international_football.dim_players ........... [[32mCREATE TABLE (41.1k rows, 649.2 KiB processed)[0m in 4.57s]
[0m13:46:47.372926 [debug] [Thread-1 (]: Finished running node model.international_football.dim_players
[0m13:46:47.374492 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m13:46:47.375848 [info ] [Thread-1 (]: 3 of 6 START sql table model international_football.dim_teams .................. [RUN]
[0m13:46:47.377642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_players, now model.international_football.dim_teams)
[0m13:46:47.379122 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m13:46:47.385251 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m13:46:47.398198 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 13:46:47.380190 => 13:46:47.397753
[0m13:46:47.399890 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m13:46:47.404188 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m13:46:47.418429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:47.426006 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- dim_teams.sql

-- Create a dimension table for teams
WITH teams AS (
    SELECT
        ROW_NUMBER() OVER () AS team_id,
        team_name,
        team_country
    FROM (
        SELECT home_team AS team_name, country AS team_country
        FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
        UNION ALL
        SELECT away_team AS team_name, country AS team_country
        FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    ) AS combined_teams
)
SELECT * FROM teams
    );
  
[0m13:46:51.410362 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:3883e841-c8c4-4d9d-b549-25b302896cbd&page=queryresults
[0m13:46:51.413185 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 13:46:47.401092 => 13:46:51.413007
[0m13:46:51.414794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a2592490>]}
[0m13:46:51.416123 [info ] [Thread-1 (]: 3 of 6 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (90.2k rows, 1.3 MiB processed)[0m in 4.04s]
[0m13:46:51.417826 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m13:46:51.419287 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m13:46:51.420654 [info ] [Thread-1 (]: 4 of 6 START sql table model international_football.dim_tournaments ............ [RUN]
[0m13:46:51.422491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m13:46:51.423789 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m13:46:51.427911 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m13:46:51.442045 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 13:46:51.425027 => 13:46:51.441657
[0m13:46:51.443766 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m13:46:51.447267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:52.370808 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m13:46:52.385039 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create a dimension table for tournaments
WITH tournaments AS (
    SELECT
        ROW_NUMBER() OVER () AS tournament_id,
        tournament AS tournament_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM tournaments
    );
  
[0m13:46:55.935552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:34012cd9-c94e-410a-8b7e-75e1cb4712ca&page=queryresults
[0m13:46:55.940136 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 13:46:51.445229 => 13:46:55.939927
[0m13:46:55.942325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a258fa50>]}
[0m13:46:55.944131 [info ] [Thread-1 (]: 4 of 6 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (45.1k rows, 831.3 KiB processed)[0m in 4.52s]
[0m13:46:55.946188 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m13:46:55.947738 [debug] [Thread-1 (]: Began running node model.international_football.fact_match_results
[0m13:46:55.949168 [info ] [Thread-1 (]: 5 of 6 START sql table model international_football.fact_match_results ......... [RUN]
[0m13:46:55.950914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_match_results)
[0m13:46:55.952117 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_match_results
[0m13:46:55.956158 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_match_results"
[0m13:46:55.971559 [debug] [Thread-1 (]: Timing info for model.international_football.fact_match_results (compile): 13:46:55.953098 => 13:46:55.971199
[0m13:46:55.973137 [debug] [Thread-1 (]: Began executing node model.international_football.fact_match_results
[0m13:46:55.977304 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_match_results"
[0m13:46:55.992140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:55.998439 [debug] [Thread-1 (]: On model.international_football.fact_match_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_match_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_match_results`
    
    

    OPTIONS()
    as (
      -- fact_match_results.sql

-- Create a fact table for match results
WITH match_results AS (
    SELECT
        ROW_NUMBER() OVER () AS match_result_id,
        m.match_id,
        m.match_date,
        m.tournament_name,
        m.match_city,
        m.match_country,
        m.match_neutral,
        t1.team_id AS home_team_id,
        t2.team_id AS away_team_id,
        r.home_score,
        r.away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_matches` m ON r.date = m.match_date
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` t1 ON r.home_team = t1.team_name
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` t2 ON r.away_team = t2.team_name
)
SELECT * FROM match_results
    );
  
[0m13:51:40.338721 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m13:52:02.608776 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_match_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_match_results`
    
    

    OPTIONS()
    as (
      -- fact_match_results.sql

-- Create a fact table for match results
WITH match_results AS (
    SELECT
        ROW_NUMBER() OVER () AS match_result_id,
        m.match_id,
        m.match_date,
        m.tournament_name,
        m.match_city,
        m.match_country,
        m.match_neutral,
        t1.team_id AS home_team_id,
        t2.team_id AS away_team_id,
        r.home_score,
        r.away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_matches` m ON r.date = m.match_date
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` t1 ON r.home_team = t1.team_name
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` t2 ON r.away_team = t2.team_name
)
SELECT * FROM match_results
    );
  
[0m13:52:02.610722 [debug] [Thread-1 (]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m13:52:02.612655 [debug] [Thread-1 (]: Timing info for model.international_football.fact_match_results (execute): 13:46:55.974369 => 13:52:02.612380
[0m13:52:02.619094 [debug] [Thread-1 (]: Runtime Error in model fact_match_results (models/transform/fact_match_results.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m13:52:02.621394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b1dee6-3d0b-44d3-9e26-bc60a36264eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a3525810>]}
[0m13:52:02.623888 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model international_football.fact_match_results  [[31mERROR[0m in 306.67s]
[0m13:52:02.625672 [debug] [Thread-1 (]: Finished running node model.international_football.fact_match_results
[0m13:52:02.627226 [info ] [MainThread]: 
[0m13:52:02.628771 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m13:52:02.630139 [info ] [MainThread]: 
[0m13:52:02.631664 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:52:02.633371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:02.634748 [debug] [MainThread]: Connection 'model.international_football.fact_match_results' was properly closed.
[0m13:52:02.636102 [info ] [MainThread]: 
[0m13:52:02.638024 [info ] [MainThread]: Finished running 4 table models in 0 hours 5 minutes and 25.70 seconds (325.70s).
[0m13:52:02.640099 [error] [MainThread]: Encountered an error:

[0m13:52:02.645547 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 584, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 448, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 406, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 352, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 260, in run_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m13:52:02.648317 [debug] [MainThread]: Command `dbt run` failed at 13:52:02.647967 after 327.97 seconds
[0m13:52:02.650321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a5b99e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a5894bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a5cc8a90>]}
[0m13:52:02.652352 [debug] [MainThread]: Flushing usage events
[0m13:53:15.400609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c71dc47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c71ae7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c71ae68d0>]}


============================== 13:53:15.405910 | fcc377ff-bb16-425b-b3a1-afb865208e98 ==============================
[0m13:53:15.405910 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:53:15.407895 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error': 'None', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True'}
[0m13:53:15.793505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcc377ff-bb16-425b-b3a1-afb865208e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c71c16cd0>]}
[0m13:53:15.808591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcc377ff-bb16-425b-b3a1-afb865208e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6f973fd0>]}
[0m13:53:15.810833 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:53:15.856727 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m13:53:17.471612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:53:17.473011 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_match_results.sql
[0m13:53:17.474180 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_teams.sql
[0m13:53:17.494717 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_match_results.sql
[0m13:53:17.507549 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_teams.sql
[0m13:53:17.527678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcc377ff-bb16-425b-b3a1-afb865208e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6f8c2710>]}
[0m13:53:17.552042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcc377ff-bb16-425b-b3a1-afb865208e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6f9ae090>]}
[0m13:53:17.553607 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m13:53:17.555139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc377ff-bb16-425b-b3a1-afb865208e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c74a27690>]}
[0m13:53:17.557381 [info ] [MainThread]: 
[0m13:53:17.559252 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:53:17.561517 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m13:53:17.563026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:18.181867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m13:53:18.184198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:18.838568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc377ff-bb16-425b-b3a1-afb865208e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6f98a2d0>]}
[0m13:53:18.840600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:18.842531 [info ] [MainThread]: 
[0m13:53:18.856865 [debug] [Thread-1 (]: Began running node model.international_football.dim_matches
[0m13:53:18.858630 [info ] [Thread-1 (]: 1 of 6 START sql table model international_football.dim_matches ................ [RUN]
[0m13:53:18.860506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_matches)
[0m13:53:18.862487 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_matches
[0m13:53:18.870812 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_matches"
[0m13:53:18.887655 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (compile): 13:53:18.863852 => 13:53:18.887227
[0m13:53:18.889703 [debug] [Thread-1 (]: Began executing node model.international_football.dim_matches
[0m13:53:18.906209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:19.928775 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_matches"
[0m13:53:19.950114 [debug] [Thread-1 (]: On model.international_football.dim_matches: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_matches"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_matches`
    
    

    OPTIONS()
    as (
      -- dim_matches.sql

-- Create a dimension table for matches
WITH matches AS (
    SELECT
        ROW_NUMBER() OVER () AS match_id,
        date AS match_date,
        home_team AS home_team_name,
        away_team AS away_team_name,
        tournament AS tournament_name,
        city AS match_city,
        country AS match_country,
        neutral AS match_neutral
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM matches
    );
  
[0m13:53:25.114441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:ab575e5c-382e-43be-8354-0e779d779c5d&page=queryresults
[0m13:53:25.129976 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (execute): 13:53:18.891305 => 13:53:25.129802
[0m13:53:25.132288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc377ff-bb16-425b-b3a1-afb865208e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6f98cbd0>]}
[0m13:53:25.135591 [info ] [Thread-1 (]: 1 of 6 OK created sql table model international_football.dim_matches ........... [[32mCREATE TABLE (45.1k rows, 2.9 MiB processed)[0m in 6.27s]
[0m13:53:25.138345 [debug] [Thread-1 (]: Finished running node model.international_football.dim_matches
[0m13:53:25.140568 [debug] [Thread-1 (]: Began running node model.international_football.dim_players
[0m13:53:25.142467 [info ] [Thread-1 (]: 2 of 6 START sql table model international_football.dim_players ................ [RUN]
[0m13:53:25.144484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_matches, now model.international_football.dim_players)
[0m13:53:25.146118 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_players
[0m13:53:25.156850 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_players"
[0m13:53:25.172346 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (compile): 13:53:25.147591 => 13:53:25.171977
[0m13:53:25.174143 [debug] [Thread-1 (]: Began executing node model.international_football.dim_players
[0m13:53:25.177505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:25.755506 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_players"
[0m13:53:25.770507 [debug] [Thread-1 (]: On model.international_football.dim_players: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_players"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_players`
    
    

    OPTIONS()
    as (
      -- dim_players.sql

-- Create a dimension table for players
WITH players AS (
    SELECT
        ROW_NUMBER() OVER () AS player_id,
        scorer AS player_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers`
)
SELECT * FROM players
    );
  
[0m13:53:29.726778 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:0e7caa90-4103-4527-b8e8-2ffa2d8c10e7&page=queryresults
[0m13:53:29.731746 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (execute): 13:53:25.175461 => 13:53:29.731531
[0m13:53:29.733869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc377ff-bb16-425b-b3a1-afb865208e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6f721c90>]}
[0m13:53:29.735495 [info ] [Thread-1 (]: 2 of 6 OK created sql table model international_football.dim_players ........... [[32mCREATE TABLE (41.1k rows, 649.2 KiB processed)[0m in 4.59s]
[0m13:53:29.737975 [debug] [Thread-1 (]: Finished running node model.international_football.dim_players
[0m13:53:29.739815 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m13:53:29.741380 [info ] [Thread-1 (]: 3 of 6 START sql table model international_football.dim_teams .................. [RUN]
[0m13:53:29.743389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_players, now model.international_football.dim_teams)
[0m13:53:29.745522 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m13:53:29.752940 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m13:53:29.765948 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 13:53:29.747063 => 13:53:29.765496
[0m13:53:29.767452 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m13:53:29.770921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:30.406155 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m13:53:30.422823 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- dim_teams.sql

-- Create a dimension table for teams
WITH teams AS (
    SELECT
        ROW_NUMBER() OVER () AS team_id,
        team_name,
        team_country
    FROM (
        SELECT home_team AS team_name, country AS team_country
        FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
        UNION
        SELECT away_team AS team_name, country AS team_country
        FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    ) AS combined_teams
)
SELECT * FROM teams
    );
  
[0m13:53:30.810128 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:9]')
[0m13:53:31.386100 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:aed54fdc-faeb-4f12-968d-258b122f2165&page=queryresults
[0m13:53:31.388828 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 13:53:29.768605 => 13:53:31.388452
[0m13:53:31.395378 [debug] [Thread-1 (]: Database Error in model dim_teams (models/transform/dim_teams.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:9]
  compiled Code at target/run/international_football/models/transform/dim_teams.sql
[0m13:53:31.397478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc377ff-bb16-425b-b3a1-afb865208e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6f835f10>]}
[0m13:53:31.400203 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model international_football.dim_teams ......... [[31mERROR[0m in 1.65s]
[0m13:53:31.402362 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m13:53:31.404287 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m13:53:31.405980 [info ] [Thread-1 (]: 4 of 6 START sql table model international_football.dim_tournaments ............ [RUN]
[0m13:53:31.408420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m13:53:31.410193 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m13:53:31.414069 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m13:53:31.428894 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 13:53:31.411332 => 13:53:31.428406
[0m13:53:31.430729 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m13:53:31.434763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:32.030342 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m13:53:32.052275 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create a dimension table for tournaments
WITH tournaments AS (
    SELECT
        ROW_NUMBER() OVER () AS tournament_id,
        tournament AS tournament_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM tournaments
    );
  
[0m13:53:35.643294 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:496a995c-cdde-41df-b1b6-e823d09f5039&page=queryresults
[0m13:53:35.652570 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 13:53:31.432709 => 13:53:35.652255
[0m13:53:35.656450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc377ff-bb16-425b-b3a1-afb865208e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6f98f210>]}
[0m13:53:35.659674 [info ] [Thread-1 (]: 4 of 6 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (45.1k rows, 831.3 KiB processed)[0m in 4.25s]
[0m13:53:35.662534 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m13:53:35.664781 [debug] [Thread-1 (]: Began running node model.international_football.fact_match_results
[0m13:53:35.666344 [info ] [Thread-1 (]: 5 of 6 SKIP relation international_football.fact_match_results ................. [[33mSKIP[0m]
[0m13:53:35.667885 [debug] [Thread-1 (]: Finished running node model.international_football.fact_match_results
[0m13:53:35.670187 [debug] [Thread-1 (]: Began running node model.international_football.fact_home_win
[0m13:53:35.671741 [info ] [Thread-1 (]: 6 of 6 SKIP relation international_football.fact_home_win ...................... [[33mSKIP[0m]
[0m13:53:35.673371 [debug] [Thread-1 (]: Finished running node model.international_football.fact_home_win
[0m13:53:35.676114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:35.677413 [debug] [MainThread]: Connection 'model.international_football.dim_tournaments' was properly closed.
[0m13:53:35.678591 [info ] [MainThread]: 
[0m13:53:35.679988 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.12 seconds (18.12s).
[0m13:53:35.682185 [debug] [MainThread]: Command end result
[0m13:53:35.700281 [info ] [MainThread]: 
[0m13:53:35.701984 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:53:35.703572 [info ] [MainThread]: 
[0m13:53:35.705341 [error] [MainThread]: [33mDatabase Error in model dim_teams (models/transform/dim_teams.sql)[0m
[0m13:53:35.706712 [error] [MainThread]:   Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:9]
[0m13:53:35.708536 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_teams.sql
[0m13:53:35.710514 [info ] [MainThread]: 
[0m13:53:35.712279 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m13:53:35.714288 [debug] [MainThread]: Command `dbt run` failed at 13:53:35.714129 after 20.36 seconds
[0m13:53:35.715608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c71c76bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c71c1c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c7584e050>]}
[0m13:53:35.716878 [debug] [MainThread]: Flushing usage events
[0m13:54:18.645998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3f28cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3f576ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3f08ce10>]}


============================== 13:54:18.651099 | e65276c4-b167-4e36-8249-c03d18a934ef ==============================
[0m13:54:18.651099 [info ] [MainThread]: Running with dbt=1.5.9
[0m13:54:18.653177 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m13:54:19.048849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3d143690>]}
[0m13:54:19.063604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3cf5fa90>]}
[0m13:54:19.066069 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:54:19.112714 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m13:54:20.875547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:20.876972 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_teams.sql
[0m13:54:20.897857 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_teams.sql
[0m13:54:20.925170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3ce6b890>]}
[0m13:54:20.949866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3d03f1d0>]}
[0m13:54:20.951395 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m13:54:20.952762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d27d00490>]}
[0m13:54:20.955048 [info ] [MainThread]: 
[0m13:54:20.956732 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:54:20.959141 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m13:54:20.960345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:21.536379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m13:54:21.538525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:22.114893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3feeea50>]}
[0m13:54:22.116735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:22.118387 [info ] [MainThread]: 
[0m13:54:22.163116 [debug] [Thread-1 (]: Began running node model.international_football.dim_matches
[0m13:54:22.165862 [info ] [Thread-1 (]: 1 of 6 START sql table model international_football.dim_matches ................ [RUN]
[0m13:54:22.168917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_matches)
[0m13:54:22.170861 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_matches
[0m13:54:22.183682 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_matches"
[0m13:54:22.205657 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (compile): 13:54:22.172749 => 13:54:22.205280
[0m13:54:22.207509 [debug] [Thread-1 (]: Began executing node model.international_football.dim_matches
[0m13:54:22.225249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.824638 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_matches"
[0m13:54:22.848183 [debug] [Thread-1 (]: On model.international_football.dim_matches: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_matches"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_matches`
    
    

    OPTIONS()
    as (
      -- dim_matches.sql

-- Create a dimension table for matches
WITH matches AS (
    SELECT
        ROW_NUMBER() OVER () AS match_id,
        date AS match_date,
        home_team AS home_team_name,
        away_team AS away_team_name,
        tournament AS tournament_name,
        city AS match_city,
        country AS match_country,
        neutral AS match_neutral
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM matches
    );
  
[0m13:54:27.780625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:374bf806-15c5-437b-ad88-cf964e79730a&page=queryresults
[0m13:54:27.796114 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (execute): 13:54:22.209526 => 13:54:27.795941
[0m13:54:27.798310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3cf67210>]}
[0m13:54:27.800361 [info ] [Thread-1 (]: 1 of 6 OK created sql table model international_football.dim_matches ........... [[32mCREATE TABLE (45.1k rows, 2.9 MiB processed)[0m in 5.63s]
[0m13:54:27.802533 [debug] [Thread-1 (]: Finished running node model.international_football.dim_matches
[0m13:54:27.804476 [debug] [Thread-1 (]: Began running node model.international_football.dim_players
[0m13:54:27.807026 [info ] [Thread-1 (]: 2 of 6 START sql table model international_football.dim_players ................ [RUN]
[0m13:54:27.809711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_matches, now model.international_football.dim_players)
[0m13:54:27.811315 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_players
[0m13:54:27.815440 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_players"
[0m13:54:27.831364 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (compile): 13:54:27.812618 => 13:54:27.831001
[0m13:54:27.832665 [debug] [Thread-1 (]: Began executing node model.international_football.dim_players
[0m13:54:27.836025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.431585 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_players"
[0m13:54:28.444708 [debug] [Thread-1 (]: On model.international_football.dim_players: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_players"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_players`
    
    

    OPTIONS()
    as (
      -- dim_players.sql

-- Create a dimension table for players
WITH players AS (
    SELECT
        ROW_NUMBER() OVER () AS player_id,
        scorer AS player_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers`
)
SELECT * FROM players
    );
  
[0m13:54:33.879573 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:68384992-c605-4c76-82b8-3dc5de5fbfe2&page=queryresults
[0m13:54:33.884934 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (execute): 13:54:27.833754 => 13:54:33.884528
[0m13:54:33.887140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3ce99210>]}
[0m13:54:33.889340 [info ] [Thread-1 (]: 2 of 6 OK created sql table model international_football.dim_players ........... [[32mCREATE TABLE (41.1k rows, 649.2 KiB processed)[0m in 6.08s]
[0m13:54:33.891434 [debug] [Thread-1 (]: Finished running node model.international_football.dim_players
[0m13:54:33.893296 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m13:54:33.894881 [info ] [Thread-1 (]: 3 of 6 START sql table model international_football.dim_teams .................. [RUN]
[0m13:54:33.896813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_players, now model.international_football.dim_teams)
[0m13:54:33.898535 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m13:54:33.906570 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m13:54:33.924500 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 13:54:33.900260 => 13:54:33.924127
[0m13:54:33.926436 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m13:54:33.930291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:34.554055 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m13:54:34.570860 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- dim_teams.sql

-- Create a dimension table for teams
WITH teams AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS team_id,
        team_name,
        team_country
    FROM (
        SELECT home_team AS team_name, country AS team_country
        FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
        UNION ALL
        SELECT away_team AS team_name, country AS team_country
        FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    ) AS combined_teams
)
SELECT * FROM teams
    );
  
[0m13:54:38.723318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:253c2353-2d20-43c2-a066-1a0980bbb027&page=queryresults
[0m13:54:38.726397 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 13:54:33.927831 => 13:54:38.726226
[0m13:54:38.728112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3cf73210>]}
[0m13:54:38.729701 [info ] [Thread-1 (]: 3 of 6 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (90.2k rows, 1.3 MiB processed)[0m in 4.83s]
[0m13:54:38.731480 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m13:54:38.732811 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m13:54:38.734105 [info ] [Thread-1 (]: 4 of 6 START sql table model international_football.dim_tournaments ............ [RUN]
[0m13:54:38.735697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m13:54:38.736841 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m13:54:38.740637 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m13:54:38.754019 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 13:54:38.737875 => 13:54:38.753630
[0m13:54:38.756192 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m13:54:38.759277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:39.400126 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m13:54:39.418584 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create a dimension table for tournaments
WITH tournaments AS (
    SELECT
        ROW_NUMBER() OVER () AS tournament_id,
        tournament AS tournament_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM tournaments
    );
  
[0m13:54:43.081354 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:7c10cf90-a16f-4a3c-8ce9-14e28c1b0c2d&page=queryresults
[0m13:54:43.085378 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 13:54:38.757283 => 13:54:43.085115
[0m13:54:43.087437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3ce99410>]}
[0m13:54:43.089316 [info ] [Thread-1 (]: 4 of 6 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (45.1k rows, 831.3 KiB processed)[0m in 4.35s]
[0m13:54:43.091652 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m13:54:43.093149 [debug] [Thread-1 (]: Began running node model.international_football.fact_match_results
[0m13:54:43.094613 [info ] [Thread-1 (]: 5 of 6 START sql table model international_football.fact_match_results ......... [RUN]
[0m13:54:43.096339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_match_results)
[0m13:54:43.097799 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_match_results
[0m13:54:43.102783 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_match_results"
[0m13:54:43.116751 [debug] [Thread-1 (]: Timing info for model.international_football.fact_match_results (compile): 13:54:43.099203 => 13:54:43.116398
[0m13:54:43.118282 [debug] [Thread-1 (]: Began executing node model.international_football.fact_match_results
[0m13:54:43.122263 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_match_results"
[0m13:54:43.140802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:43.148132 [debug] [Thread-1 (]: On model.international_football.fact_match_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_match_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_match_results`
    
    

    OPTIONS()
    as (
      -- fact_match_results.sql

-- Create a fact table for match results
WITH match_results AS (
    SELECT
        m.match_id,
        m.match_date,
        m.tournament_name,
        m.match_city,
        m.match_country,
        m.match_neutral,
        t1.team_id AS home_team_id,
        t2.team_id AS away_team_id,
        r.home_score,
        r.away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_matches` m ON r.date = m.match_date
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` t1 ON r.home_team = t1.team_name
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` t2 ON r.away_team = t2.team_name
)
SELECT * FROM match_results
    );
  
[0m13:56:12.721900 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m13:59:49.336331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:49.338885 [debug] [MainThread]: Connection 'model.international_football.fact_match_results' was left open.
[0m13:59:49.340747 [info ] [MainThread]: 
[0m13:59:49.342709 [info ] [MainThread]: Finished running 4 table models in 0 hours 5 minutes and 28.38 seconds (328.38s).
[0m13:59:49.344431 [error] [MainThread]: Encountered an error:

[0m13:59:49.350098 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 352, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 260, in run_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 584, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 448, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 406, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 360, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 334, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:59:49.352374 [debug] [MainThread]: Command `dbt run` failed at 13:59:49.352177 after 330.74 seconds
[0m13:59:49.354385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3f28f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3f28c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d27d7bb10>]}
[0m13:59:49.355963 [debug] [MainThread]: Flushing usage events
[0m13:59:49.402812 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_match_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_match_results`
    
    

    OPTIONS()
    as (
      -- fact_match_results.sql

-- Create a fact table for match results
WITH match_results AS (
    SELECT
        m.match_id,
        m.match_date,
        m.tournament_name,
        m.match_city,
        m.match_country,
        m.match_neutral,
        t1.team_id AS home_team_id,
        t2.team_id AS away_team_id,
        r.home_score,
        r.away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_matches` m ON r.date = m.match_date
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` t1 ON r.home_team = t1.team_name
    JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` t2 ON r.away_team = t2.team_name
)
SELECT * FROM match_results
    );
  
[0m13:59:49.428605 [debug] [Thread-1 (]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m13:59:49.431404 [debug] [Thread-1 (]: Timing info for model.international_football.fact_match_results (execute): 13:54:43.119365 => 13:59:49.431018
[0m13:59:49.438787 [debug] [Thread-1 (]: Runtime Error in model fact_match_results (models/transform/fact_match_results.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m13:59:49.441026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e65276c4-b167-4e36-8249-c03d18a934ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d27d8af90>]}
[0m13:59:50.519396 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model international_football.fact_match_results  [[31mERROR[0m in 306.34s]
[0m13:59:50.527460 [debug] [Thread-1 (]: Finished running node model.international_football.fact_match_results
[0m14:00:30.328784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597eec5710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59800bdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ebbc250>]}


============================== 14:00:30.334003 | 4bb41017-e568-40f4-a2b1-0059327de640 ==============================
[0m14:00:30.334003 [info ] [MainThread]: Running with dbt=1.5.9
[0m14:00:30.335794 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True'}
[0m14:00:30.789020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb41017-e568-40f4-a2b1-0059327de640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597cc4c6d0>]}
[0m14:00:30.808087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb41017-e568-40f4-a2b1-0059327de640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ed9c310>]}
[0m14:00:30.810788 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:00:30.865593 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m14:00:33.322989 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:00:33.325032 [debug] [MainThread]: Partial parsing: added file: international_football://models/sources/fact_match_results.sql
[0m14:00:33.326596 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/fact_match_results.sql
[0m14:00:33.356193 [debug] [MainThread]: 1699: static parser successfully parsed sources/fact_match_results.sql
[0m14:00:33.375082 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_home_win.sql
[0m14:00:33.405364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bb41017-e568-40f4-a2b1-0059327de640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ca739d0>]}
[0m14:00:33.430978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bb41017-e568-40f4-a2b1-0059327de640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597c97c8d0>]}
[0m14:00:33.432419 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:00:33.433763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb41017-e568-40f4-a2b1-0059327de640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5981cc7310>]}
[0m14:00:33.436084 [info ] [MainThread]: 
[0m14:00:33.442665 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:00:33.445890 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m14:00:33.447634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:34.089931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m14:00:34.091584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:34.927463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb41017-e568-40f4-a2b1-0059327de640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597fa06a50>]}
[0m14:00:34.931494 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:34.933951 [info ] [MainThread]: 
[0m14:00:34.951105 [debug] [Thread-1 (]: Began running node model.international_football.dim_matches
[0m14:00:34.953021 [info ] [Thread-1 (]: 1 of 6 START sql table model international_football.dim_matches ................ [RUN]
[0m14:00:34.955530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_matches)
[0m14:00:34.957646 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_matches
[0m14:00:34.967630 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_matches"
[0m14:00:34.989285 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (compile): 14:00:34.961086 => 14:00:34.988895
[0m14:00:34.991233 [debug] [Thread-1 (]: Began executing node model.international_football.dim_matches
[0m14:00:35.007910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:35.949626 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_matches"
[0m14:00:35.973187 [debug] [Thread-1 (]: On model.international_football.dim_matches: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_matches"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_matches`
    
    

    OPTIONS()
    as (
      -- dim_matches.sql

-- Create a dimension table for matches
WITH matches AS (
    SELECT
        ROW_NUMBER() OVER () AS match_id,
        date AS match_date,
        home_team AS home_team_name,
        away_team AS away_team_name,
        tournament AS tournament_name,
        city AS match_city,
        country AS match_country,
        neutral AS match_neutral
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT * FROM matches
    );
  
[0m14:00:40.045289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:881aa45e-4380-4847-a1c3-30b4305c74bd&page=queryresults
[0m14:00:40.061869 [debug] [Thread-1 (]: Timing info for model.international_football.dim_matches (execute): 14:00:34.993323 => 14:00:40.061670
[0m14:00:40.064827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bb41017-e568-40f4-a2b1-0059327de640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597cacf590>]}
[0m14:00:40.067090 [info ] [Thread-1 (]: 1 of 6 OK created sql table model international_football.dim_matches ........... [[32mCREATE TABLE (45.1k rows, 2.9 MiB processed)[0m in 5.11s]
[0m14:00:40.069535 [debug] [Thread-1 (]: Finished running node model.international_football.dim_matches
[0m14:00:40.071645 [debug] [Thread-1 (]: Began running node model.international_football.dim_players
[0m14:00:40.073001 [info ] [Thread-1 (]: 2 of 6 START sql table model international_football.dim_players ................ [RUN]
[0m14:00:40.074869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_matches, now model.international_football.dim_players)
[0m14:00:40.076314 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_players
[0m14:00:40.090205 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_players"
[0m14:00:40.109038 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (compile): 14:00:40.077501 => 14:00:40.108404
[0m14:00:40.111205 [debug] [Thread-1 (]: Began executing node model.international_football.dim_players
[0m14:00:40.114244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:40.717495 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_players"
[0m14:00:40.734576 [debug] [Thread-1 (]: On model.international_football.dim_players: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_players"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_players`
    
    

    OPTIONS()
    as (
      -- dim_players.sql

-- Create a dimension table for players
WITH players AS (
    SELECT
        ROW_NUMBER() OVER () AS player_id,
        scorer AS player_name
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers`
)
SELECT * FROM players
    );
  
[0m14:00:44.513428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:42747231-b2c3-4124-9038-46399ecb4ff5&page=queryresults
[0m14:00:44.518351 [debug] [Thread-1 (]: Timing info for model.international_football.dim_players (execute): 14:00:40.112338 => 14:00:44.518147
[0m14:00:44.521812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bb41017-e568-40f4-a2b1-0059327de640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ca73e50>]}
[0m14:00:44.523918 [info ] [Thread-1 (]: 2 of 6 OK created sql table model international_football.dim_players ........... [[32mCREATE TABLE (41.1k rows, 649.2 KiB processed)[0m in 4.45s]
[0m14:00:44.526212 [debug] [Thread-1 (]: Finished running node model.international_football.dim_players
[0m14:00:44.528211 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m14:00:44.529762 [info ] [Thread-1 (]: 3 of 6 START sql table model international_football.dim_teams .................. [RUN]
[0m14:00:44.531639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_players, now model.international_football.dim_teams)
[0m14:00:44.533064 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m14:00:44.542608 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m14:00:44.563525 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 14:00:44.535275 => 14:00:44.562552
[0m14:00:44.566014 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m14:00:44.570354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:45.303983 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m14:00:45.322055 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- dim_teams.sql

-- Create a dimension table for teams
WITH teams AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS team_id,
        team_name,
        team_country
    FROM (
        SELECT home_team AS team_name, country AS team_country
        FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
        UNION ALL
        SELECT away_team AS team_name, country AS team_country
        FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    ) AS combined_teams
)
SELECT * FROM teams
    );
  
[0m14:00:59.892482 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m14:01:00.362208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:00.364298 [debug] [MainThread]: Connection 'model.international_football.dim_teams' was left open.
[0m14:01:00.365852 [info ] [MainThread]: 
[0m14:01:00.367284 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 26.92 seconds (26.92s).
[0m14:01:00.368834 [error] [MainThread]: Encountered an error:

[0m14:01:00.371795 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 352, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 260, in run_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 584, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 448, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 406, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 360, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 334, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m14:01:00.373452 [debug] [MainThread]: Command `dbt run` failed at 14:01:00.373274 after 30.09 seconds
[0m14:01:00.374875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597efe0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597f0b2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ca988d0>]}
[0m14:01:00.376294 [debug] [MainThread]: Flushing usage events
[0m14:01:04.985468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be26bf590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be2529990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be2879ad0>]}


============================== 14:01:04.991053 | fb47dd90-4e1a-41dd-b8f4-7186f0012abd ==============================
[0m14:01:04.991053 [info ] [MainThread]: Running with dbt=1.5.9
[0m14:01:04.992887 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m14:01:05.411072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb47dd90-4e1a-41dd-b8f4-7186f0012abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be055ec50>]}
[0m14:01:05.425829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb47dd90-4e1a-41dd-b8f4-7186f0012abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be052d890>]}
[0m14:01:05.428920 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:01:05.472682 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m14:01:07.375264 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m14:01:07.376990 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/sources/fact_match_results.sql
[0m14:01:07.399967 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_home_win.sql
[0m14:01:07.412170 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.international_football.fact_home_win' (models/transform/fact_home_win.sql) depends on a node named 'fact_match_results' which was not found
[0m14:01:07.414966 [debug] [MainThread]: Command `dbt run` failed at 14:01:07.414611 after 2.47 seconds
[0m14:01:07.416946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be29dba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be29d9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be03d1b90>]}
[0m14:01:07.418767 [debug] [MainThread]: Flushing usage events
[0m14:15:26.342565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97ee16b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97ee29410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97ee2b350>]}


============================== 14:15:26.347255 | 2e489e24-34b5-42d1-9aa8-156d36f7cc58 ==============================
[0m14:15:26.347255 [info ] [MainThread]: Running with dbt=1.5.9
[0m14:15:26.348887 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error': 'None', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'printer_width': '80'}
[0m14:15:26.728900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e489e24-34b5-42d1-9aa8-156d36f7cc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97c7ff310>]}
[0m14:15:26.743211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e489e24-34b5-42d1-9aa8-156d36f7cc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97c9e2bd0>]}
[0m14:15:26.745625 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:15:26.791580 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m14:15:28.459896 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 2 files added, 2 files changed.
[0m14:15:28.461696 [debug] [MainThread]: Partial parsing: added file: international_football://models/transform/dim_goalscorers.sql
[0m14:15:28.462999 [debug] [MainThread]: Partial parsing: added file: international_football://models/transform/fact_match_results.sql
[0m14:15:28.464322 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/dim_players.sql
[0m14:15:28.465834 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/fact_home_win.sql
[0m14:15:28.467646 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/dim_tournaments.sql
[0m14:15:28.469360 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/sources/fact_match_results.sql
[0m14:15:28.471180 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_matches.sql
[0m14:15:28.473045 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_teams.sql
[0m14:15:28.495821 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_goalscorers.sql
[0m14:15:28.509552 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_match_results.sql
[0m14:15:28.514597 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_matches.sql
[0m14:15:28.520210 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_teams.sql
[0m14:15:28.523820 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.international_football.fact_match_results' (models/transform/fact_match_results.sql) depends on a source named 'international_football.dim_teams' which was not found
[0m14:15:28.526043 [debug] [MainThread]: Command `dbt run` failed at 14:15:28.525726 after 2.22 seconds
[0m14:15:28.528192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97e9fa5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97ee0cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97ee3c650>]}
[0m14:15:28.530606 [debug] [MainThread]: Flushing usage events
[0m15:12:40.930592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4027dd45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4027d87c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4027dc88d0>]}


============================== 15:12:40.935978 | 42f31027-c45e-4d44-b916-39576cb57037 ==============================
[0m15:12:40.935978 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:12:40.938110 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:12:41.358966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4025cab8d0>]}
[0m15:12:41.374986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4025c93b50>]}
[0m15:12:41.377534 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:12:41.425654 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:12:43.124621 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 4 files added, 1 files changed.
[0m15:12:43.126086 [debug] [MainThread]: Partial parsing: added file: international_football://models/transform/dim_team_stats.sql
[0m15:12:43.127354 [debug] [MainThread]: Partial parsing: added file: international_football://models/transform/fact_tournaments.sql
[0m15:12:43.128536 [debug] [MainThread]: Partial parsing: added file: international_football://models/transform/fact_friendlies.sql
[0m15:12:43.129617 [debug] [MainThread]: Partial parsing: added file: international_football://models/transform/fact_results.sql
[0m15:12:43.130743 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/dim_matches.sql
[0m15:12:43.131734 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/fact_home_win.sql
[0m15:12:43.132717 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/dim_teams.sql
[0m15:12:43.133704 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/sources/fact_match_results.sql
[0m15:12:43.134677 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/dim_players.sql
[0m15:12:43.135937 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_tournaments.sql
[0m15:12:43.157096 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_team_stats.sql
[0m15:12:43.169452 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_tournaments.sql
[0m15:12:43.174456 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_friendlies.sql
[0m15:12:43.179620 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_results.sql
[0m15:12:43.185107 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_tournaments.sql
[0m15:12:43.209876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4025cb21d0>]}
[0m15:12:43.236337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4025a12490>]}
[0m15:12:43.238086 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:12:43.239823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402ad53a90>]}
[0m15:12:43.242302 [info ] [MainThread]: 
[0m15:12:43.244190 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:12:43.246564 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:12:43.247773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:43.861170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:12:43.863776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:44.419922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4027dcb010>]}
[0m15:12:44.422138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:44.423791 [info ] [MainThread]: 
[0m15:12:44.441643 [debug] [Thread-1 (]: Began running node model.international_football.dim_team_stats
[0m15:12:44.444243 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_team_stats ............. [RUN]
[0m15:12:44.446887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_team_stats)
[0m15:12:44.449214 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_team_stats
[0m15:12:44.460224 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_team_stats"
[0m15:12:44.481532 [debug] [Thread-1 (]: Timing info for model.international_football.dim_team_stats (compile): 15:12:44.451170 => 15:12:44.481171
[0m15:12:44.483562 [debug] [Thread-1 (]: Began executing node model.international_football.dim_team_stats
[0m15:12:44.521519 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_team_stats"
[0m15:12:44.539539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:44.547126 [debug] [Thread-1 (]: On model.international_football.dim_team_stats: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_team_stats"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_team_stats`
    
    

    OPTIONS()
    as (
      -- dim_team_stats.sql

-- Create dim_teams table with unique team names
WITH team_stats AS (
    SELECT
        team AS team_name,
        SUM(CASE WHEN team = home_team THEN 1 ELSE 0 END) AS home_wins,
        SUM(CASE WHEN team = away_team THEN 1 ELSE 0 END) AS away_wins,
        SUM(CASE WHEN team = home_team THEN away_score ELSE home_score END) AS goals_scored,
        SUM(CASE WHEN team = home_team THEN home_score ELSE away_score END) AS goals_conceded
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY
        team
)

SELECT
    ROW_NUMBER() OVER () AS team_id,
    team_name,
    home_wins,
    away_wins,
    goals_scored,
    goals_conceded
FROM
    team_stats
    );
  
[0m15:12:46.099882 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: team at [17:9]')
[0m15:12:47.903087 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:0a5151cb-c898-454a-a55f-74b844080448&page=queryresults
[0m15:12:47.906427 [debug] [Thread-1 (]: Timing info for model.international_football.dim_team_stats (execute): 15:12:44.485875 => 15:12:47.906114
[0m15:12:47.915341 [debug] [Thread-1 (]: Database Error in model dim_team_stats (models/transform/dim_team_stats.sql)
  Unrecognized name: team at [17:9]
  compiled Code at target/run/international_football/models/transform/dim_team_stats.sql
[0m15:12:47.917550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4025b9a1d0>]}
[0m15:12:47.919914 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model international_football.dim_team_stats .... [[31mERROR[0m in 3.47s]
[0m15:12:47.922022 [debug] [Thread-1 (]: Finished running node model.international_football.dim_team_stats
[0m15:12:47.924124 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:12:47.925874 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:12:47.928197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_team_stats, now model.international_football.dim_tournaments)
[0m15:12:47.930077 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:12:47.937045 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:12:47.957369 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:12:47.931766 => 15:12:47.956852
[0m15:12:47.959189 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:12:47.973085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:48.535165 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:12:48.549965 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create dim_tournaments table with unique tournament names
WITH tournament_teams AS (
    SELECT DISTINCT
        tournament,
        home_team AS team_name
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    UNION ALL
    SELECT DISTINCT
        tournament,
        away_team AS team_name
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)

SELECT
    ROW_NUMBER() OVER () AS tournament_id,
    tournament,
    team_name
FROM
    tournament_teams;
    );
  
[0m15:12:48.915816 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [34:21]')
[0m15:12:50.118140 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:1428fd74-6ef8-4df6-ba0f-bf3fa4bf702c&page=queryresults
[0m15:12:50.122226 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:12:47.960554 => 15:12:50.121564
[0m15:12:50.126278 [debug] [Thread-1 (]: Database Error in model dim_tournaments (models/transform/dim_tournaments.sql)
  Syntax error: Expected ")" but got ";" at [34:21]
  compiled Code at target/run/international_football/models/transform/dim_tournaments.sql
[0m15:12:50.128137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40249afd10>]}
[0m15:12:50.129909 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model international_football.dim_tournaments ... [[31mERROR[0m in 2.20s]
[0m15:12:50.131695 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:12:50.133126 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:12:50.134530 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m15:12:50.136218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_friendlies)
[0m15:12:50.137394 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m15:12:50.141190 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m15:12:50.154471 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 15:12:50.138371 => 15:12:50.154091
[0m15:12:50.155977 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m15:12:50.159881 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m15:12:50.175081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:50.180524 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- fact_friendlies.sql

-- Create fact_friendlies table with friendly matches
WITH friendly_matches AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.tournament,
        r.neutral
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    WHERE
        r.tournament LIKE '%friendly%'
)

SELECT
    ROW_NUMBER() OVER () AS friendly_id,
    fm.date,
    fm.home_team,
    fm.away_team,
    fm.tournament,
    fm.neutral
FROM
    friendly_matches fm
    );
  
[0m15:12:54.043703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:f0a71efb-4efc-4801-b3bd-579dc949d49e&page=queryresults
[0m15:12:54.056896 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 15:12:50.157253 => 15:12:54.056709
[0m15:12:54.060033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4025ce6350>]}
[0m15:12:54.062643 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (0.0 rows, 2.1 MiB processed)[0m in 3.92s]
[0m15:12:54.064850 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:12:54.066563 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:12:54.068006 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:12:54.069945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_friendlies, now model.international_football.fact_results)
[0m15:12:54.071372 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:12:54.075703 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:12:54.090114 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:12:54.072556 => 15:12:54.089704
[0m15:12:54.091754 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:12:54.095824 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:12:54.111096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:54.118284 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- fact_results.sql

-- Create fact_results table by combining data from raw_results and raw_goalscorers
WITH result_data AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.home_score,
        r.away_score,
        r.tournament,
        r.city,
        r.country,
        r.neutral,
        CASE
            WHEN r.home_score > r.away_score THEN r.home_team
            WHEN r.away_score > r.home_score THEN r.away_team
            ELSE NULL
        END AS winner
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    UNION ALL
    SELECT
        g.date,
        g.home_team,
        g.away_team,
        NULL AS home_score,
        NULL AS away_score,
        NULL AS tournament,
        NULL AS city,
        NULL AS country,
        NULL AS neutral,
        NULL AS winner
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers` g
)

SELECT
    ROW_NUMBER() OVER () AS result_id,
    rd.date,
    rd.home_team,
    rd.away_team,
    rd.home_score,
    rd.away_score,
    rd.tournament,
    rd.city,
    rd.country,
    rd.neutral,
    rd.winner,
    g.team AS goal_scorer_team,
    g.scorer AS goal_scorer,
    g.own_goal,
    g.penalty
FROM
    result_data rd
LEFT JOIN
    `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers` g
ON
    rd.date = g.date
    AND (rd.home_team = g.home_team OR rd.away_team = g.away_team)
    );
  
[0m15:12:59.114710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:e1025154-5f5f-4239-a8c4-f61874957eab&page=queryresults
[0m15:12:59.120343 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:12:54.093088 => 15:12:59.120154
[0m15:12:59.122397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4025b61ed0>]}
[0m15:12:59.124068 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (246.9k rows, 5.8 MiB processed)[0m in 5.05s]
[0m15:12:59.126035 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:12:59.127993 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:12:59.129580 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:12:59.131694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:12:59.133297 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:12:59.137100 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:12:59.153493 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:12:59.134613 => 15:12:59.153093
[0m15:12:59.155131 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:12:59.158902 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:12:59.173108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:59.179864 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- fact_tournaments.sql

-- Create fact_tournaments table with matches where neutral is TRUE
WITH neutral_matches AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.tournament,
        r.neutral
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    WHERE
        r.neutral = TRUE
)

SELECT
    ROW_NUMBER() OVER () AS tournament_id,
    nm.date,
    nm.home_team,
    nm.away_team,
    nm.tournament,
    nm.neutral
FROM
    neutral_matches nm
    );
  
[0m15:13:02.961250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:25aff384-bdcb-46ca-b33d-804079dfa33e&page=queryresults
[0m15:13:02.964797 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:12:59.156259 => 15:13:02.964625
[0m15:13:02.966790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f31027-c45e-4d44-b916-39576cb57037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40248f1d90>]}
[0m15:13:02.968688 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (11.2k rows, 2.1 MiB processed)[0m in 3.84s]
[0m15:13:02.970682 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:13:02.973901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:02.975293 [debug] [MainThread]: Connection 'model.international_football.fact_tournaments' was properly closed.
[0m15:13:02.976718 [info ] [MainThread]: 
[0m15:13:02.978053 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 19.73 seconds (19.73s).
[0m15:13:02.980506 [debug] [MainThread]: Command end result
[0m15:13:03.010233 [info ] [MainThread]: 
[0m15:13:03.012269 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:13:03.014089 [info ] [MainThread]: 
[0m15:13:03.015987 [error] [MainThread]: [33mDatabase Error in model dim_team_stats (models/transform/dim_team_stats.sql)[0m
[0m15:13:03.017432 [error] [MainThread]:   Unrecognized name: team at [17:9]
[0m15:13:03.018901 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_team_stats.sql
[0m15:13:03.020216 [info ] [MainThread]: 
[0m15:13:03.021461 [error] [MainThread]: [33mDatabase Error in model dim_tournaments (models/transform/dim_tournaments.sql)[0m
[0m15:13:03.022666 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [34:21]
[0m15:13:03.023909 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_tournaments.sql
[0m15:13:03.025173 [info ] [MainThread]: 
[0m15:13:03.026453 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m15:13:03.028368 [debug] [MainThread]: Command `dbt run` failed at 15:13:03.028191 after 22.14 seconds
[0m15:13:03.030436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4027f7ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4027dd6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4027835750>]}
[0m15:13:03.031883 [debug] [MainThread]: Flushing usage events
[0m15:14:48.421108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd106c4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd10608b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1410a1d0>]}


============================== 15:14:48.425986 | 8fe72d30-0fdb-4ce1-9eb3-60351e3fe063 ==============================
[0m15:14:48.425986 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:14:48.428072 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error': 'None', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m15:14:48.817137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0e282a90>]}
[0m15:14:48.831887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd106da9d0>]}
[0m15:14:48.833817 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:14:48.882893 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:14:50.698484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:50.700354 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_tournaments.sql
[0m15:14:50.722117 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_tournaments.sql
[0m15:14:50.751874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0dffa110>]}
[0m15:14:50.777834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0dfde910>]}
[0m15:14:50.779609 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:14:50.781596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd132f3a10>]}
[0m15:14:50.784564 [info ] [MainThread]: 
[0m15:14:50.786663 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:14:50.789363 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:14:50.791155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:51.324402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:14:51.328107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:51.866247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0e0977d0>]}
[0m15:14:51.868860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:51.870893 [info ] [MainThread]: 
[0m15:14:51.885374 [debug] [Thread-1 (]: Began running node model.international_football.dim_team_stats
[0m15:14:51.887651 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_team_stats ............. [RUN]
[0m15:14:51.890223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_team_stats)
[0m15:14:51.892115 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_team_stats
[0m15:14:51.900677 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_team_stats"
[0m15:14:51.917260 [debug] [Thread-1 (]: Timing info for model.international_football.dim_team_stats (compile): 15:14:51.893828 => 15:14:51.916733
[0m15:14:51.919629 [debug] [Thread-1 (]: Began executing node model.international_football.dim_team_stats
[0m15:14:51.961254 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_team_stats"
[0m15:14:51.980038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:51.988528 [debug] [Thread-1 (]: On model.international_football.dim_team_stats: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_team_stats"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_team_stats`
    
    

    OPTIONS()
    as (
      -- dim_team_stats.sql

-- Create dim_teams table with unique team names
WITH team_stats AS (
    SELECT
        team AS team_name,
        SUM(CASE WHEN team = home_team THEN 1 ELSE 0 END) AS home_wins,
        SUM(CASE WHEN team = away_team THEN 1 ELSE 0 END) AS away_wins,
        SUM(CASE WHEN team = home_team THEN away_score ELSE home_score END) AS goals_scored,
        SUM(CASE WHEN team = home_team THEN home_score ELSE away_score END) AS goals_conceded
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY
        team
)

SELECT
    ROW_NUMBER() OVER () AS team_id,
    team_name,
    home_wins,
    away_wins,
    goals_scored,
    goals_conceded
FROM
    team_stats
    );
  
[0m15:14:53.479318 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: team at [17:9]')
[0m15:14:55.220663 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:71ddbf7c-bbe4-4dc3-b1a4-d31a3929507f&page=queryresults
[0m15:14:55.224651 [debug] [Thread-1 (]: Timing info for model.international_football.dim_team_stats (execute): 15:14:51.921241 => 15:14:55.224174
[0m15:14:55.229651 [debug] [Thread-1 (]: Database Error in model dim_team_stats (models/transform/dim_team_stats.sql)
  Unrecognized name: team at [17:9]
  compiled Code at target/run/international_football/models/transform/dim_team_stats.sql
[0m15:14:55.231380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0e0bdb50>]}
[0m15:14:55.233342 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model international_football.dim_team_stats .... [[31mERROR[0m in 3.34s]
[0m15:14:55.235188 [debug] [Thread-1 (]: Finished running node model.international_football.dim_team_stats
[0m15:14:55.236738 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:14:55.238450 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:14:55.240588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_team_stats, now model.international_football.dim_tournaments)
[0m15:14:55.242221 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:14:55.248615 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:14:55.265008 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:14:55.243508 => 15:14:55.264598
[0m15:14:55.266453 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:14:55.270304 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:14:55.284792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:55.290992 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create dim_tournaments table with unique tournament names
WITH tournament_teams AS (
    SELECT DISTINCT
        tournament,
        home_team AS team_name
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    UNION ALL
    SELECT DISTINCT
        tournament,
        away_team AS team_name
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)

SELECT
    ROW_NUMBER() OVER () AS tournament_id,
    tournament,
    team_name
FROM
    tournament_teams
    );
  
[0m15:14:59.050005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:87ba3c89-1e87-4f20-8a77-881fd18c0772&page=queryresults
[0m15:14:59.067642 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:14:55.267532 => 15:14:59.067419
[0m15:14:59.070282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd10cd8c50>]}
[0m15:14:59.072941 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (4.4k rows, 1.7 MiB processed)[0m in 3.83s]
[0m15:14:59.075000 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:14:59.077237 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:14:59.079129 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m15:14:59.081411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_friendlies)
[0m15:14:59.083243 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m15:14:59.087381 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m15:14:59.101619 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 15:14:59.084484 => 15:14:59.101242
[0m15:14:59.103294 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m15:14:59.107651 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m15:14:59.124349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.132318 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- fact_friendlies.sql

-- Create fact_friendlies table with friendly matches
WITH friendly_matches AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.tournament,
        r.neutral
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    WHERE
        r.tournament LIKE '%friendly%'
)

SELECT
    ROW_NUMBER() OVER () AS friendly_id,
    fm.date,
    fm.home_team,
    fm.away_team,
    fm.tournament,
    fm.neutral
FROM
    friendly_matches fm
    );
  
[0m15:15:02.637925 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:563b9bd4-440e-4a6e-b227-05605c41d4fc&page=queryresults
[0m15:15:02.642604 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 15:14:59.104798 => 15:15:02.642096
[0m15:15:02.644928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0d3c2fd0>]}
[0m15:15:02.646792 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (0.0 rows, 2.1 MiB processed)[0m in 3.56s]
[0m15:15:02.648766 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:15:02.650249 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:15:02.651702 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:15:02.653581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_friendlies, now model.international_football.fact_results)
[0m15:15:02.655043 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:15:02.660495 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:15:02.679263 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:15:02.656170 => 15:15:02.678614
[0m15:15:02.681943 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:15:02.689168 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:15:02.714117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:02.725850 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- fact_results.sql

-- Create fact_results table by combining data from raw_results and raw_goalscorers
WITH result_data AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.home_score,
        r.away_score,
        r.tournament,
        r.city,
        r.country,
        r.neutral,
        CASE
            WHEN r.home_score > r.away_score THEN r.home_team
            WHEN r.away_score > r.home_score THEN r.away_team
            ELSE NULL
        END AS winner
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    UNION ALL
    SELECT
        g.date,
        g.home_team,
        g.away_team,
        NULL AS home_score,
        NULL AS away_score,
        NULL AS tournament,
        NULL AS city,
        NULL AS country,
        NULL AS neutral,
        NULL AS winner
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers` g
)

SELECT
    ROW_NUMBER() OVER () AS result_id,
    rd.date,
    rd.home_team,
    rd.away_team,
    rd.home_score,
    rd.away_score,
    rd.tournament,
    rd.city,
    rd.country,
    rd.neutral,
    rd.winner,
    g.team AS goal_scorer_team,
    g.scorer AS goal_scorer,
    g.own_goal,
    g.penalty
FROM
    result_data rd
LEFT JOIN
    `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers` g
ON
    rd.date = g.date
    AND (rd.home_team = g.home_team OR rd.away_team = g.away_team)
    );
  
[0m15:15:08.301857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:acda77e4-5c4f-43b9-ac5a-5b580ef26608&page=queryresults
[0m15:15:08.306701 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:15:02.685142 => 15:15:08.306517
[0m15:15:08.309841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0e15a410>]}
[0m15:15:08.312561 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (246.9k rows, 5.8 MiB processed)[0m in 5.66s]
[0m15:15:08.315129 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:15:08.316843 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:15:08.318505 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:15:08.320346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:15:08.321712 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:15:08.325451 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:15:08.338212 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:15:08.322897 => 15:15:08.337850
[0m15:15:08.339804 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:15:08.344047 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:15:08.359727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:08.366365 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- fact_tournaments.sql

-- Create fact_tournaments table with matches where neutral is TRUE
WITH neutral_matches AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.tournament,
        r.neutral
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    WHERE
        r.neutral = TRUE
)

SELECT
    ROW_NUMBER() OVER () AS tournament_id,
    nm.date,
    nm.home_team,
    nm.away_team,
    nm.tournament,
    nm.neutral
FROM
    neutral_matches nm
    );
  
[0m15:15:12.103832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:7b1d5db1-38c3-477e-861e-3d9ef6098396&page=queryresults
[0m15:15:12.108704 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:15:08.341053 => 15:15:12.108533
[0m15:15:12.111632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe72d30-0fdb-4ce1-9eb3-60351e3fe063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0e0f9d10>]}
[0m15:15:12.113544 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (11.2k rows, 2.1 MiB processed)[0m in 3.79s]
[0m15:15:12.115420 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:15:12.118323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:12.119441 [debug] [MainThread]: Connection 'model.international_football.fact_tournaments' was properly closed.
[0m15:15:12.120527 [info ] [MainThread]: 
[0m15:15:12.122029 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 21.33 seconds (21.33s).
[0m15:15:12.124791 [debug] [MainThread]: Command end result
[0m15:15:12.154465 [info ] [MainThread]: 
[0m15:15:12.156165 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:15:12.157406 [info ] [MainThread]: 
[0m15:15:12.158695 [error] [MainThread]: [33mDatabase Error in model dim_team_stats (models/transform/dim_team_stats.sql)[0m
[0m15:15:12.159997 [error] [MainThread]:   Unrecognized name: team at [17:9]
[0m15:15:12.161651 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_team_stats.sql
[0m15:15:12.163850 [info ] [MainThread]: 
[0m15:15:12.165425 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:15:12.167487 [debug] [MainThread]: Command `dbt run` failed at 15:15:12.167292 after 23.79 seconds
[0m15:15:12.168969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0fd43ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0fd41690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd106b3b90>]}
[0m15:15:12.170262 [debug] [MainThread]: Flushing usage events
[0m15:16:21.155626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab53c4150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab4eb0ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab4f70250>]}


============================== 15:16:21.160543 | 8ad8fcfc-295f-44a0-ab04-843c23156096 ==============================
[0m15:16:21.160543 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:16:21.162334 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'printer_width': '80'}
[0m15:16:21.552645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2f1e710>]}
[0m15:16:21.567724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2ee6dd0>]}
[0m15:16:21.570233 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:16:21.615705 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:16:23.641619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:23.643470 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_team_stats.sql
[0m15:16:23.665991 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_team_stats.sql
[0m15:16:23.694162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2e06110>]}
[0m15:16:23.717483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2e72690>]}
[0m15:16:23.718934 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:16:23.720801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab7fe3690>]}
[0m15:16:23.723327 [info ] [MainThread]: 
[0m15:16:23.725657 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:16:23.728159 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:16:23.729635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:24.274634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:16:24.277317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:24.807135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab5d06ad0>]}
[0m15:16:24.811230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:16:24.813731 [info ] [MainThread]: 
[0m15:16:24.828065 [debug] [Thread-1 (]: Began running node model.international_football.dim_team_stats
[0m15:16:24.830235 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_team_stats ............. [RUN]
[0m15:16:24.832369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_team_stats)
[0m15:16:24.834068 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_team_stats
[0m15:16:24.841972 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_team_stats"
[0m15:16:24.858823 [debug] [Thread-1 (]: Timing info for model.international_football.dim_team_stats (compile): 15:16:24.835440 => 15:16:24.858440
[0m15:16:24.861078 [debug] [Thread-1 (]: Began executing node model.international_football.dim_team_stats
[0m15:16:24.894542 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_team_stats"
[0m15:16:24.914633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:24.921289 [debug] [Thread-1 (]: On model.international_football.dim_team_stats: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_team_stats"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_team_stats`
    
    

    OPTIONS()
    as (
      -- dim_team_stats.sql

-- Create dim_teams table with unique team names and team statistics
WITH team_stats AS (
    SELECT
        team AS team_name,
        SUM(CASE WHEN home_team = team THEN 1 ELSE 0 END) AS home_wins,
        SUM(CASE WHEN away_team = team THEN 1 ELSE 0 END) AS away_wins,
        SUM(CASE WHEN home_team = team THEN away_score ELSE home_score END) AS goals_scored,
        SUM(CASE WHEN away_team = team THEN away_score ELSE home_score END) AS goals_conceded
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY
        team
)

SELECT
    ROW_NUMBER() OVER () AS team_id,
    team_name,
    home_wins,
    away_wins,
    goals_scored,
    goals_conceded
FROM
    team_stats
    );
  
[0m15:16:26.317878 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: team at [17:9]')
[0m15:16:27.588847 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:40322a29-fb77-48c0-811b-b23836f20d03&page=queryresults
[0m15:16:27.591681 [debug] [Thread-1 (]: Timing info for model.international_football.dim_team_stats (execute): 15:16:24.863045 => 15:16:27.591165
[0m15:16:27.597965 [debug] [Thread-1 (]: Database Error in model dim_team_stats (models/transform/dim_team_stats.sql)
  Unrecognized name: team at [17:9]
  compiled Code at target/run/international_football/models/transform/dim_team_stats.sql
[0m15:16:27.600372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2e52810>]}
[0m15:16:27.605026 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model international_football.dim_team_stats .... [[31mERROR[0m in 2.77s]
[0m15:16:27.607279 [debug] [Thread-1 (]: Finished running node model.international_football.dim_team_stats
[0m15:16:27.609572 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:16:27.612218 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:16:27.616788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_team_stats, now model.international_football.dim_tournaments)
[0m15:16:27.619098 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:16:27.631727 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:16:27.658776 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:16:27.621061 => 15:16:27.658321
[0m15:16:27.661138 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:16:27.668885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:28.236937 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:16:28.256685 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create dim_tournaments table with unique tournament names
WITH tournament_teams AS (
    SELECT DISTINCT
        tournament,
        home_team AS team_name
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    UNION ALL
    SELECT DISTINCT
        tournament,
        away_team AS team_name
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)

SELECT
    ROW_NUMBER() OVER () AS tournament_id,
    tournament,
    team_name
FROM
    tournament_teams
    );
  
[0m15:16:32.417363 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:4389025b-46b4-4860-a844-7c97af728e24&page=queryresults
[0m15:16:32.433761 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:16:27.665843 => 15:16:32.433584
[0m15:16:32.435972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2f0c8d0>]}
[0m15:16:32.438391 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (4.4k rows, 1.7 MiB processed)[0m in 4.82s]
[0m15:16:32.441161 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:16:32.443053 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:16:32.444516 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m15:16:32.446478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_friendlies)
[0m15:16:32.448281 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m15:16:32.452387 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m15:16:32.470566 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 15:16:32.449572 => 15:16:32.470180
[0m15:16:32.472088 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m15:16:32.475422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:33.028312 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m15:16:33.049449 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- fact_friendlies.sql

-- Create fact_friendlies table with friendly matches
WITH friendly_matches AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.tournament,
        r.neutral
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    WHERE
        r.tournament LIKE '%friendly%'
)

SELECT
    ROW_NUMBER() OVER () AS friendly_id,
    fm.date,
    fm.home_team,
    fm.away_team,
    fm.tournament,
    fm.neutral
FROM
    friendly_matches fm
    );
  
[0m15:16:36.346702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:ad41aba6-a0a6-42db-8fd5-43642f863fa7&page=queryresults
[0m15:16:36.351631 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 15:16:32.473459 => 15:16:36.351443
[0m15:16:36.353311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2e52510>]}
[0m15:16:36.354907 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (0.0 rows, 2.1 MiB processed)[0m in 3.91s]
[0m15:16:36.356892 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:16:36.358803 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:16:36.360538 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:16:36.362552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_friendlies, now model.international_football.fact_results)
[0m15:16:36.364345 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:16:36.369331 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:16:36.385101 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:16:36.365819 => 15:16:36.384666
[0m15:16:36.386805 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:16:36.390502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:36.920520 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:16:36.934440 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- fact_results.sql

-- Create fact_results table by combining data from raw_results and raw_goalscorers
WITH result_data AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.home_score,
        r.away_score,
        r.tournament,
        r.city,
        r.country,
        r.neutral,
        CASE
            WHEN r.home_score > r.away_score THEN r.home_team
            WHEN r.away_score > r.home_score THEN r.away_team
            ELSE NULL
        END AS winner
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    UNION ALL
    SELECT
        g.date,
        g.home_team,
        g.away_team,
        NULL AS home_score,
        NULL AS away_score,
        NULL AS tournament,
        NULL AS city,
        NULL AS country,
        NULL AS neutral,
        NULL AS winner
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers` g
)

SELECT
    ROW_NUMBER() OVER () AS result_id,
    rd.date,
    rd.home_team,
    rd.away_team,
    rd.home_score,
    rd.away_score,
    rd.tournament,
    rd.city,
    rd.country,
    rd.neutral,
    rd.winner,
    g.team AS goal_scorer_team,
    g.scorer AS goal_scorer,
    g.own_goal,
    g.penalty
FROM
    result_data rd
LEFT JOIN
    `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers` g
ON
    rd.date = g.date
    AND (rd.home_team = g.home_team OR rd.away_team = g.away_team)
    );
  
[0m15:16:42.292545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:91dcd627-cd02-4a3e-8ad8-2735067af2af&page=queryresults
[0m15:16:42.296790 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:16:36.388288 => 15:16:42.296584
[0m15:16:42.299713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2e1c7d0>]}
[0m15:16:42.302041 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (246.9k rows, 5.8 MiB processed)[0m in 5.94s]
[0m15:16:42.304366 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:16:42.306503 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:16:42.309779 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:16:42.311864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:16:42.313715 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:16:42.318141 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:16:42.342331 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:16:42.315419 => 15:16:42.341698
[0m15:16:42.344693 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:16:42.349991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:42.899181 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:16:42.924535 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- fact_tournaments.sql

-- Create fact_tournaments table with matches where neutral is TRUE
WITH neutral_matches AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.tournament,
        r.neutral
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    WHERE
        r.neutral = TRUE
)

SELECT
    ROW_NUMBER() OVER () AS tournament_id,
    nm.date,
    nm.home_team,
    nm.away_team,
    nm.tournament,
    nm.neutral
FROM
    neutral_matches nm
    );
  
[0m15:16:46.479242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:07bf565d-ce17-43ff-8680-5ae2d3aa8b0d&page=queryresults
[0m15:16:46.482441 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:16:42.346735 => 15:16:46.482257
[0m15:16:46.484254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ad8fcfc-295f-44a0-ab04-843c23156096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab1c2fa90>]}
[0m15:16:46.485693 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (11.2k rows, 2.1 MiB processed)[0m in 4.17s]
[0m15:16:46.488031 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:16:46.491550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:46.492737 [debug] [MainThread]: Connection 'model.international_football.fact_tournaments' was properly closed.
[0m15:16:46.493958 [info ] [MainThread]: 
[0m15:16:46.495356 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 22.77 seconds (22.77s).
[0m15:16:46.497842 [debug] [MainThread]: Command end result
[0m15:16:46.531453 [info ] [MainThread]: 
[0m15:16:46.533555 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:16:46.535700 [info ] [MainThread]: 
[0m15:16:46.537317 [error] [MainThread]: [33mDatabase Error in model dim_team_stats (models/transform/dim_team_stats.sql)[0m
[0m15:16:46.538665 [error] [MainThread]:   Unrecognized name: team at [17:9]
[0m15:16:46.540255 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_team_stats.sql
[0m15:16:46.541730 [info ] [MainThread]: 
[0m15:16:46.543035 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:16:46.544600 [debug] [MainThread]: Command `dbt run` failed at 15:16:46.544461 after 25.42 seconds
[0m15:16:46.545840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab50bc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab4a1c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab4a1f510>]}
[0m15:16:46.547340 [debug] [MainThread]: Flushing usage events
[0m15:17:43.768083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9295de4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9295ade050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9295ecfe50>]}


============================== 15:17:43.773392 | f165c656-e2b9-4741-af97-c5f41bf57378 ==============================
[0m15:17:43.773392 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:17:43.775270 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m15:17:44.168140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9293a8d510>]}
[0m15:17:44.182433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9295681e90>]}
[0m15:17:44.184492 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:17:44.231829 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:17:46.046974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:46.048539 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_team_stats.sql
[0m15:17:46.068789 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_team_stats.sql
[0m15:17:46.097276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92939b6710>]}
[0m15:17:46.131989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92939392d0>]}
[0m15:17:46.133876 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:17:46.135544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9298b63710>]}
[0m15:17:46.138398 [info ] [MainThread]: 
[0m15:17:46.140483 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:17:46.142762 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:17:46.143940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:46.826426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:17:46.828309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:47.385669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f929688a850>]}
[0m15:17:47.388069 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:47.390309 [info ] [MainThread]: 
[0m15:17:47.412253 [debug] [Thread-1 (]: Began running node model.international_football.dim_team_stats
[0m15:17:47.415193 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_team_stats ............. [RUN]
[0m15:17:47.417983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_team_stats)
[0m15:17:47.419778 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_team_stats
[0m15:17:47.430853 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_team_stats"
[0m15:17:47.449767 [debug] [Thread-1 (]: Timing info for model.international_football.dim_team_stats (compile): 15:17:47.421211 => 15:17:47.449241
[0m15:17:47.451865 [debug] [Thread-1 (]: Began executing node model.international_football.dim_team_stats
[0m15:17:47.491450 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_team_stats"
[0m15:17:47.509173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:47.516639 [debug] [Thread-1 (]: On model.international_football.dim_team_stats: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_team_stats"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_team_stats`
    
    

    OPTIONS()
    as (
      -- dim_team_stats.sql

-- Create dim_teams table with unique team names and team statistics
WITH team_stats AS (
    SELECT
        team AS team_name,
        SUM(CASE WHEN home_team = team THEN 1 ELSE 0 END) AS home_wins,
        SUM(CASE WHEN away_team = team THEN 1 ELSE 0 END) AS away_wins,
        SUM(CASE WHEN home_team = team THEN away_score ELSE home_score END) AS goals_scored,
        SUM(CASE WHEN away_team = team THEN away_score ELSE home_score END) AS goals_conceded
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY
        team
)

SELECT
    team_name,
    home_wins,
    away_wins,
    goals_scored,
    goals_conceded
FROM
    team_stats
    );
  
[0m15:17:49.027920 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: team at [17:9]')
[0m15:17:50.295311 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:52051097-75a9-49d6-a841-43ebde3e0bd0&page=queryresults
[0m15:17:50.299299 [debug] [Thread-1 (]: Timing info for model.international_football.dim_team_stats (execute): 15:17:47.453470 => 15:17:50.299002
[0m15:17:50.304317 [debug] [Thread-1 (]: Database Error in model dim_team_stats (models/transform/dim_team_stats.sql)
  Unrecognized name: team at [17:9]
  compiled Code at target/run/international_football/models/transform/dim_team_stats.sql
[0m15:17:50.306074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9293891950>]}
[0m15:17:50.307944 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model international_football.dim_team_stats .... [[31mERROR[0m in 2.89s]
[0m15:17:50.309699 [debug] [Thread-1 (]: Finished running node model.international_football.dim_team_stats
[0m15:17:50.311182 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:17:50.312658 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:17:50.314515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_team_stats, now model.international_football.dim_tournaments)
[0m15:17:50.316041 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:17:50.322094 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:17:50.336501 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:17:50.317052 => 15:17:50.336126
[0m15:17:50.337798 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:17:50.341280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:50.935947 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:17:50.956736 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create dim_tournaments table with unique tournament names
WITH tournament_teams AS (
    SELECT DISTINCT
        tournament,
        home_team AS team_name
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    UNION ALL
    SELECT DISTINCT
        tournament,
        away_team AS team_name
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)

SELECT
    ROW_NUMBER() OVER () AS tournament_id,
    tournament,
    team_name
FROM
    tournament_teams
    );
  
[0m15:17:54.466833 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:a9faab7a-537e-4523-8fa0-db595d9f7acc&page=queryresults
[0m15:17:54.482824 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:17:50.338938 => 15:17:54.482644
[0m15:17:54.485772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9293918090>]}
[0m15:17:54.487984 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (4.4k rows, 1.7 MiB processed)[0m in 4.17s]
[0m15:17:54.490659 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:17:54.493026 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:17:54.494949 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m15:17:54.497113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_friendlies)
[0m15:17:54.498926 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m15:17:54.503498 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m15:17:54.516507 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 15:17:54.500466 => 15:17:54.516144
[0m15:17:54.517878 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m15:17:54.521673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:55.099999 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m15:17:55.124618 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- fact_friendlies.sql

-- Create fact_friendlies table with friendly matches
WITH friendly_matches AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.tournament,
        r.neutral
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    WHERE
        r.tournament LIKE '%friendly%'
)

SELECT
    ROW_NUMBER() OVER () AS friendly_id,
    fm.date,
    fm.home_team,
    fm.away_team,
    fm.tournament,
    fm.neutral
FROM
    friendly_matches fm
    );
  
[0m15:17:59.026286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:e438a0df-e9c1-45ed-aaf4-fca05ead030d&page=queryresults
[0m15:17:59.031907 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 15:17:54.519001 => 15:17:59.031719
[0m15:17:59.034598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9293ab8ed0>]}
[0m15:17:59.036352 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (0.0 rows, 2.1 MiB processed)[0m in 4.54s]
[0m15:17:59.038651 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:17:59.040318 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:17:59.041874 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:17:59.043686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_friendlies, now model.international_football.fact_results)
[0m15:17:59.045181 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:17:59.050192 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:17:59.064162 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:17:59.046758 => 15:17:59.063814
[0m15:17:59.065833 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:17:59.069815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:59.810087 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:17:59.829453 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- fact_results.sql

-- Create fact_results table by combining data from raw_results and raw_goalscorers
WITH result_data AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.home_score,
        r.away_score,
        r.tournament,
        r.city,
        r.country,
        r.neutral,
        CASE
            WHEN r.home_score > r.away_score THEN r.home_team
            WHEN r.away_score > r.home_score THEN r.away_team
            ELSE NULL
        END AS winner
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    UNION ALL
    SELECT
        g.date,
        g.home_team,
        g.away_team,
        NULL AS home_score,
        NULL AS away_score,
        NULL AS tournament,
        NULL AS city,
        NULL AS country,
        NULL AS neutral,
        NULL AS winner
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers` g
)

SELECT
    ROW_NUMBER() OVER () AS result_id,
    rd.date,
    rd.home_team,
    rd.away_team,
    rd.home_score,
    rd.away_score,
    rd.tournament,
    rd.city,
    rd.country,
    rd.neutral,
    rd.winner,
    g.team AS goal_scorer_team,
    g.scorer AS goal_scorer,
    g.own_goal,
    g.penalty
FROM
    result_data rd
LEFT JOIN
    `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers` g
ON
    rd.date = g.date
    AND (rd.home_team = g.home_team OR rd.away_team = g.away_team)
    );
  
[0m15:18:04.625189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:b1cc3f2d-b072-42c1-b991-b97f59cd390d&page=queryresults
[0m15:18:04.630028 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:17:59.067340 => 15:18:04.629828
[0m15:18:04.631633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9293974790>]}
[0m15:18:04.633120 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (246.9k rows, 5.8 MiB processed)[0m in 5.59s]
[0m15:18:04.635372 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:18:04.637077 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:18:04.638368 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:18:04.640020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:18:04.641448 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:18:04.645518 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:18:04.660095 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:18:04.642546 => 15:18:04.659704
[0m15:18:04.662015 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:18:04.665147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:05.265108 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:18:05.282807 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- fact_tournaments.sql

-- Create fact_tournaments table with matches where neutral is TRUE
WITH neutral_matches AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.tournament,
        r.neutral
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    WHERE
        r.neutral = TRUE
)

SELECT
    ROW_NUMBER() OVER () AS tournament_id,
    nm.date,
    nm.home_team,
    nm.away_team,
    nm.tournament,
    nm.neutral
FROM
    neutral_matches nm
    );
  
[0m15:18:08.929211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:c64f1e4d-f6f7-4042-9272-581bd161beae&page=queryresults
[0m15:18:08.932623 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:18:04.663259 => 15:18:08.932461
[0m15:18:08.934981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f165c656-e2b9-4741-af97-c5f41bf57378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92939e2b50>]}
[0m15:18:08.937523 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (11.2k rows, 2.1 MiB processed)[0m in 4.30s]
[0m15:18:08.939740 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:18:08.942967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:08.944433 [debug] [MainThread]: Connection 'model.international_football.fact_tournaments' was properly closed.
[0m15:18:08.945628 [info ] [MainThread]: 
[0m15:18:08.946973 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 22.81 seconds (22.81s).
[0m15:18:08.949790 [debug] [MainThread]: Command end result
[0m15:18:08.980169 [info ] [MainThread]: 
[0m15:18:08.982045 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:18:08.983841 [info ] [MainThread]: 
[0m15:18:08.985502 [error] [MainThread]: [33mDatabase Error in model dim_team_stats (models/transform/dim_team_stats.sql)[0m
[0m15:18:08.986933 [error] [MainThread]:   Unrecognized name: team at [17:9]
[0m15:18:08.988442 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_team_stats.sql
[0m15:18:08.989997 [info ] [MainThread]: 
[0m15:18:08.991601 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:18:08.994145 [debug] [MainThread]: Command `dbt run` failed at 15:18:08.993943 after 25.27 seconds
[0m15:18:08.995553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9295aa0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9295962a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9293af02d0>]}
[0m15:18:08.996866 [debug] [MainThread]: Flushing usage events
[0m15:18:27.822884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35fb65750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36098e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35f46b890>]}


============================== 15:18:27.828756 | bf160ad7-721b-49ea-b56b-cf032803097f ==============================
[0m15:18:27.828756 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:18:27.831083 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True'}
[0m15:18:28.239468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35d13e290>]}
[0m15:18:28.254292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35d13e290>]}
[0m15:18:28.256635 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:18:28.303091 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:18:30.109959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:30.112409 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_team_stats.sql
[0m15:18:30.133971 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_team_stats.sql
[0m15:18:30.162742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35d05a710>]}
[0m15:18:30.188412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35cfde410>]}
[0m15:18:30.190078 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:18:30.191701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362207710>]}
[0m15:18:30.194231 [info ] [MainThread]: 
[0m15:18:30.196068 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:18:30.198290 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:18:30.199376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:31.155862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:18:31.157418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:32.094274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35d158c90>]}
[0m15:18:32.096483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:32.098228 [info ] [MainThread]: 
[0m15:18:32.112660 [debug] [Thread-1 (]: Began running node model.international_football.dim_team_stats
[0m15:18:32.114603 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_team_stats ............. [RUN]
[0m15:18:32.116917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_team_stats)
[0m15:18:32.118501 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_team_stats
[0m15:18:32.126743 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_team_stats"
[0m15:18:32.144582 [debug] [Thread-1 (]: Timing info for model.international_football.dim_team_stats (compile): 15:18:32.119779 => 15:18:32.144131
[0m15:18:32.146518 [debug] [Thread-1 (]: Began executing node model.international_football.dim_team_stats
[0m15:18:32.184643 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_team_stats"
[0m15:18:32.210657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:32.222223 [debug] [Thread-1 (]: On model.international_football.dim_team_stats: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_team_stats"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_team_stats`
    
    

    OPTIONS()
    as (
      -- dim_team_stats.sql

-- Create dim_teams table with unique team names and team statistics
WITH team_stats AS (
    SELECT
        team AS team_name,
        SUM(CASE WHEN home_team = team THEN 1 ELSE 0 END) AS home_wins,
        SUM(CASE WHEN away_team = team THEN 1 ELSE 0 END) AS away_wins,
        SUM(CASE WHEN home_team = team THEN away_score ELSE home_score END) AS goals_scored,
        SUM(CASE WHEN away_team = team THEN away_score ELSE home_score END) AS goals_conceded
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY
        team_name
)

SELECT
    team_name,
    home_wins,
    away_wins,
    goals_scored,
    goals_conceded
FROM
    team_stats
    );
  
[0m15:18:33.727927 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: team at [17:9]')
[0m15:18:35.784436 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:3deafc6d-a90f-4949-9074-dee8df91a81e&page=queryresults
[0m15:18:35.787367 [debug] [Thread-1 (]: Timing info for model.international_football.dim_team_stats (execute): 15:18:32.148420 => 15:18:35.787073
[0m15:18:35.792376 [debug] [Thread-1 (]: Database Error in model dim_team_stats (models/transform/dim_team_stats.sql)
  Unrecognized name: team at [17:9]
  compiled Code at target/run/international_football/models/transform/dim_team_stats.sql
[0m15:18:35.793995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35cfdda50>]}
[0m15:18:35.796011 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model international_football.dim_team_stats .... [[31mERROR[0m in 3.68s]
[0m15:18:35.797835 [debug] [Thread-1 (]: Finished running node model.international_football.dim_team_stats
[0m15:18:35.799851 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:18:35.801713 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:18:35.803960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_team_stats, now model.international_football.dim_tournaments)
[0m15:18:35.805456 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:18:35.812408 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:18:35.828722 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:18:35.806875 => 15:18:35.828351
[0m15:18:35.830138 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:18:35.833318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:36.430538 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:18:36.464245 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- dim_tournaments.sql

-- Create dim_tournaments table with unique tournament names
WITH tournament_teams AS (
    SELECT DISTINCT
        tournament,
        home_team AS team_name
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    UNION ALL
    SELECT DISTINCT
        tournament,
        away_team AS team_name
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)

SELECT
    ROW_NUMBER() OVER () AS tournament_id,
    tournament,
    team_name
FROM
    tournament_teams
    );
  
[0m15:18:40.077622 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:9cb40ce3-94ca-4919-bab3-66189cd2fe48&page=queryresults
[0m15:18:40.093576 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:18:35.831272 => 15:18:40.093360
[0m15:18:40.096383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35cf8f150>]}
[0m15:18:40.098806 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (4.4k rows, 1.7 MiB processed)[0m in 4.29s]
[0m15:18:40.101243 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:18:40.103929 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:18:40.105923 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m15:18:40.108123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_friendlies)
[0m15:18:40.109996 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m15:18:40.114846 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m15:18:40.131738 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 15:18:40.111835 => 15:18:40.131367
[0m15:18:40.133721 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m15:18:40.138001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:40.751754 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m15:18:40.772079 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- fact_friendlies.sql

-- Create fact_friendlies table with friendly matches
WITH friendly_matches AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.tournament,
        r.neutral
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    WHERE
        r.tournament LIKE '%friendly%'
)

SELECT
    ROW_NUMBER() OVER () AS friendly_id,
    fm.date,
    fm.home_team,
    fm.away_team,
    fm.tournament,
    fm.neutral
FROM
    friendly_matches fm
    );
  
[0m15:18:44.350649 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:3a53c10b-37e5-4ca6-b6d8-c7e70ac7fbff&page=queryresults
[0m15:18:44.353928 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 15:18:40.135412 => 15:18:44.353717
[0m15:18:44.355555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe347db3b50>]}
[0m15:18:44.356962 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (0.0 rows, 2.1 MiB processed)[0m in 4.25s]
[0m15:18:44.358883 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:18:44.360411 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:18:44.361697 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:18:44.363404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_friendlies, now model.international_football.fact_results)
[0m15:18:44.364971 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:18:44.370265 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:18:44.386950 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:18:44.366229 => 15:18:44.386577
[0m15:18:44.388489 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:18:44.392038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:44.979852 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:18:44.993967 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- fact_results.sql

-- Create fact_results table by combining data from raw_results and raw_goalscorers
WITH result_data AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.home_score,
        r.away_score,
        r.tournament,
        r.city,
        r.country,
        r.neutral,
        CASE
            WHEN r.home_score > r.away_score THEN r.home_team
            WHEN r.away_score > r.home_score THEN r.away_team
            ELSE NULL
        END AS winner
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    UNION ALL
    SELECT
        g.date,
        g.home_team,
        g.away_team,
        NULL AS home_score,
        NULL AS away_score,
        NULL AS tournament,
        NULL AS city,
        NULL AS country,
        NULL AS neutral,
        NULL AS winner
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers` g
)

SELECT
    ROW_NUMBER() OVER () AS result_id,
    rd.date,
    rd.home_team,
    rd.away_team,
    rd.home_score,
    rd.away_score,
    rd.tournament,
    rd.city,
    rd.country,
    rd.neutral,
    rd.winner,
    g.team AS goal_scorer_team,
    g.scorer AS goal_scorer,
    g.own_goal,
    g.penalty
FROM
    result_data rd
LEFT JOIN
    `airflow-data-pipeline-404012`.`international_football`.`raw_goalscorers` g
ON
    rd.date = g.date
    AND (rd.home_team = g.home_team OR rd.away_team = g.away_team)
    );
  
[0m15:18:50.421850 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:9ae60662-b01d-419f-8913-691c69b6332e&page=queryresults
[0m15:18:50.429394 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:18:44.389727 => 15:18:50.428967
[0m15:18:50.431707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35d075990>]}
[0m15:18:50.433313 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (246.9k rows, 5.8 MiB processed)[0m in 6.07s]
[0m15:18:50.435616 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:18:50.437487 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:18:50.439717 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:18:50.441530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:18:50.443075 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:18:50.447698 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:18:50.462021 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:18:50.444512 => 15:18:50.461458
[0m15:18:50.463500 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:18:50.466549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:51.059660 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:18:51.084965 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- fact_tournaments.sql

-- Create fact_tournaments table with matches where neutral is TRUE
WITH neutral_matches AS (
    SELECT
        r.date,
        r.home_team,
        r.away_team,
        r.tournament,
        r.neutral
    FROM
        `airflow-data-pipeline-404012`.`international_football`.`raw_results` r
    WHERE
        r.neutral = TRUE
)

SELECT
    ROW_NUMBER() OVER () AS tournament_id,
    nm.date,
    nm.home_team,
    nm.away_team,
    nm.tournament,
    nm.neutral
FROM
    neutral_matches nm
    );
  
[0m15:18:54.667555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:4cca03b9-5fe8-45d9-a398-bb32f16b11f4&page=queryresults
[0m15:18:54.673265 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:18:50.464649 => 15:18:54.673102
[0m15:18:54.675068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf160ad7-721b-49ea-b56b-cf032803097f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35d190cd0>]}
[0m15:18:54.676752 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (11.2k rows, 2.1 MiB processed)[0m in 4.23s]
[0m15:18:54.678639 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:18:54.681543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:54.682654 [debug] [MainThread]: Connection 'model.international_football.fact_tournaments' was properly closed.
[0m15:18:54.683925 [info ] [MainThread]: 
[0m15:18:54.685339 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 24.49 seconds (24.49s).
[0m15:18:54.688060 [debug] [MainThread]: Command end result
[0m15:18:54.720292 [info ] [MainThread]: 
[0m15:18:54.722731 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:18:54.724263 [info ] [MainThread]: 
[0m15:18:54.725908 [error] [MainThread]: [33mDatabase Error in model dim_team_stats (models/transform/dim_team_stats.sql)[0m
[0m15:18:54.727470 [error] [MainThread]:   Unrecognized name: team at [17:9]
[0m15:18:54.728978 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_team_stats.sql
[0m15:18:54.730695 [info ] [MainThread]: 
[0m15:18:54.732154 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:18:54.733789 [debug] [MainThread]: Command `dbt run` failed at 15:18:54.733588 after 26.95 seconds
[0m15:18:54.735120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3603ecf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35f5c7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35fbd8f10>]}
[0m15:18:54.736325 [debug] [MainThread]: Flushing usage events
[0m15:26:54.085907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0f459950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0f618190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0f7546d0>]}


============================== 15:26:54.091993 | 0b6c9526-6095-4b58-a519-44eddba25b20 ==============================
[0m15:26:54.091993 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:26:54.094271 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True'}
[0m15:26:54.478183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b6c9526-6095-4b58-a519-44eddba25b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0d127110>]}
[0m15:26:54.493128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b6c9526-6095-4b58-a519-44eddba25b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0f754190>]}
[0m15:26:54.496140 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:26:54.543705 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:26:56.229123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m15:26:56.230688 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_team_stats.sql
[0m15:26:56.232102 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_tournaments.sql
[0m15:26:56.233324 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_tournaments.sql
[0m15:26:56.234535 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_results.sql
[0m15:26:56.235829 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_friendlies.sql
[0m15:26:56.256614 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_team_stats.sql
[0m15:26:56.269494 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_tournaments.sql
[0m15:26:56.274326 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_tournaments.sql
[0m15:26:56.279068 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_results.sql
[0m15:26:56.283722 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_friendlies.sql
[0m15:26:56.287563 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.international_football.fact_tournaments' (models/transform/fact_tournaments.sql) depends on a node named 'dim_teams' which was not found
[0m15:26:56.289936 [debug] [MainThread]: Command `dbt run` failed at 15:26:56.289751 after 2.32 seconds
[0m15:26:56.291450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0f703610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0f734210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0f742410>]}
[0m15:26:56.293746 [debug] [MainThread]: Flushing usage events
[0m15:27:18.857521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc1eb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc0694d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc3403d0>]}


============================== 15:27:18.862473 | 30d9d669-b13b-4b7b-891b-c09b42d0435e ==============================
[0m15:27:18.862473 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:27:18.864324 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'fail_fast': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'printer_width': '80'}
[0m15:27:19.278493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30d9d669-b13b-4b7b-891b-c09b42d0435e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd9efec90>]}
[0m15:27:19.293626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30d9d669-b13b-4b7b-891b-c09b42d0435e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd9eff210>]}
[0m15:27:19.296366 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:27:19.343858 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:27:21.061357 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m15:27:21.063011 [debug] [MainThread]: Partial parsing: added file: international_football://models/transform/dim_teams.sql
[0m15:27:21.064247 [debug] [MainThread]: Partial parsing: deleted file: international_football://models/transform/dim_team_stats.sql
[0m15:27:21.065738 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_tournaments.sql
[0m15:27:21.066931 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_friendlies.sql
[0m15:27:21.068410 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_results.sql
[0m15:27:21.069776 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_tournaments.sql
[0m15:27:21.091538 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_teams.sql
[0m15:27:21.103990 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_tournaments.sql
[0m15:27:21.108850 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_friendlies.sql
[0m15:27:21.113612 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_results.sql
[0m15:27:21.118300 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_tournaments.sql
[0m15:27:21.139174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30d9d669-b13b-4b7b-891b-c09b42d0435e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd9effad0>]}
[0m15:27:21.163872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30d9d669-b13b-4b7b-891b-c09b42d0435e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd9e51a50>]}
[0m15:27:21.165873 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:27:21.167739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30d9d669-b13b-4b7b-891b-c09b42d0435e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdefbfa90>]}
[0m15:27:21.170953 [info ] [MainThread]: 
[0m15:27:21.173396 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:27:21.176705 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:27:21.178219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:21.837841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:27:21.840685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:22.446554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30d9d669-b13b-4b7b-891b-c09b42d0435e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdccdee50>]}
[0m15:27:22.448199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:22.449538 [info ] [MainThread]: 
[0m15:27:22.463586 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m15:27:22.465370 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m15:27:22.467378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m15:27:22.468870 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m15:27:22.478214 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m15:27:22.494050 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 15:27:22.469973 => 15:27:22.493582
[0m15:27:22.496165 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m15:27:22.535050 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m15:27:22.553892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:22.560340 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m15:27:27.158424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:c3904822-90a0-4cf6-8ba5-9323955ba6ca&page=queryresults
[0m15:27:27.173036 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 15:27:22.497514 => 15:27:27.172863
[0m15:27:27.175177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30d9d669-b13b-4b7b-891b-c09b42d0435e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd9dff850>]}
[0m15:27:27.177388 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.71s]
[0m15:27:27.179518 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m15:27:27.181146 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:27:27.182462 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:27:27.184169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m15:27:27.185432 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:27:27.189394 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:27:27.203583 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:27:27.186460 => 15:27:27.203221
[0m15:27:27.204953 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:27:27.215208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.958222 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:27:27.975498 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table

WITH tournament_eras AS (
    SELECT
        tournament,
        home_team AS team_name,
        CASE
            WHEN DATE >= '2000-01-01' THEN 'Modern Era'
            WHEN DATE >= '1990-01-01' THEN 'Late 20th Century'
            WHEN DATE >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
),
team_eras AS (
    SELECT
        team_name,
        era
    FROM tournament_eras
    GROUP BY team_name, era
)
SELECT
    RANK() OVER (ORDER BY tournament) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM team_eras
GROUP BY tournament, team_name
    );
  
[0m15:27:29.412815 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: tournament at [34:27]')
[0m15:27:31.635310 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:6bfa64ae-debb-47ae-8126-02ec0a57a19e&page=queryresults
[0m15:27:31.638930 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:27:27.206170 => 15:27:31.638495
[0m15:27:31.644442 [debug] [Thread-1 (]: Database Error in model dim_tournaments (models/transform/dim_tournaments.sql)
  Unrecognized name: tournament at [34:27]
  compiled Code at target/run/international_football/models/transform/dim_tournaments.sql
[0m15:27:31.646087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30d9d669-b13b-4b7b-891b-c09b42d0435e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd9389190>]}
[0m15:27:31.647667 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model international_football.dim_tournaments ... [[31mERROR[0m in 4.46s]
[0m15:27:31.649209 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:27:31.650753 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:27:31.652435 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:27:31.654478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m15:27:31.656269 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:27:31.661208 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:27:31.679823 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:27:31.657802 => 15:27:31.678918
[0m15:27:31.681827 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:27:31.685759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:32.366123 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:27:32.387132 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m15:27:36.370681 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:3e02b457-49f0-4f45-b1c9-639a8bc03913&page=queryresults
[0m15:27:36.375910 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:27:31.683249 => 15:27:36.375740
[0m15:27:36.378297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30d9d669-b13b-4b7b-891b-c09b42d0435e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd935a910>]}
[0m15:27:36.380112 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.72s]
[0m15:27:36.381950 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:27:36.383625 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:27:36.385206 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:27:36.387160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:27:36.388609 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:27:36.392627 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:27:36.405850 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:27:36.389677 => 15:27:36.405486
[0m15:27:36.407347 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:27:36.410865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:36.996659 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:27:37.013362 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m15:27:40.671051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:74c916e5-aab7-4cf7-a373-6e5f95fdf0ad&page=queryresults
[0m15:27:40.676931 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:27:36.408772 => 15:27:40.676667
[0m15:27:40.679543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30d9d669-b13b-4b7b-891b-c09b42d0435e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd9e16210>]}
[0m15:27:40.681697 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.29s]
[0m15:27:40.683931 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:27:40.685958 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:27:40.687631 [info ] [Thread-1 (]: 5 of 5 SKIP relation international_football.fact_friendlies .................... [[33mSKIP[0m]
[0m15:27:40.689582 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:27:40.693787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:40.695754 [debug] [MainThread]: Connection 'model.international_football.fact_tournaments' was properly closed.
[0m15:27:40.697624 [info ] [MainThread]: 
[0m15:27:40.699650 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 19.52 seconds (19.52s).
[0m15:27:40.702870 [debug] [MainThread]: Command end result
[0m15:27:40.728037 [info ] [MainThread]: 
[0m15:27:40.730199 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:27:40.731936 [info ] [MainThread]: 
[0m15:27:40.733350 [error] [MainThread]: [33mDatabase Error in model dim_tournaments (models/transform/dim_tournaments.sql)[0m
[0m15:27:40.734744 [error] [MainThread]:   Unrecognized name: tournament at [34:27]
[0m15:27:40.736102 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_tournaments.sql
[0m15:27:40.737509 [info ] [MainThread]: 
[0m15:27:40.739082 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m15:27:40.741560 [debug] [MainThread]: Command `dbt run` failed at 15:27:40.741043 after 21.92 seconds
[0m15:27:40.743244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc06aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc037d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdbf21710>]}
[0m15:27:40.744739 [debug] [MainThread]: Flushing usage events
[0m15:29:13.035893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fff748d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fff748d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fff29e8d0>]}


============================== 15:29:13.041360 | 5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3 ==============================
[0m15:29:13.041360 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:29:13.043075 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'no_print': 'None', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True'}
[0m15:29:13.451707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fff40ee50>]}
[0m15:29:13.467693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fff74af90>]}
[0m15:29:13.469657 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:29:13.522061 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:29:15.230548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:29:15.232399 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_tournaments.sql
[0m15:29:15.252542 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_tournaments.sql
[0m15:29:15.281264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ffd1a4f10>]}
[0m15:29:15.315353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ffd1eb510>]}
[0m15:29:15.317286 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:29:15.319014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6002367710>]}
[0m15:29:15.321754 [info ] [MainThread]: 
[0m15:29:15.323878 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:29:15.326612 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:29:15.327890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:15.880009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:29:15.882229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:16.513489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600008a910>]}
[0m15:29:16.515695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:16.517299 [info ] [MainThread]: 
[0m15:29:16.533043 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m15:29:16.535217 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m15:29:16.537360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m15:29:16.539090 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m15:29:16.549920 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m15:29:16.570222 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 15:29:16.540638 => 15:29:16.569594
[0m15:29:16.572469 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m15:29:16.591680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:17.209691 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m15:29:17.227490 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m15:29:22.327281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:5784475d-f739-44c1-949e-48299e55ba5c&page=queryresults
[0m15:29:22.344514 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 15:29:16.574408 => 15:29:22.344347
[0m15:29:22.347786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ffd1f7410>]}
[0m15:29:22.350031 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 5.81s]
[0m15:29:22.352206 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m15:29:22.354416 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:29:22.356227 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:29:22.358099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m15:29:22.359321 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:29:22.362950 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:29:22.376795 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:29:22.360386 => 15:29:22.376434
[0m15:29:22.378217 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:29:22.381500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:22.980435 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:29:22.994465 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table

WITH tournament_eras AS (
    SELECT
        DISTINCT tournament,
        home_team AS team_name,
        CASE
            WHEN DATE >= '2000-01-01' THEN 'Modern Era'
            WHEN DATE >= '1990-01-01' THEN 'Late 20th Century'
            WHEN DATE >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
),
team_eras AS (
    SELECT
        team_name,
        era
    FROM tournament_eras
    GROUP BY team_name, era
)
SELECT
    RANK() OVER (ORDER BY tournament) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM team_eras
GROUP BY tournament, team_name
    );
  
[0m15:29:24.350795 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: tournament at [34:27]')
[0m15:29:26.542835 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:c19905d9-c84d-41c0-9575-fd1aae2fb56c&page=queryresults
[0m15:29:26.545001 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:29:22.379278 => 15:29:26.544689
[0m15:29:26.550085 [debug] [Thread-1 (]: Database Error in model dim_tournaments (models/transform/dim_tournaments.sql)
  Unrecognized name: tournament at [34:27]
  compiled Code at target/run/international_football/models/transform/dim_tournaments.sql
[0m15:29:26.551853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ffd1f6290>]}
[0m15:29:26.553833 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model international_football.dim_tournaments ... [[31mERROR[0m in 4.19s]
[0m15:29:26.555577 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:29:26.557120 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:29:26.558853 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:29:26.561104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m15:29:26.562713 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:29:26.569541 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:29:26.584844 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:29:26.564148 => 15:29:26.584493
[0m15:29:26.586201 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:29:26.591142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:27.163480 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:29:27.178492 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m15:29:31.025638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:ae860311-a92e-4062-b8f9-13d91954767d&page=queryresults
[0m15:29:31.031444 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:29:26.587892 => 15:29:31.031186
[0m15:29:31.033787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ffd15f750>]}
[0m15:29:31.035862 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.47s]
[0m15:29:31.037946 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:29:31.040005 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:29:31.042904 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:29:31.045387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:29:31.047008 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:29:31.051619 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:29:31.066478 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:29:31.048310 => 15:29:31.066086
[0m15:29:31.068005 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:29:31.073007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:31.661662 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:29:31.679081 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m15:29:35.374261 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:a0de96db-40cc-44d6-86f1-215fc6af8b88&page=queryresults
[0m15:29:35.379825 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:29:31.069569 => 15:29:35.379662
[0m15:29:35.382592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bfe6a97-8d76-4c9c-bff6-9f19371a9bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ffd2e2910>]}
[0m15:29:35.385377 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.34s]
[0m15:29:35.387229 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:29:35.388879 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:29:35.390353 [info ] [Thread-1 (]: 5 of 5 SKIP relation international_football.fact_friendlies .................... [[33mSKIP[0m]
[0m15:29:35.391886 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:29:35.394880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:35.396313 [debug] [MainThread]: Connection 'model.international_football.fact_tournaments' was properly closed.
[0m15:29:35.397763 [info ] [MainThread]: 
[0m15:29:35.399597 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 20.07 seconds (20.07s).
[0m15:29:35.403432 [debug] [MainThread]: Command end result
[0m15:29:35.425972 [info ] [MainThread]: 
[0m15:29:35.427602 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:29:35.429097 [info ] [MainThread]: 
[0m15:29:35.430819 [error] [MainThread]: [33mDatabase Error in model dim_tournaments (models/transform/dim_tournaments.sql)[0m
[0m15:29:35.432747 [error] [MainThread]:   Unrecognized name: tournament at [34:27]
[0m15:29:35.434180 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_tournaments.sql
[0m15:29:35.435907 [info ] [MainThread]: 
[0m15:29:35.437634 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m15:29:35.439281 [debug] [MainThread]: Command `dbt run` failed at 15:29:35.439130 after 22.44 seconds
[0m15:29:35.440721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600054cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fff297f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fff29ee90>]}
[0m15:29:35.441980 [debug] [MainThread]: Flushing usage events
[0m15:33:03.960702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94f0d2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94f24ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94f05bb90>]}


============================== 15:33:03.966143 | 7ae2e95b-1b05-4296-87be-5458624a4cdd ==============================
[0m15:33:03.966143 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:33:03.968081 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m15:33:04.385304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ae2e95b-1b05-4296-87be-5458624a4cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94edfb050>]}
[0m15:33:04.400735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ae2e95b-1b05-4296-87be-5458624a4cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94f3b8550>]}
[0m15:33:04.403220 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:33:04.445667 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:33:06.298801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:06.300882 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_tournaments.sql
[0m15:33:06.321969 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_tournaments.sql
[0m15:33:06.353244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ae2e95b-1b05-4296-87be-5458624a4cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94cf5c450>]}
[0m15:33:06.379122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ae2e95b-1b05-4296-87be-5458624a4cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94ce81850>]}
[0m15:33:06.380683 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:33:06.382273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ae2e95b-1b05-4296-87be-5458624a4cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff951ffba10>]}
[0m15:33:06.384645 [info ] [MainThread]: 
[0m15:33:06.386559 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:33:06.389598 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:33:06.391883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:07.064858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:33:07.066756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:08.127571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ae2e95b-1b05-4296-87be-5458624a4cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94f0b1dd0>]}
[0m15:33:08.129651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:08.131215 [info ] [MainThread]: 
[0m15:33:08.148619 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m15:33:08.150381 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m15:33:08.152244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m15:33:08.153636 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m15:33:08.162042 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m15:33:08.177847 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 15:33:08.154974 => 15:33:08.177455
[0m15:33:08.179297 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m15:33:08.193422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:09.059262 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m15:33:09.079223 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m15:33:14.192762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:aa4d6988-73b0-48ea-ac78-1226cfe2a04f&page=queryresults
[0m15:33:14.210511 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 15:33:08.180332 => 15:33:14.210262
[0m15:33:14.212963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae2e95b-1b05-4296-87be-5458624a4cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94ce00690>]}
[0m15:33:14.214988 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 6.06s]
[0m15:33:14.217332 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m15:33:14.219644 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:33:14.221760 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:33:14.224043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m15:33:14.226066 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:33:14.231909 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:33:14.250156 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:33:14.227625 => 15:33:14.249450
[0m15:33:14.252003 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:33:14.256159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:14.821425 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:33:14.841364 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
),
team_eras AS (
    SELECT
        team_name,
        era
    FROM tournament_eras
    GROUP BY team_name, era
)
SELECT
    RANK() OVER (ORDER BY tournament) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM team_eras
GROUP BY tournament, team_name
    );
  
[0m15:33:16.106269 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: tournament at [34:27]')
[0m15:33:18.208979 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:de5e73c3-396b-44a8-83e5-e4ab0a887413&page=queryresults
[0m15:33:18.211135 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:33:14.254043 => 15:33:18.210777
[0m15:33:18.216150 [debug] [Thread-1 (]: Database Error in model dim_tournaments (models/transform/dim_tournaments.sql)
  Unrecognized name: tournament at [34:27]
  compiled Code at target/run/international_football/models/transform/dim_tournaments.sql
[0m15:33:18.217670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae2e95b-1b05-4296-87be-5458624a4cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94cdb41d0>]}
[0m15:33:18.219033 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model international_football.dim_tournaments ... [[31mERROR[0m in 3.99s]
[0m15:33:18.220577 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:33:18.222118 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:33:18.223591 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:33:18.225639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m15:33:18.227144 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:33:18.234188 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:33:18.249072 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:33:18.228408 => 15:33:18.248378
[0m15:33:18.251590 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:33:18.255408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:18.858420 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:33:18.874720 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m15:33:23.286461 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:4735a738-9c0f-47b4-86ef-38a2f9bb4889&page=queryresults
[0m15:33:23.292512 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:33:18.253214 => 15:33:23.292299
[0m15:33:23.295420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae2e95b-1b05-4296-87be-5458624a4cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94cde4b10>]}
[0m15:33:23.297331 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 5.07s]
[0m15:33:23.299268 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:33:23.300686 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:33:23.301926 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:33:23.303513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:33:23.304603 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:33:23.308418 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:33:23.320702 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:33:23.305563 => 15:33:23.320343
[0m15:33:23.322084 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:33:23.325204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:24.111978 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:33:24.126824 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m15:33:28.675117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:261a2554-59f2-4251-9b04-b2bcce0422cd&page=queryresults
[0m15:33:28.678390 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:33:23.323197 => 15:33:28.678205
[0m15:33:28.680341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae2e95b-1b05-4296-87be-5458624a4cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94cdaa490>]}
[0m15:33:28.682263 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 5.38s]
[0m15:33:28.684288 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:33:28.686273 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:33:28.687843 [info ] [Thread-1 (]: 5 of 5 SKIP relation international_football.fact_friendlies .................... [[33mSKIP[0m]
[0m15:33:28.689563 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:33:28.693181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:28.695186 [debug] [MainThread]: Connection 'model.international_football.fact_tournaments' was properly closed.
[0m15:33:28.697071 [info ] [MainThread]: 
[0m15:33:28.698739 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 22.31 seconds (22.31s).
[0m15:33:28.701198 [debug] [MainThread]: Command end result
[0m15:33:28.722723 [info ] [MainThread]: 
[0m15:33:28.724307 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:33:28.725857 [info ] [MainThread]: 
[0m15:33:28.727359 [error] [MainThread]: [33mDatabase Error in model dim_tournaments (models/transform/dim_tournaments.sql)[0m
[0m15:33:28.728592 [error] [MainThread]:   Unrecognized name: tournament at [34:27]
[0m15:33:28.729864 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_tournaments.sql
[0m15:33:28.731211 [info ] [MainThread]: 
[0m15:33:28.733039 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m15:33:28.735002 [debug] [MainThread]: Command `dbt run` failed at 15:33:28.734830 after 24.81 seconds
[0m15:33:28.736225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94ef9c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94f4f86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94cf567d0>]}
[0m15:33:28.737777 [debug] [MainThread]: Flushing usage events
[0m15:34:49.444793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b75ee4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b75f4ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b75ee4b50>]}


============================== 15:34:49.449828 | bf2cdab5-b299-42a7-b805-c775e0f46299 ==============================
[0m15:34:49.449828 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:34:49.451769 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80'}
[0m15:34:49.831080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf2cdab5-b299-42a7-b805-c775e0f46299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b73f4f050>]}
[0m15:34:49.844655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf2cdab5-b299-42a7-b805-c775e0f46299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b73f4b190>]}
[0m15:34:49.846478 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:34:49.893017 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:34:51.576478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:34:51.577993 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_tournaments.sql
[0m15:34:51.598037 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_tournaments.sql
[0m15:34:51.626110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf2cdab5-b299-42a7-b805-c775e0f46299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b73e6a710>]}
[0m15:34:51.653413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf2cdab5-b299-42a7-b805-c775e0f46299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b73ded850>]}
[0m15:34:51.655036 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:34:51.656514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2cdab5-b299-42a7-b805-c775e0f46299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b79017710>]}
[0m15:34:51.658709 [info ] [MainThread]: 
[0m15:34:51.660475 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:34:51.662684 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:34:51.663937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:52.242237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:34:52.243811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:52.810911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2cdab5-b299-42a7-b805-c775e0f46299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b76d3ec90>]}
[0m15:34:52.813215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:34:52.814859 [info ] [MainThread]: 
[0m15:34:52.829901 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m15:34:52.832066 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m15:34:52.835702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m15:34:52.838112 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m15:34:52.850420 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m15:34:52.871051 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 15:34:52.840117 => 15:34:52.870654
[0m15:34:52.872811 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m15:34:52.892471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:53.573146 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m15:34:53.592714 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m15:34:57.853043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:8f12935b-1677-438d-a083-deecf4d87913&page=queryresults
[0m15:34:57.867445 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 15:34:52.874453 => 15:34:57.867269
[0m15:34:57.870252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2cdab5-b299-42a7-b805-c775e0f46299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b73ded750>]}
[0m15:34:57.872926 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 5.04s]
[0m15:34:57.875401 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m15:34:57.877543 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:34:57.879504 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:34:57.881956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m15:34:57.883901 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:34:57.888564 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:34:57.905327 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:34:57.885482 => 15:34:57.904979
[0m15:34:57.907003 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:34:57.910406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:58.522769 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:34:58.537498 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name;
    );
  
[0m15:34:58.924805 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [32:31]')
[0m15:35:00.278487 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:51cb01bf-4a0f-4377-afa7-5fa4cc7cac8f&page=queryresults
[0m15:35:00.283374 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:34:57.908430 => 15:35:00.282883
[0m15:35:00.288853 [debug] [Thread-1 (]: Database Error in model dim_tournaments (models/transform/dim_tournaments.sql)
  Syntax error: Expected ")" but got ";" at [32:31]
  compiled Code at target/run/international_football/models/transform/dim_tournaments.sql
[0m15:35:00.290798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2cdab5-b299-42a7-b805-c775e0f46299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b73cc24d0>]}
[0m15:35:00.292791 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model international_football.dim_tournaments ... [[31mERROR[0m in 2.41s]
[0m15:35:00.294363 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:35:00.296082 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:35:00.297539 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:35:00.299852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m15:35:00.301665 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:35:00.308093 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:35:00.324857 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:35:00.303004 => 15:35:00.324468
[0m15:35:00.326608 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:35:00.330311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:01.174944 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:35:01.190642 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m15:35:04.946835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:88fc0c78-650d-40d9-8176-5fdc90fb7542&page=queryresults
[0m15:35:04.950362 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:35:00.328090 => 15:35:04.950190
[0m15:35:04.952006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2cdab5-b299-42a7-b805-c775e0f46299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b73f7f310>]}
[0m15:35:04.953825 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.65s]
[0m15:35:04.955930 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:35:04.957584 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:35:04.959076 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:35:04.961041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:35:04.962530 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:35:04.966599 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:35:04.980215 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:35:04.963628 => 15:35:04.979831
[0m15:35:04.982032 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:35:04.985702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:05.539818 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:35:05.556973 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m15:35:09.456342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:6eb86bc5-8d57-4871-b106-d0e123eb7f53&page=queryresults
[0m15:35:09.459818 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:35:04.983551 => 15:35:09.459594
[0m15:35:09.461390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2cdab5-b299-42a7-b805-c775e0f46299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b73d81450>]}
[0m15:35:09.462717 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.50s]
[0m15:35:09.464390 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:35:09.465796 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:35:09.467108 [info ] [Thread-1 (]: 5 of 5 SKIP relation international_football.fact_friendlies .................... [[33mSKIP[0m]
[0m15:35:09.468519 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:35:09.471205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:09.472432 [debug] [MainThread]: Connection 'model.international_football.fact_tournaments' was properly closed.
[0m15:35:09.474170 [info ] [MainThread]: 
[0m15:35:09.475893 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 17.81 seconds (17.81s).
[0m15:35:09.478384 [debug] [MainThread]: Command end result
[0m15:35:09.503316 [info ] [MainThread]: 
[0m15:35:09.505893 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:35:09.507907 [info ] [MainThread]: 
[0m15:35:09.509424 [error] [MainThread]: [33mDatabase Error in model dim_tournaments (models/transform/dim_tournaments.sql)[0m
[0m15:35:09.511066 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [32:31]
[0m15:35:09.513013 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/dim_tournaments.sql
[0m15:35:09.514557 [info ] [MainThread]: 
[0m15:35:09.516091 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m15:35:09.518119 [debug] [MainThread]: Command `dbt run` failed at 15:35:09.517813 after 20.11 seconds
[0m15:35:09.520304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b763c1990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b75f47f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b76099990>]}
[0m15:35:09.521910 [debug] [MainThread]: Flushing usage events
[0m15:35:18.160640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0fbea8bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0fb5d6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0fbad9a90>]}


============================== 15:35:18.165792 | 6bd73f46-da0b-4048-8c57-2cad7b41f97e ==============================
[0m15:35:18.165792 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:35:18.167576 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False'}
[0m15:35:18.572594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f9929e90>]}
[0m15:35:18.587395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0fbd90850>]}
[0m15:35:18.590036 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:35:18.643372 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:35:20.497073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:20.500054 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_tournaments.sql
[0m15:35:20.521357 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_tournaments.sql
[0m15:35:20.549452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f988e850>]}
[0m15:35:20.581099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f99c6390>]}
[0m15:35:20.582751 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:35:20.584476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0feb8f2d0>]}
[0m15:35:20.586734 [info ] [MainThread]: 
[0m15:35:20.588805 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:35:20.591043 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:35:20.592259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:21.172148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:35:21.174408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:21.754613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f9946290>]}
[0m15:35:21.757781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:21.759882 [info ] [MainThread]: 
[0m15:35:21.774257 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m15:35:21.776124 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m15:35:21.778186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m15:35:21.779874 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m15:35:21.788755 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m15:35:21.804608 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 15:35:21.781322 => 15:35:21.804223
[0m15:35:21.806320 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m15:35:21.819724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:22.434853 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m15:35:22.452444 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m15:35:26.835033 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:65ba5466-051e-4c55-90d0-36b4bec0e8b2&page=queryresults
[0m15:35:26.856463 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 15:35:21.807700 => 15:35:26.856294
[0m15:35:26.859178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f994f210>]}
[0m15:35:26.862197 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 5.08s]
[0m15:35:26.864812 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m15:35:26.866902 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:35:26.868547 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:35:26.870399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m15:35:26.871832 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:35:26.876243 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:35:26.890153 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:35:26.873087 => 15:35:26.889781
[0m15:35:26.891727 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:35:26.894911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:27.565326 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:35:27.586334 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m15:35:31.798013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:1211a8a5-1746-46f8-912b-2148482625c3&page=queryresults
[0m15:35:31.803834 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:35:26.892704 => 15:35:31.803512
[0m15:35:31.807532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f98614d0>]}
[0m15:35:31.810979 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.94s]
[0m15:35:31.813992 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:35:31.817066 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:35:31.818993 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:35:31.820984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m15:35:31.822853 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:35:31.827245 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:35:31.841989 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:35:31.824177 => 15:35:31.841606
[0m15:35:31.843874 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:35:31.847580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:32.510815 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:35:32.527760 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m15:35:36.496309 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:5734f516-1a8d-4af4-aa05-5c6545ac896c&page=queryresults
[0m15:35:36.502433 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:35:31.845402 => 15:35:36.502265
[0m15:35:36.504613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f9972050>]}
[0m15:35:36.506679 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.68s]
[0m15:35:36.508831 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:35:36.510338 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:35:36.511605 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:35:36.513508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:35:36.514882 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:35:36.521473 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:35:36.538269 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:35:36.516112 => 15:35:36.537871
[0m15:35:36.539778 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:35:36.543074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:37.107759 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:35:37.130130 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m15:35:41.261432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:a09abae3-417c-488a-a93e-d3814f9e1a23&page=queryresults
[0m15:35:41.266738 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:35:36.541016 => 15:35:41.266518
[0m15:35:41.268663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f989e510>]}
[0m15:35:41.270417 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.76s]
[0m15:35:41.272373 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:35:41.273714 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:35:41.275031 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m15:35:41.276713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m15:35:41.277979 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m15:35:41.282283 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m15:35:41.296196 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 15:35:41.278996 => 15:35:41.295807
[0m15:35:41.297595 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m15:35:41.300824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:41.927394 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m15:35:41.953002 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        date,
        home_team,
        away_team,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m15:35:43.345342 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: home_score at [28:15]')
[0m15:35:45.562320 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:d2bfd941-d776-45b4-8845-0d0109ec81e4&page=queryresults
[0m15:35:45.565959 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 15:35:41.298760 => 15:35:45.565447
[0m15:35:45.571405 [debug] [Thread-1 (]: Database Error in model fact_friendlies (models/transform/fact_friendlies.sql)
  Unrecognized name: home_score at [28:15]
  compiled Code at target/run/international_football/models/transform/fact_friendlies.sql
[0m15:35:45.574236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd73f46-da0b-4048-8c57-2cad7b41f97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f89d6a10>]}
[0m15:35:45.577127 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model international_football.fact_friendlies ... [[31mERROR[0m in 4.30s]
[0m15:35:45.579079 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:35:45.582338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:45.583971 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m15:35:45.585341 [info ] [MainThread]: 
[0m15:35:45.586648 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 25.00 seconds (25.00s).
[0m15:35:45.589226 [debug] [MainThread]: Command end result
[0m15:35:45.616312 [info ] [MainThread]: 
[0m15:35:45.618050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:35:45.619341 [info ] [MainThread]: 
[0m15:35:45.620678 [error] [MainThread]: [33mDatabase Error in model fact_friendlies (models/transform/fact_friendlies.sql)[0m
[0m15:35:45.621897 [error] [MainThread]:   Unrecognized name: home_score at [28:15]
[0m15:35:45.623122 [error] [MainThread]:   compiled Code at target/run/international_football/models/transform/fact_friendlies.sql
[0m15:35:45.624361 [info ] [MainThread]: 
[0m15:35:45.625614 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:35:45.627086 [debug] [MainThread]: Command `dbt run` failed at 15:35:45.626952 after 27.50 seconds
[0m15:35:45.628550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0fbe232d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0fb5e57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0fbf52f90>]}
[0m15:35:45.630204 [debug] [MainThread]: Flushing usage events
[0m15:37:30.069623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d69ec2c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6aee19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d69ed77d0>]}


============================== 15:37:30.074849 | 4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d ==============================
[0m15:37:30.074849 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:37:30.076700 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False'}
[0m15:37:30.470155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d67a76c50>]}
[0m15:37:30.484460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d67893490>]}
[0m15:37:30.486753 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:37:30.533462 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:37:32.354415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:32.356143 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_friendlies.sql
[0m15:37:32.378591 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_friendlies.sql
[0m15:37:32.405878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6791c990>]}
[0m15:37:32.435061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6791d710>]}
[0m15:37:32.437416 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:37:32.439457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6caefa10>]}
[0m15:37:32.441852 [info ] [MainThread]: 
[0m15:37:32.443831 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:37:32.446033 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:37:32.447227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:33.083393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:37:33.085295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:33.652318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d677c80d0>]}
[0m15:37:33.654525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:33.656439 [info ] [MainThread]: 
[0m15:37:33.670473 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m15:37:33.672354 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m15:37:33.674627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m15:37:33.676155 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m15:37:33.686062 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m15:37:33.706539 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 15:37:33.677867 => 15:37:33.706170
[0m15:37:33.708727 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m15:37:33.725480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:34.362463 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m15:37:34.384434 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m15:37:38.365452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:d2ba929c-fddf-4666-a6af-99dad5fde45a&page=queryresults
[0m15:37:38.380215 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 15:37:33.710389 => 15:37:38.380023
[0m15:37:38.382131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d678a7690>]}
[0m15:37:38.384002 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.71s]
[0m15:37:38.386196 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m15:37:38.387623 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:37:38.388996 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:37:38.390786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m15:37:38.392553 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:37:38.396556 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:37:38.410409 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:37:38.393870 => 15:37:38.410056
[0m15:37:38.411838 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:37:38.415222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:39.021972 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:37:39.041128 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m15:37:44.202094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:79f61269-4cc6-4a85-87e0-cc9b7bf6641e&page=queryresults
[0m15:37:44.208100 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:37:38.412930 => 15:37:44.207813
[0m15:37:44.210825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d677f4c10>]}
[0m15:37:44.213733 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 5.82s]
[0m15:37:44.216381 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:37:44.218522 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:37:44.220204 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:37:44.222071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m15:37:44.223550 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:37:44.228373 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:37:44.246339 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:37:44.224905 => 15:37:44.245685
[0m15:37:44.248999 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:37:44.252877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:45.041379 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:37:45.057328 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m15:37:48.521950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:855b6d1f-25d1-4753-8c72-99df9f6ae6f6&page=queryresults
[0m15:37:48.528284 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:37:44.250790 => 15:37:48.528087
[0m15:37:48.530028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6a4d4f90>]}
[0m15:37:48.531538 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.31s]
[0m15:37:48.533429 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:37:48.535256 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:37:48.537291 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:37:48.539197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:37:48.541080 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:37:48.548105 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:37:48.562497 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:37:48.542727 => 15:37:48.561762
[0m15:37:48.564272 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:37:48.568201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:49.109425 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:37:49.128224 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m15:37:53.267772 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:c1ee3dfb-19b5-4139-b4ea-416c3d37230e&page=queryresults
[0m15:37:53.274573 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:37:48.565794 => 15:37:53.274392
[0m15:37:53.276749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6a4d5110>]}
[0m15:37:53.278871 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.74s]
[0m15:37:53.281194 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:37:53.282858 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:37:53.284174 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m15:37:53.285961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m15:37:53.287377 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m15:37:53.292158 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m15:37:53.306252 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 15:37:53.288610 => 15:37:53.305888
[0m15:37:53.307547 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m15:37:53.310750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:53.845723 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m15:37:53.861295 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m15:38:00.920100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:f3fe3d09-63ab-4190-bf43-a4b2a6ef2daf&page=queryresults
[0m15:38:00.923420 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 15:37:53.308711 => 15:38:00.923220
[0m15:38:00.925141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bee11ab-5fbd-4ded-ae3e-aaf74e70cb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6a4d4f90>]}
[0m15:38:00.926809 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 7.64s]
[0m15:38:00.928718 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:38:00.931555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:00.932788 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m15:38:00.934084 [info ] [MainThread]: 
[0m15:38:00.935480 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 28.49 seconds (28.49s).
[0m15:38:00.938557 [debug] [MainThread]: Command end result
[0m15:38:00.971745 [info ] [MainThread]: 
[0m15:38:00.973705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:00.975257 [info ] [MainThread]: 
[0m15:38:00.976748 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:38:00.978516 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:00.978340 after 30.95 seconds
[0m15:38:00.980011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6d9e4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6da9fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6c0d0a50>]}
[0m15:38:00.981693 [debug] [MainThread]: Flushing usage events
[0m15:40:21.092068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade0faa650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddf8ceed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddf8cf490>]}


============================== 15:40:21.099197 | fb6b7c0d-037a-4303-8f27-29b9123339a6 ==============================
[0m15:40:21.099197 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:40:21.101606 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'target_path': 'None', 'debug': 'False', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None'}
[0m15:40:21.510906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddd5b7750>]}
[0m15:40:21.526900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddf8ea3d0>]}
[0m15:40:21.529000 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:40:21.581365 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:40:23.375222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:40:23.377368 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_friendlies.sql
[0m15:40:23.399903 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_friendlies.sql
[0m15:40:23.432383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddd6335d0>]}
[0m15:40:23.466394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddd6999d0>]}
[0m15:40:23.467993 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:40:23.469496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade2813a10>]}
[0m15:40:23.471761 [info ] [MainThread]: 
[0m15:40:23.473460 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:40:23.475679 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:40:23.477688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:24.024545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:40:24.026568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:24.575885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade054aa10>]}
[0m15:40:24.578920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:40:24.580490 [info ] [MainThread]: 
[0m15:40:24.594648 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m15:40:24.596683 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m15:40:24.598730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m15:40:24.600590 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m15:40:24.610040 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m15:40:24.626756 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 15:40:24.602258 => 15:40:24.626190
[0m15:40:24.628539 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m15:40:24.648335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:25.220557 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m15:40:25.240824 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m15:40:29.269719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:8e057cb5-8a8e-43d8-85de-24a821e6b947&page=queryresults
[0m15:40:29.286132 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 15:40:24.630115 => 15:40:29.285960
[0m15:40:29.288263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddd631d10>]}
[0m15:40:29.290254 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.69s]
[0m15:40:29.292889 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m15:40:29.294990 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:40:29.297054 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:40:29.298917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m15:40:29.300560 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:40:29.305631 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:40:29.321247 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:40:29.302038 => 15:40:29.320761
[0m15:40:29.323254 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:40:29.328070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:30.092019 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:40:30.112370 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m15:40:34.036435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:51e477e0-8d9b-482b-9b10-eeadd84e9f98&page=queryresults
[0m15:40:34.043966 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:40:29.324783 => 15:40:34.043366
[0m15:40:34.046536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddc5f7850>]}
[0m15:40:34.048825 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.75s]
[0m15:40:34.050791 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:40:34.052563 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:40:34.054084 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:40:34.055777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m15:40:34.057031 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:40:34.061201 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:40:34.076102 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:40:34.058142 => 15:40:34.075751
[0m15:40:34.077825 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:40:34.080636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:34.628083 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:40:34.644786 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m15:40:38.518190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:4ee42084-4bc6-47e0-8e4e-e3b838b87313&page=queryresults
[0m15:40:38.521158 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:40:34.078753 => 15:40:38.520955
[0m15:40:38.522704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddd79bed0>]}
[0m15:40:38.524116 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.47s]
[0m15:40:38.525842 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:40:38.527418 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:40:38.528896 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:40:38.530848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:40:38.532397 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:40:38.536712 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:40:38.555339 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:40:38.533703 => 15:40:38.554471
[0m15:40:38.558498 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:40:38.562158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:39.106087 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:40:39.122471 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m15:40:43.109625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:80ade29b-6b27-4f74-9417-a8fdddf28dad&page=queryresults
[0m15:40:43.115839 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:40:38.559872 => 15:40:43.115663
[0m15:40:43.118115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddfbfa010>]}
[0m15:40:43.120214 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.59s]
[0m15:40:43.122048 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:40:43.124094 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:40:43.126424 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m15:40:43.128771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m15:40:43.130789 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m15:40:43.139511 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m15:40:43.156489 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 15:40:43.132328 => 15:40:43.156126
[0m15:40:43.157848 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m15:40:43.160908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:43.722880 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m15:40:43.746233 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m15:40:51.246874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:9df87172-21d2-4a85-b087-58bea8bf21fb&page=queryresults
[0m15:40:51.250105 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 15:40:43.158934 => 15:40:51.249925
[0m15:40:51.251870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b7c0d-037a-4303-8f27-29b9123339a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddc5d8510>]}
[0m15:40:51.253411 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 8.12s]
[0m15:40:51.255107 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:40:51.257816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:51.258899 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m15:40:51.259936 [info ] [MainThread]: 
[0m15:40:51.261225 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 27.79 seconds (27.79s).
[0m15:40:51.263605 [debug] [MainThread]: Command end result
[0m15:40:51.294402 [info ] [MainThread]: 
[0m15:40:51.296507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:51.298214 [info ] [MainThread]: 
[0m15:40:51.299630 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:40:51.301264 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:51.301107 after 30.25 seconds
[0m15:40:51.302400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade3790910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade37c3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddfbd3a90>]}
[0m15:40:51.304367 [debug] [MainThread]: Flushing usage events
[0m15:41:37.004929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ffe9b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ffeb38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fffd4dd0>]}


============================== 15:41:37.010451 | 47affbc6-a04f-46b4-8650-01ba2123b5a4 ==============================
[0m15:41:37.010451 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:41:37.012438 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False'}
[0m15:41:37.429796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fdd5f850>]}
[0m15:41:37.448938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ffeb3290>]}
[0m15:41:37.451009 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:41:37.494280 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:41:39.275501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:39.277694 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_friendlies.sql
[0m15:41:39.300502 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_friendlies.sql
[0m15:41:39.328687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ffe98ed0>]}
[0m15:41:39.353579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fdac1890>]}
[0m15:41:39.355692 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:41:39.357317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc602dd7a10>]}
[0m15:41:39.359838 [info ] [MainThread]: 
[0m15:41:39.361859 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:41:39.364087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:41:39.365211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:39.921040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:41:39.923189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:40.417509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc600b0e8d0>]}
[0m15:41:40.419523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:41:40.421239 [info ] [MainThread]: 
[0m15:41:40.437595 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m15:41:40.439803 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m15:41:40.443302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m15:41:40.445670 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m15:41:40.454887 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m15:41:40.475981 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 15:41:40.447235 => 15:41:40.475390
[0m15:41:40.477932 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m15:41:40.499047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:41.057454 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m15:41:41.073957 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m15:41:45.067479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:15287553-0f0b-4b20-8954-68c194abe14e&page=queryresults
[0m15:41:45.084610 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 15:41:40.479887 => 15:41:45.084431
[0m15:41:45.087220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fdbdf690>]}
[0m15:41:45.089336 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.64s]
[0m15:41:45.091432 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m15:41:45.093306 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:41:45.095113 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:41:45.096905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m15:41:45.098447 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:41:45.102662 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:41:45.115454 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:41:45.099729 => 15:41:45.115100
[0m15:41:45.116663 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:41:45.119723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:45.685987 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:41:45.703446 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m15:41:49.577996 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:ca1b95f7-f2c8-48d4-996a-aef2b2d79797&page=queryresults
[0m15:41:49.582110 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:41:45.117642 => 15:41:49.581950
[0m15:41:49.584210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fdbe5ad0>]}
[0m15:41:49.585764 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.49s]
[0m15:41:49.587700 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:41:49.589715 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:41:49.591294 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:41:49.593124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m15:41:49.594661 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:41:49.598877 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:41:49.612564 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:41:49.595961 => 15:41:49.612197
[0m15:41:49.614169 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:41:49.617150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:50.355938 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:41:50.374705 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m15:41:54.231344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:a89a8f70-5c18-4841-b4b2-012eaf0b79bd&page=queryresults
[0m15:41:54.236445 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:41:49.615281 => 15:41:54.236276
[0m15:41:54.238632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fdbf7fd0>]}
[0m15:41:54.240816 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.65s]
[0m15:41:54.242752 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:41:54.244552 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:41:54.246041 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:41:54.247786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:41:54.249253 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:41:54.255731 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:41:54.270731 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:41:54.250555 => 15:41:54.270262
[0m15:41:54.272705 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:41:54.276316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:54.831005 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:41:54.852291 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m15:41:58.689198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:3d6b5f43-c8d2-4fbb-9beb-ee0c5a5e1c0a&page=queryresults
[0m15:41:58.692802 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:41:54.274288 => 15:41:58.692610
[0m15:41:58.694515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fdbdf1d0>]}
[0m15:41:58.696236 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.45s]
[0m15:41:58.698256 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:41:58.699566 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:41:58.700838 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m15:41:58.702477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m15:41:58.703633 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m15:41:58.708389 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m15:41:58.726672 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 15:41:58.704601 => 15:41:58.726012
[0m15:41:58.729059 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m15:41:58.732724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:59.263954 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m15:41:59.288039 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    DISTINCT f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m15:42:03.948963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:f91c4fe4-c041-401d-bd0d-1116cbd9fc5a&page=queryresults
[0m15:42:03.953456 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 15:41:58.730481 => 15:42:03.953223
[0m15:42:03.955324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47affbc6-a04f-46b4-8650-01ba2123b5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fdac0110>]}
[0m15:42:03.957112 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (17.8k rows, 2.8 MiB processed)[0m in 5.25s]
[0m15:42:03.958819 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:42:03.961768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:03.963015 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m15:42:03.964265 [info ] [MainThread]: 
[0m15:42:03.965612 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 24.60 seconds (24.60s).
[0m15:42:03.968391 [debug] [MainThread]: Command end result
[0m15:42:03.996988 [info ] [MainThread]: 
[0m15:42:03.998783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:04.000761 [info ] [MainThread]: 
[0m15:42:04.002366 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:42:04.004265 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:04.004081 after 27.04 seconds
[0m15:42:04.005458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc600032150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc600188ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ffea4c50>]}
[0m15:42:04.006705 [debug] [MainThread]: Flushing usage events
[0m15:47:13.519964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eeac37d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eeac840d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eec34e6d0>]}


============================== 15:47:13.525184 | f4dd2ae7-be20-4c9d-a83e-0c1605fade5b ==============================
[0m15:47:13.525184 [info ] [MainThread]: Running with dbt=1.5.9
[0m15:47:13.526914 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m15:47:13.910377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee8b13750>]}
[0m15:47:13.925103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee8afaa90>]}
[0m15:47:13.927385 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:47:13.974206 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m15:47:15.590977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:15.592727 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/dim_tournaments.sql
[0m15:47:15.614060 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_tournaments.sql
[0m15:47:15.642527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee89bee10>]}
[0m15:47:15.674567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee8b23ed0>]}
[0m15:47:15.677190 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:47:15.679457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eedbc76d0>]}
[0m15:47:15.682107 [info ] [MainThread]: 
[0m15:47:15.684213 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:47:15.687280 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m15:47:15.688700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:16.248597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m15:47:16.252500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:16.795892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eeb8eaa10>]}
[0m15:47:16.799703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:16.802402 [info ] [MainThread]: 
[0m15:47:16.816933 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m15:47:16.819455 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m15:47:16.821971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m15:47:16.823611 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m15:47:16.831759 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m15:47:16.849969 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 15:47:16.824681 => 15:47:16.849568
[0m15:47:16.851910 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m15:47:16.866887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:17.422541 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m15:47:17.447144 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m15:47:21.603470 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:312d1613-5a07-4098-89ea-e8fb39767044&page=queryresults
[0m15:47:21.620641 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 15:47:16.853651 => 15:47:21.620465
[0m15:47:21.623811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eeac873d0>]}
[0m15:47:21.626485 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.80s]
[0m15:47:21.628684 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m15:47:21.630174 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m15:47:21.631525 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m15:47:21.633456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m15:47:21.635028 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m15:47:21.639141 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m15:47:21.659786 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 15:47:21.636250 => 15:47:21.659437
[0m15:47:21.661428 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m15:47:21.665141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:22.232018 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m15:47:22.250479 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament, team_name) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m15:47:26.015631 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:d5d17ffd-1fb6-485a-8ef6-f38f4f421a03&page=queryresults
[0m15:47:26.021630 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 15:47:21.662868 => 15:47:26.021437
[0m15:47:26.023736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee89bf3d0>]}
[0m15:47:26.025582 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.39s]
[0m15:47:26.027489 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m15:47:26.029304 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m15:47:26.031079 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m15:47:26.033394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m15:47:26.034768 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m15:47:26.039045 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m15:47:26.052579 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 15:47:26.035967 => 15:47:26.052201
[0m15:47:26.055050 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m15:47:26.058875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:26.593772 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m15:47:26.613721 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m15:47:30.151393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:610e3714-e21b-4c10-8249-620b1978c858&page=queryresults
[0m15:47:30.155291 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 15:47:26.056304 => 15:47:30.155028
[0m15:47:30.158304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee8a1dc10>]}
[0m15:47:30.160611 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.13s]
[0m15:47:30.163130 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m15:47:30.165683 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m15:47:30.168059 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m15:47:30.170842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m15:47:30.173496 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m15:47:30.185115 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m15:47:30.211191 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 15:47:30.175648 => 15:47:30.210528
[0m15:47:30.213509 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m15:47:30.219831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:30.771239 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m15:47:30.794609 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m15:47:34.232523 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:8f707101-89fd-4a78-872e-b98332b6bd32&page=queryresults
[0m15:47:34.238058 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 15:47:30.215595 => 15:47:34.237875
[0m15:47:34.241122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee8a49910>]}
[0m15:47:34.243423 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.07s]
[0m15:47:34.245793 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m15:47:34.247988 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m15:47:34.249644 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m15:47:34.251481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m15:47:34.252999 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m15:47:34.257747 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m15:47:34.272093 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 15:47:34.254312 => 15:47:34.271747
[0m15:47:34.273444 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m15:47:34.276971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:34.815669 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m15:47:34.829788 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    DISTINCT f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m15:47:51.200551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:7af1a22c-6251-4bd0-a74c-1a5be44de910&page=queryresults
[0m15:47:51.207791 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 15:47:34.274632 => 15:47:51.207547
[0m15:47:51.210535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4dd2ae7-be20-4c9d-a83e-0c1605fade5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee8b1c050>]}
[0m15:47:51.212844 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 16.96s]
[0m15:47:51.214973 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m15:47:51.219119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:51.220599 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m15:47:51.222288 [info ] [MainThread]: 
[0m15:47:51.223856 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 35.54 seconds (35.54s).
[0m15:47:51.226996 [debug] [MainThread]: Command end result
[0m15:47:51.257098 [info ] [MainThread]: 
[0m15:47:51.258955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:51.260535 [info ] [MainThread]: 
[0m15:47:51.262126 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:47:51.263952 [debug] [MainThread]: Command `dbt run` succeeded at 15:47:51.263746 after 37.78 seconds
[0m15:47:51.265391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eeb510390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eeeb87890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eeeb94b10>]}
[0m15:47:51.266918 [debug] [MainThread]: Flushing usage events
[0m18:13:25.580617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a95cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a9a0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a95d7d0>]}


============================== 18:13:25.586520 | 9447ca57-bb73-42b7-bd82-dd9aa0f0a2b8 ==============================
[0m18:13:25.586520 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:13:25.588707 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True'}
[0m18:13:25.622587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9447ca57-bb73-42b7-bd82-dd9aa0f0a2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a95d7d0>]}
[0m18:13:25.631403 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p1hl5p_d'
[0m18:13:25.633414 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:13:26.020694 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:13:26.024170 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:13:26.112766 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:13:26.123930 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:13:33.642027 [info ] [MainThread]: Installed from version 1.1.1
[0m18:13:33.643750 [info ] [MainThread]: Up to date!
[0m18:13:33.645224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9447ca57-bb73-42b7-bd82-dd9aa0f0a2b8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a950f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a51e510>]}
[0m18:13:33.647484 [debug] [MainThread]: Command `dbt deps` succeeded at 18:13:33.647285 after 8.11 seconds
[0m18:13:33.648892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5e4b6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5e3d6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5e580d50>]}
[0m18:13:33.650330 [debug] [MainThread]: Flushing usage events
[0m18:13:37.144505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48371b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48371b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd483ec5a10>]}


============================== 18:13:37.149892 | 3b0f7f80-b03f-402f-8c14-7f277eed91f7 ==============================
[0m18:13:37.149892 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:13:37.151857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'quiet': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'introspect': 'True'}
[0m18:13:37.740944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd482a74e10>]}
[0m18:13:37.756259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd482a75890>]}
[0m18:13:37.758659 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m18:13:37.808787 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:13:39.907870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:39.909843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:39.918511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4841f6010>]}
[0m18:13:39.950510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd481c09f10>]}
[0m18:13:39.951789 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m18:13:39.953253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd481c3ab50>]}
[0m18:13:39.956656 [info ] [MainThread]: 
[0m18:13:39.958650 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:13:39.961639 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m18:13:39.964075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:40.539217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m18:13:40.541534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:41.123043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd481c13110>]}
[0m18:13:41.124699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:41.125900 [info ] [MainThread]: 
[0m18:13:41.141215 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m18:13:41.143059 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m18:13:41.145132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m18:13:41.146565 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m18:13:41.155695 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m18:13:41.173178 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 18:13:41.147997 => 18:13:41.172854
[0m18:13:41.175998 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m18:13:41.189623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:41.820676 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m18:13:41.842742 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m18:13:45.772010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:86a6a677-f2db-4900-bbb7-89ec99bf6f5a&page=queryresults
[0m18:13:45.796702 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 18:13:41.177366 => 18:13:45.796443
[0m18:13:45.798792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd481be1f90>]}
[0m18:13:45.800761 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.65s]
[0m18:13:45.802853 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m18:13:45.804553 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m18:13:45.805972 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m18:13:45.807746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m18:13:45.809388 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m18:13:45.813303 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m18:13:45.831947 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 18:13:45.810736 => 18:13:45.831609
[0m18:13:45.833739 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m18:13:45.838060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:46.429272 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m18:13:46.446485 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament, team_name) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m18:13:50.443190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:833bf95c-b086-480f-8a70-b342479f3eca&page=queryresults
[0m18:13:50.447012 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 18:13:45.835354 => 18:13:50.446829
[0m18:13:50.449562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd481c51650>]}
[0m18:13:50.451664 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.64s]
[0m18:13:50.453645 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m18:13:50.455239 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m18:13:50.458132 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m18:13:50.460213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m18:13:50.462056 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m18:13:50.466341 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m18:13:50.488041 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 18:13:50.463537 => 18:13:50.487732
[0m18:13:50.490107 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m18:13:50.493696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:51.286696 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m18:13:51.302836 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m18:13:54.921792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:66dc404c-22fc-4520-854e-27d7feaf0aad&page=queryresults
[0m18:13:54.925048 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 18:13:50.491988 => 18:13:54.924872
[0m18:13:54.926592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd483d61c10>]}
[0m18:13:54.928019 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.47s]
[0m18:13:54.929582 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m18:13:54.930986 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m18:13:54.932356 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m18:13:54.935099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m18:13:54.937579 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m18:13:54.945301 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m18:13:54.961651 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 18:13:54.940129 => 18:13:54.961309
[0m18:13:54.963191 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m18:13:54.966462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:55.567855 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m18:13:55.592718 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m18:13:59.442424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:83b60907-28f6-46cf-8e85-7bc5f5f235f5&page=queryresults
[0m18:13:59.447482 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 18:13:54.964525 => 18:13:59.447218
[0m18:13:59.449516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd481c38290>]}
[0m18:13:59.451328 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.51s]
[0m18:13:59.453189 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m18:13:59.455049 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m18:13:59.456903 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m18:13:59.459202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m18:13:59.461687 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m18:13:59.466922 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m18:13:59.492127 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 18:13:59.463509 => 18:13:59.491810
[0m18:13:59.494508 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m18:13:59.498573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:00.056380 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m18:14:00.071136 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    DISTINCT f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m18:14:12.756568 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:55122099-ab51-4e3e-a455-1eab0201085a&page=queryresults
[0m18:14:12.760900 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 18:13:59.496466 => 18:14:12.760721
[0m18:14:12.763975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0f7f80-b03f-402f-8c14-7f277eed91f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd481a97010>]}
[0m18:14:12.765885 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 13.31s]
[0m18:14:12.767634 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m18:14:12.771112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:12.772308 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m18:14:12.773671 [info ] [MainThread]: 
[0m18:14:12.775134 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 32.82 seconds (32.82s).
[0m18:14:12.777549 [debug] [MainThread]: Command end result
[0m18:14:12.812311 [info ] [MainThread]: 
[0m18:14:12.814026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:12.815784 [info ] [MainThread]: 
[0m18:14:12.817341 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:14:12.818996 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:12.818871 after 35.72 seconds
[0m18:14:12.820514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd483cda150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd483c17e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd483ba7210>]}
[0m18:14:12.823252 [debug] [MainThread]: Flushing usage events
[0m18:40:41.009616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcd13cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fce9cd950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fccab5a50>]}


============================== 18:40:41.014806 | 10037f84-cee2-4d4c-948f-d0996494e9b9 ==============================
[0m18:40:41.014806 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:40:41.016539 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m18:40:41.046662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10037f84-cee2-4d4c-948f-d0996494e9b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fccacfc50>]}
[0m18:40:41.052839 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f1k3x921'
[0m18:40:41.054394 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:40:41.219416 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:40:41.224478 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:40:41.313729 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:40:41.327494 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:40:48.932671 [info ] [MainThread]: Installed from version 1.1.1
[0m18:40:48.934530 [info ] [MainThread]: Up to date!
[0m18:40:48.935973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '10037f84-cee2-4d4c-948f-d0996494e9b9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fccffe090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fccfb1ed0>]}
[0m18:40:48.938356 [debug] [MainThread]: Command `dbt deps` succeeded at 18:40:48.938117 after 7.96 seconds
[0m18:40:48.940942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd1043d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd10103d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd0ea6410>]}
[0m18:40:48.942574 [debug] [MainThread]: Flushing usage events
[0m18:40:52.614016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b47c0a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b47f20e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b47c39010>]}


============================== 18:40:52.619078 | 708208be-3eec-4de2-834c-0a6bbd0eb5d7 ==============================
[0m18:40:52.619078 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:40:52.620502 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False'}
[0m18:40:53.141145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b45ac28d0>]}
[0m18:40:53.160973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b45ad7110>]}
[0m18:40:53.163080 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m18:40:53.212759 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:40:55.162722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:40:55.164212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:40:55.171704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b47c25e50>]}
[0m18:40:55.194734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b459362d0>]}
[0m18:40:55.196270 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m18:40:55.197714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4ab57790>]}
[0m18:40:55.199974 [info ] [MainThread]: 
[0m18:40:55.201677 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:40:55.203812 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m18:40:55.205030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:55.758508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m18:40:55.759853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:56.285403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b458ec110>]}
[0m18:40:56.288448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:56.289920 [info ] [MainThread]: 
[0m18:40:56.303603 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m18:40:56.305062 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m18:40:56.308360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m18:40:56.309698 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m18:40:56.317771 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m18:40:56.332504 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 18:40:56.310739 => 18:40:56.332149
[0m18:40:56.333849 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m18:40:56.348856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:56.950276 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m18:40:56.968586 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m18:41:01.158707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:722f63f7-963d-461d-aa30-355a9b44be18&page=queryresults
[0m18:41:01.183147 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 18:40:56.334971 => 18:41:01.182951
[0m18:41:01.185320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b45837fd0>]}
[0m18:41:01.187012 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.88s]
[0m18:41:01.192015 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m18:41:01.194094 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m18:41:01.195996 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m18:41:01.197901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m18:41:01.199441 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m18:41:01.203717 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m18:41:01.225460 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 18:41:01.200835 => 18:41:01.224920
[0m18:41:01.227223 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m18:41:01.234177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:01.801303 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m18:41:01.831580 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament, team_name) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m18:41:05.954184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:f1900e14-4d89-409f-8c8f-f4fae38bdeaf&page=queryresults
[0m18:41:05.957912 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 18:41:01.231682 => 18:41:05.957729
[0m18:41:05.960639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b45ad7c10>]}
[0m18:41:05.962495 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.76s]
[0m18:41:05.964174 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m18:41:05.965649 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m18:41:05.966994 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m18:41:05.969044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m18:41:05.971620 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m18:41:05.976961 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m18:41:05.994732 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 18:41:05.973290 => 18:41:05.994393
[0m18:41:05.996524 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m18:41:05.999627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:06.582926 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m18:41:06.600543 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m18:41:10.235898 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:f9e67a3c-56b7-4c9f-93f5-5c65ea067478&page=queryresults
[0m18:41:10.244803 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 18:41:05.997782 => 18:41:10.244335
[0m18:41:10.249025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b45857110>]}
[0m18:41:10.254098 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.28s]
[0m18:41:10.257062 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m18:41:10.259259 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m18:41:10.261349 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m18:41:10.263766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m18:41:10.265691 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m18:41:10.276998 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m18:41:10.295772 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 18:41:10.267601 => 18:41:10.295431
[0m18:41:10.298189 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m18:41:10.302713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:10.889178 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m18:41:10.907069 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m18:41:14.707024 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:cbac2421-a389-4417-981b-53655c9ffb98&page=queryresults
[0m18:41:14.710235 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 18:41:10.300695 => 18:41:14.710052
[0m18:41:14.714409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4575dfd0>]}
[0m18:41:14.716424 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.45s]
[0m18:41:14.718413 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m18:41:14.719776 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m18:41:14.721133 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m18:41:14.722868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m18:41:14.724225 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m18:41:14.728716 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m18:41:14.744496 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 18:41:14.725539 => 18:41:14.744164
[0m18:41:14.745841 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m18:41:14.748853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:15.319435 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m18:41:15.336949 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    DISTINCT f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m18:41:28.486643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:42fcd2d2-f815-4b70-b2b3-cc646399402e&page=queryresults
[0m18:41:28.490577 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 18:41:14.746920 => 18:41:28.490405
[0m18:41:28.493019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708208be-3eec-4de2-834c-0a6bbd0eb5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4596b910>]}
[0m18:41:28.496242 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 13.77s]
[0m18:41:28.498436 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m18:41:28.502303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:28.504272 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m18:41:28.506254 [info ] [MainThread]: 
[0m18:41:28.508515 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 33.30 seconds (33.30s).
[0m18:41:28.511193 [debug] [MainThread]: Command end result
[0m18:41:28.547599 [info ] [MainThread]: 
[0m18:41:28.549274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:28.550882 [info ] [MainThread]: 
[0m18:41:28.552503 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:41:28.554373 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:28.554135 after 35.97 seconds
[0m18:41:28.557497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b47ad2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b47db1890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b47b5d910>]}
[0m18:41:28.559521 [debug] [MainThread]: Flushing usage events
[0m18:45:06.858538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac514150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac313e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac35dd50>]}


============================== 18:45:06.864565 | 065a9f56-306a-4a01-95e6-9f7622ea3222 ==============================
[0m18:45:06.864565 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:45:06.866421 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m18:45:06.900497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '065a9f56-306a-4a01-95e6-9f7622ea3222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac7c4dd0>]}
[0m18:45:06.909906 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o6nh5m02'
[0m18:45:06.911950 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:45:07.261574 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:45:07.264706 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:45:07.362971 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:45:07.374039 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:45:15.125167 [info ] [MainThread]: Installed from version 1.1.1
[0m18:45:15.127189 [info ] [MainThread]: Up to date!
[0m18:45:15.129137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '065a9f56-306a-4a01-95e6-9f7622ea3222', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac50bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac354b10>]}
[0m18:45:15.131782 [debug] [MainThread]: Command `dbt deps` succeeded at 18:45:15.131516 after 8.31 seconds
[0m18:45:15.133599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac0aa190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac0a9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b00f24d0>]}
[0m18:45:15.137131 [debug] [MainThread]: Flushing usage events
[0m18:45:18.877172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fb382bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fb6a8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fb3d5b50>]}


============================== 18:45:18.884509 | bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4 ==============================
[0m18:45:18.884509 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:45:18.886771 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m18:45:19.319740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fb381b90>]}
[0m18:45:19.339702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fb3a6190>]}
[0m18:45:19.342110 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m18:45:19.392815 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:45:21.215369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:21.218168 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:21.224400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fae072d0>]}
[0m18:45:21.255605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f92be2d0>]}
[0m18:45:21.258909 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m18:45:21.260947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fe36fc10>]}
[0m18:45:21.263583 [info ] [MainThread]: 
[0m18:45:21.265698 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:45:21.268565 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m18:45:21.270267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:21.776309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m18:45:21.779325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:22.462363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f92674d0>]}
[0m18:45:22.464936 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:22.467104 [info ] [MainThread]: 
[0m18:45:22.482000 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m18:45:22.483992 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m18:45:22.485803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m18:45:22.487366 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m18:45:22.494909 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m18:45:22.512280 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 18:45:22.488598 => 18:45:22.511942
[0m18:45:22.513444 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m18:45:22.527962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:23.426685 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m18:45:23.451921 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m18:45:26.965145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:0e4c1d9f-d4bb-4fab-b7b7-5c72f2afd23f&page=queryresults
[0m18:45:26.991830 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 18:45:22.514591 => 18:45:26.991643
[0m18:45:26.994491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f928df90>]}
[0m18:45:26.996702 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.51s]
[0m18:45:26.999681 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m18:45:27.001526 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m18:45:27.003351 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m18:45:27.005179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m18:45:27.006631 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m18:45:27.011082 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m18:45:27.035958 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 18:45:27.008449 => 18:45:27.035639
[0m18:45:27.039185 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m18:45:27.042954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:27.596824 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m18:45:27.613192 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament, team_name) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m18:45:31.643561 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:45d0a42b-b25b-4cf7-97e9-f977a2b54953&page=queryresults
[0m18:45:31.648141 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 18:45:27.041173 => 18:45:31.647869
[0m18:45:31.651407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f91b6f50>]}
[0m18:45:31.654042 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.65s]
[0m18:45:31.656667 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m18:45:31.659481 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m18:45:31.662350 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m18:45:31.664454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m18:45:31.666545 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m18:45:31.670874 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m18:45:31.692083 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 18:45:31.668279 => 18:45:31.691773
[0m18:45:31.693692 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m18:45:31.696951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:32.255590 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m18:45:32.277882 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m18:45:36.017903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:73a22b3b-f340-41ce-8485-7ec2cfba69db&page=queryresults
[0m18:45:36.022669 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 18:45:31.695038 => 18:45:36.022372
[0m18:45:36.024644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f92940d0>]}
[0m18:45:36.026216 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.36s]
[0m18:45:36.028199 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m18:45:36.029786 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m18:45:36.031660 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m18:45:36.034044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m18:45:36.035831 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m18:45:36.045106 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m18:45:36.063484 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 18:45:36.037160 => 18:45:36.063084
[0m18:45:36.065652 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m18:45:36.069442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:36.608754 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m18:45:36.624367 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m18:45:40.043826 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:55f5eb14-c14d-4ece-bbb8-56230c2ca2cf&page=queryresults
[0m18:45:40.048095 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 18:45:36.067346 => 18:45:40.047928
[0m18:45:40.050343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f90a5250>]}
[0m18:45:40.052244 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.02s]
[0m18:45:40.054203 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m18:45:40.056469 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m18:45:40.058106 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m18:45:40.060229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m18:45:40.063044 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m18:45:40.067479 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m18:45:40.088149 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 18:45:40.064337 => 18:45:40.087690
[0m18:45:40.090069 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m18:45:40.093287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:40.614008 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m18:45:40.633639 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    DISTINCT f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m18:45:57.764096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:8775037f-8555-4671-90a4-b2508023962b&page=queryresults
[0m18:45:57.771325 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 18:45:40.091367 => 18:45:57.771048
[0m18:45:57.773996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcd6cc4-e7c9-4980-95ec-6177db3a7eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fc046e10>]}
[0m18:45:57.776188 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 17.71s]
[0m18:45:57.778559 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m18:45:57.782795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:57.784701 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m18:45:57.787414 [info ] [MainThread]: 
[0m18:45:57.790225 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 36.52 seconds (36.52s).
[0m18:45:57.793087 [debug] [MainThread]: Command end result
[0m18:45:57.834674 [info ] [MainThread]: 
[0m18:45:57.836833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:57.838774 [info ] [MainThread]: 
[0m18:45:57.840637 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:45:57.842929 [debug] [MainThread]: Command `dbt run` succeeded at 18:45:57.842804 after 39.01 seconds
[0m18:45:57.844681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fb381ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fb6b7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ff31fdd0>]}
[0m18:45:57.847170 [debug] [MainThread]: Flushing usage events
[0m20:40:47.633344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef1ec7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef207ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef2063b10>]}


============================== 20:40:47.639321 | 8b02ad39-1384-4ce7-ba6c-7c7aef413d13 ==============================
[0m20:40:47.639321 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:40:47.641697 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m20:40:47.673007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b02ad39-1384-4ce7-ba6c-7c7aef413d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef1ec7610>]}
[0m20:40:47.681444 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uytfymep'
[0m20:40:47.683391 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:40:48.011607 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:40:48.015187 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:40:48.099603 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:40:48.110144 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:40:56.028060 [info ] [MainThread]: Installed from version 1.1.1
[0m20:40:56.029933 [info ] [MainThread]: Up to date!
[0m20:40:56.034381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8b02ad39-1384-4ce7-ba6c-7c7aef413d13', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef1857e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef5c1e410>]}
[0m20:40:56.036733 [debug] [MainThread]: Command `dbt deps` succeeded at 20:40:56.036529 after 8.45 seconds
[0m20:40:56.038217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef2010090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef5dbbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef32aca90>]}
[0m20:40:56.039986 [debug] [MainThread]: Flushing usage events
[0m20:41:00.568118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d39217e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3910dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d38f708d0>]}


============================== 20:41:00.575005 | cb1ab649-d289-44cf-998d-af76a9e361a2 ==============================
[0m20:41:00.575005 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:41:00.576925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'warn_error': 'None', 'use_colors': 'True'}
[0m20:41:01.131339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d36c37090>]}
[0m20:41:01.147480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d38d88110>]}
[0m20:41:01.149803 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:41:01.201369 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m20:41:02.898646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:02.900093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:02.905892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d39088190>]}
[0m20:41:02.937698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d36c82090>]}
[0m20:41:02.939713 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m20:41:02.941592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3beabc90>]}
[0m20:41:02.944774 [info ] [MainThread]: 
[0m20:41:02.947064 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:41:02.950065 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m20:41:02.953252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:03.477307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m20:41:03.480161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:04.002414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d38d8a210>]}
[0m20:41:04.004338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:04.005938 [info ] [MainThread]: 
[0m20:41:04.048279 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m20:41:04.050173 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m20:41:04.052944 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.international_football.dim_teams'
[0m20:41:04.055978 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m20:41:04.065104 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m20:41:04.083978 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 20:41:04.057758 => 20:41:04.083608
[0m20:41:04.085426 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m20:41:04.103253 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:41:04.660279 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m20:41:04.682162 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m20:41:09.072707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:29457d52-7c7e-40dd-a185-8b1ed3ae0859&page=queryresults
[0m20:41:09.096291 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 20:41:04.086695 => 20:41:09.096074
[0m20:41:09.098473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3925c350>]}
[0m20:41:09.100351 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 5.05s]
[0m20:41:09.102096 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m20:41:09.103811 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m20:41:09.105602 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m20:41:09.107533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m20:41:09.108626 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m20:41:09.112243 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m20:41:09.130853 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 20:41:09.109689 => 20:41:09.130530
[0m20:41:09.132223 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m20:41:09.136858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:09.642874 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m20:41:09.662171 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament, team_name) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m20:41:13.617252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:fbcddd28-7fd6-4776-bbb8-c2d8658bfd6e&page=queryresults
[0m20:41:13.621154 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 20:41:09.133446 => 20:41:13.620965
[0m20:41:13.623292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d36cf44d0>]}
[0m20:41:13.625413 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.52s]
[0m20:41:13.627619 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m20:41:13.629665 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m20:41:13.631431 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m20:41:13.633432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m20:41:13.634931 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m20:41:13.641912 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m20:41:13.658540 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 20:41:13.638094 => 20:41:13.658101
[0m20:41:13.661013 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m20:41:13.664214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:14.459557 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m20:41:14.477059 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m20:41:18.135023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:df76a0b8-14d7-466d-aae9-c3f37107e98c&page=queryresults
[0m20:41:18.141373 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 20:41:13.662348 => 20:41:18.141045
[0m20:41:18.143313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d36c44250>]}
[0m20:41:18.145787 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.51s]
[0m20:41:18.147983 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m20:41:18.150814 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m20:41:18.153642 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m20:41:18.157496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m20:41:18.159372 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m20:41:18.166380 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m20:41:18.184249 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 20:41:18.161005 => 20:41:18.183914
[0m20:41:18.186814 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m20:41:18.190667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:18.720669 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m20:41:18.736655 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m20:41:22.192452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:48df51a1-dbb9-468c-99f5-c55d3dda07ca&page=queryresults
[0m20:41:22.196287 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 20:41:18.188794 => 20:41:22.196126
[0m20:41:22.199070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d36a7c2d0>]}
[0m20:41:22.200995 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.04s]
[0m20:41:22.202849 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m20:41:22.204373 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m20:41:22.205910 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m20:41:22.208125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m20:41:22.209602 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m20:41:22.214464 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m20:41:22.241494 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 20:41:22.211693 => 20:41:22.241150
[0m20:41:22.244093 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m20:41:22.247575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:22.770221 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m20:41:22.784946 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    DISTINCT f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m20:41:37.277607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:98cdcc52-0ff2-4427-8ac9-b52e740cc602&page=queryresults
[0m20:41:37.281746 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 20:41:22.245447 => 20:41:37.281148
[0m20:41:37.284675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb1ab649-d289-44cf-998d-af76a9e361a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d36cee910>]}
[0m20:41:37.286647 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 15.08s]
[0m20:41:37.288552 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m20:41:37.291845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:37.293404 [debug] [MainThread]: Connection 'list_airflow-data-pipeline-404012_international_football' was properly closed.
[0m20:41:37.294977 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m20:41:37.296322 [info ] [MainThread]: 
[0m20:41:37.297857 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 34.35 seconds (34.35s).
[0m20:41:37.300114 [debug] [MainThread]: Command end result
[0m20:41:37.334807 [info ] [MainThread]: 
[0m20:41:37.336487 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:37.338130 [info ] [MainThread]: 
[0m20:41:37.339675 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:41:37.342177 [debug] [MainThread]: Command `dbt run` succeeded at 20:41:37.341525 after 36.81 seconds
[0m20:41:37.344218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3924c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3ce5be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3925c110>]}
[0m20:41:37.346047 [debug] [MainThread]: Flushing usage events
[0m20:48:19.596922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458372d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4583a28290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4583520ed0>]}


============================== 20:48:19.602496 | 94c5e781-464f-43dc-94cf-efc71535e2ab ==============================
[0m20:48:19.602496 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:48:19.604575 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'version_check': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'indirect_selection': 'eager'}
[0m20:48:19.637548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94c5e781-464f-43dc-94cf-efc71535e2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45838d8790>]}
[0m20:48:19.645284 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rhya2_l1'
[0m20:48:19.647182 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:48:19.801619 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:48:19.806325 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:48:19.898944 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:48:19.910703 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:48:27.226884 [info ] [MainThread]: Installed from version 1.1.1
[0m20:48:27.228898 [info ] [MainThread]: Up to date!
[0m20:48:27.232897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '94c5e781-464f-43dc-94cf-efc71535e2ab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45836fdf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45838d8b10>]}
[0m20:48:27.235811 [debug] [MainThread]: Command `dbt deps` succeeded at 20:48:27.235541 after 7.68 seconds
[0m20:48:27.237503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45836cb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4587617d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45839f4fd0>]}
[0m20:48:27.239202 [debug] [MainThread]: Flushing usage events
[0m20:48:30.546897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4a6b5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4a3c2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4a6b4990>]}


============================== 20:48:30.553233 | 09539692-b56b-4a91-8b42-4192ddd5d3f9 ==============================
[0m20:48:30.553233 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:48:30.555404 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m20:48:30.974802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4828b790>]}
[0m20:48:30.989157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a49c33c90>]}
[0m20:48:30.991734 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:48:31.051056 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m20:48:32.748820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:32.749996 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:32.757323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4817c050>]}
[0m20:48:32.786091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a480af4d0>]}
[0m20:48:32.787609 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m20:48:32.789096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4d313c50>]}
[0m20:48:32.791579 [info ] [MainThread]: 
[0m20:48:32.794914 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:48:32.797264 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m20:48:32.798881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:33.520861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m20:48:33.522636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:34.146106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48933550>]}
[0m20:48:34.148300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:48:34.150109 [info ] [MainThread]: 
[0m20:48:34.164502 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m20:48:34.166641 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m20:48:34.169243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m20:48:34.171094 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m20:48:34.179857 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m20:48:34.202778 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 20:48:34.172562 => 20:48:34.202466
[0m20:48:34.204804 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m20:48:34.219536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:35.024979 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m20:48:35.040538 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m20:48:39.120240 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:a08528ab-8524-47ca-bd77-57f2740daa3a&page=queryresults
[0m20:48:39.140375 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 20:48:34.206995 => 20:48:39.140189
[0m20:48:39.142427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a47ffe9d0>]}
[0m20:48:39.144008 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.97s]
[0m20:48:39.146264 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m20:48:39.148229 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m20:48:39.150435 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m20:48:39.152429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m20:48:39.154633 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m20:48:39.159268 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m20:48:39.174073 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 20:48:39.156579 => 20:48:39.173525
[0m20:48:39.176354 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m20:48:39.179809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:39.744540 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m20:48:39.761500 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament, team_name) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m20:48:44.148648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:e00f1725-8222-4e7f-a3c4-1db1fb88f495&page=queryresults
[0m20:48:44.152728 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 20:48:39.177619 => 20:48:44.152535
[0m20:48:44.156236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a47fd3050>]}
[0m20:48:44.158808 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 5.00s]
[0m20:48:44.160996 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m20:48:44.162854 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m20:48:44.164670 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m20:48:44.166857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m20:48:44.168812 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m20:48:44.173410 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m20:48:44.194584 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 20:48:44.170519 => 20:48:44.194048
[0m20:48:44.198208 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m20:48:44.201936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:44.762575 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m20:48:44.778895 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m20:48:48.593358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:b3038d6a-1d8a-4596-92c5-8daff6f024f5&page=queryresults
[0m20:48:48.598945 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 20:48:44.199888 => 20:48:48.598595
[0m20:48:48.601384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4800f110>]}
[0m20:48:48.603826 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.43s]
[0m20:48:48.605553 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m20:48:48.607413 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m20:48:48.609146 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m20:48:48.611498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m20:48:48.613399 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m20:48:48.622368 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m20:48:48.640158 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 20:48:48.614827 => 20:48:48.639831
[0m20:48:48.641809 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m20:48:48.645198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:49.345093 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m20:48:49.362021 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m20:48:53.321782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:a8325de6-c8bd-40cf-8cb0-9e8482de6f97&page=queryresults
[0m20:48:53.325490 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 20:48:48.643057 => 20:48:53.325323
[0m20:48:53.327762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a47fb7190>]}
[0m20:48:53.330331 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.72s]
[0m20:48:53.332634 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m20:48:53.335117 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m20:48:53.337564 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m20:48:53.340791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m20:48:53.342584 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m20:48:53.347265 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m20:48:53.369294 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 20:48:53.344409 => 20:48:53.368943
[0m20:48:53.371387 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m20:48:53.374756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:53.890857 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m20:48:53.905571 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    DISTINCT f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m20:49:11.852978 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:29ed7aae-510b-4bde-beb8-025769ee7f7d&page=queryresults
[0m20:49:11.857787 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 20:48:53.372930 => 20:49:11.857607
[0m20:49:11.860831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09539692-b56b-4a91-8b42-4192ddd5d3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48135450>]}
[0m20:49:11.864282 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 18.52s]
[0m20:49:11.866538 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m20:49:11.870254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:11.871763 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m20:49:11.873609 [info ] [MainThread]: 
[0m20:49:11.875337 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 39.08 seconds (39.08s).
[0m20:49:11.878270 [debug] [MainThread]: Command end result
[0m20:49:11.911790 [info ] [MainThread]: 
[0m20:49:11.913263 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:49:11.914585 [info ] [MainThread]: 
[0m20:49:11.915933 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:49:11.917449 [debug] [MainThread]: Command `dbt run` succeeded at 20:49:11.917339 after 41.42 seconds
[0m20:49:11.918683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4a6b5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4a373dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4e2c3e50>]}
[0m20:49:11.919834 [debug] [MainThread]: Flushing usage events
[0m20:51:21.185765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5685ef1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5685e571d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5685ba68d0>]}


============================== 20:51:21.190758 | af15c9c9-abd2-466d-bd62-34236a93df1b ==============================
[0m20:51:21.190758 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:51:21.192661 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'fail_fast': 'False', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default'}
[0m20:51:21.223179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af15c9c9-abd2-466d-bd62-34236a93df1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56860524d0>]}
[0m20:51:21.234173 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o3jf1jsi'
[0m20:51:21.237586 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:51:21.326255 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:51:21.329984 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:51:21.451970 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:51:21.463013 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:51:28.730081 [info ] [MainThread]: Installed from version 1.1.1
[0m20:51:28.731602 [info ] [MainThread]: Up to date!
[0m20:51:28.733218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'af15c9c9-abd2-466d-bd62-34236a93df1b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5685fdbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5685b9ff90>]}
[0m20:51:28.735440 [debug] [MainThread]: Command `dbt deps` succeeded at 20:51:28.735230 after 7.59 seconds
[0m20:51:28.736839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56872e8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5689a924d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5689a92410>]}
[0m20:51:28.738556 [debug] [MainThread]: Flushing usage events
[0m20:51:31.941320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334c6a8c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334c284b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334beea910>]}


============================== 20:51:31.946825 | cf959d3e-8d81-4d10-8528-7af6856fba8e ==============================
[0m20:51:31.946825 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:51:31.949366 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'target_path': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'log_cache_events': 'False'}
[0m20:51:32.367580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334c890fd0>]}
[0m20:51:32.383365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334c273c90>]}
[0m20:51:32.386469 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:51:32.434541 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m20:51:34.324837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:34.326382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:34.332412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334c598f10>]}
[0m20:51:34.364405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334a253510>]}
[0m20:51:34.366703 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m20:51:34.368615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334f4b3950>]}
[0m20:51:34.371382 [info ] [MainThread]: 
[0m20:51:34.373577 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:51:34.376638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m20:51:34.378452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:34.902136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m20:51:34.904161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:35.485381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334bf08750>]}
[0m20:51:35.487835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:35.489664 [info ] [MainThread]: 
[0m20:51:35.507112 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m20:51:35.509100 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m20:51:35.511433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m20:51:35.513175 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m20:51:35.525979 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m20:51:35.550177 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 20:51:35.514768 => 20:51:35.549692
[0m20:51:35.552427 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m20:51:35.574243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:36.106202 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m20:51:36.130986 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m20:51:39.769523 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:daf4d296-d066-4d0f-83f4-b11804f0d9c3&page=queryresults
[0m20:51:39.789393 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 20:51:35.554501 => 20:51:39.789176
[0m20:51:39.791453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334a07edd0>]}
[0m20:51:39.793267 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.28s]
[0m20:51:39.795051 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m20:51:39.796788 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m20:51:39.798242 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m20:51:39.800111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m20:51:39.802192 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m20:51:39.806909 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m20:51:39.825281 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 20:51:39.804044 => 20:51:39.824935
[0m20:51:39.826908 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m20:51:39.830292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:40.350551 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m20:51:40.371547 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament, team_name) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m20:51:44.448972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:0d8b6dd2-2437-4a1f-88df-03211dfbfbd3&page=queryresults
[0m20:51:44.452321 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 20:51:39.828246 => 20:51:44.452139
[0m20:51:44.454657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334a2b2d50>]}
[0m20:51:44.456776 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.65s]
[0m20:51:44.458926 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m20:51:44.460474 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m20:51:44.461992 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m20:51:44.465263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m20:51:44.467028 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m20:51:44.471171 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m20:51:44.487038 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 20:51:44.468283 => 20:51:44.486707
[0m20:51:44.488603 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m20:51:44.491607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:45.046918 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m20:51:45.059884 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m20:51:48.658271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:4c87bd69-4462-42fe-a040-c0926681b016&page=queryresults
[0m20:51:48.664050 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 20:51:44.489741 => 20:51:48.663643
[0m20:51:48.667957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334a1a0c10>]}
[0m20:51:48.671620 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.20s]
[0m20:51:48.674196 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m20:51:48.676269 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m20:51:48.678146 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m20:51:48.680085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m20:51:48.681785 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m20:51:48.692628 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m20:51:48.710655 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 20:51:48.683410 => 20:51:48.710324
[0m20:51:48.712018 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m20:51:48.715365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:49.310985 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m20:51:49.328349 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m20:51:52.762865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:cccd7149-355e-489d-854c-663c3f2d89ed&page=queryresults
[0m20:51:52.768176 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 20:51:48.713193 => 20:51:52.767950
[0m20:51:52.770741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334a263790>]}
[0m20:51:52.773101 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.09s]
[0m20:51:52.775367 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m20:51:52.777054 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m20:51:52.778737 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m20:51:52.780522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m20:51:52.782036 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m20:51:52.788428 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m20:51:52.810365 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 20:51:52.783181 => 20:51:52.809869
[0m20:51:52.812554 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m20:51:52.816546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:53.347302 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m20:51:53.366697 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    DISTINCT f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m20:52:06.910375 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:824933ce-36bf-40d0-be59-86c6dcb3fab4&page=queryresults
[0m20:52:06.914269 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 20:51:52.814284 => 20:52:06.914016
[0m20:52:06.916434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf959d3e-8d81-4d10-8528-7af6856fba8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334c598ed0>]}
[0m20:52:06.920091 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 14.14s]
[0m20:52:06.922194 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m20:52:06.926406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:06.928171 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m20:52:06.930811 [info ] [MainThread]: 
[0m20:52:06.932601 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 32.56 seconds (32.56s).
[0m20:52:06.935358 [debug] [MainThread]: Command end result
[0m20:52:06.965759 [info ] [MainThread]: 
[0m20:52:06.967278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:06.968765 [info ] [MainThread]: 
[0m20:52:06.971153 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:52:06.972836 [debug] [MainThread]: Command `dbt run` succeeded at 20:52:06.972675 after 35.07 seconds
[0m20:52:06.974260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334befbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334c85d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33502d6550>]}
[0m20:52:06.975542 [debug] [MainThread]: Flushing usage events
[0m20:53:20.122990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51935d1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5193fee150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5193b94b50>]}


============================== 20:53:20.128763 | 2ad7f1cc-da7b-47c9-957c-e2e2869e083b ==============================
[0m20:53:20.128763 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:53:20.131114 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:53:20.160373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ad7f1cc-da7b-47c9-957c-e2e2869e083b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51935d15d0>]}
[0m20:53:20.170126 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-z0h1zjok'
[0m20:53:20.172212 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:53:20.515038 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:53:20.518924 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:53:20.611305 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:53:20.622290 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:53:27.779305 [info ] [MainThread]: Installed from version 1.1.1
[0m20:53:27.781010 [info ] [MainThread]: Up to date!
[0m20:53:27.782965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2ad7f1cc-da7b-47c9-957c-e2e2869e083b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5193919750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5193a56ed0>]}
[0m20:53:27.784964 [debug] [MainThread]: Command `dbt deps` succeeded at 20:53:27.784811 after 7.69 seconds
[0m20:53:27.786228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5197657d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5197598210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51974d4410>]}
[0m20:53:27.787483 [debug] [MainThread]: Flushing usage events
[0m20:53:31.038105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80837bced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80837c9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8083497e50>]}


============================== 20:53:31.042948 | 9f31f9de-042a-4a36-89cf-c3ddc3d317ca ==============================
[0m20:53:31.042948 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:53:31.044422 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'write_json': 'True'}
[0m20:53:31.440338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8081300f50>]}
[0m20:53:31.457078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8083615850>]}
[0m20:53:31.459851 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:53:31.523353 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m20:53:33.225516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:53:33.227114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:53:33.233958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8083614750>]}
[0m20:53:33.263250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808133e090>]}
[0m20:53:33.265636 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m20:53:33.267989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8086567c50>]}
[0m20:53:33.272724 [info ] [MainThread]: 
[0m20:53:33.275953 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:53:33.279234 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m20:53:33.282101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:33.840372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m20:53:33.841977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:34.367334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808428ae50>]}
[0m20:53:34.369423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:34.371164 [info ] [MainThread]: 
[0m20:53:34.386251 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m20:53:34.388527 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m20:53:34.390817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m20:53:34.393820 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m20:53:34.402879 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m20:53:34.424985 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 20:53:34.395746 => 20:53:34.424602
[0m20:53:34.426707 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m20:53:34.441242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:35.109592 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m20:53:35.126118 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m20:53:39.437345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:6248234b-f1d5-42ef-9c45-95780576414d&page=queryresults
[0m20:53:39.459867 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 20:53:34.428268 => 20:53:39.459665
[0m20:53:39.461920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8081302c10>]}
[0m20:53:39.463606 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 5.07s]
[0m20:53:39.465531 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m20:53:39.467058 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m20:53:39.468606 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m20:53:39.470543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m20:53:39.471822 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m20:53:39.477021 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m20:53:39.496234 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 20:53:39.473055 => 20:53:39.495684
[0m20:53:39.498352 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m20:53:39.502865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:40.329319 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m20:53:40.349711 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament, team_name) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m20:53:44.420213 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:a5f6d980-606b-4aa1-afcd-8dd3447753bb&page=queryresults
[0m20:53:44.423476 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 20:53:39.500363 => 20:53:44.423295
[0m20:53:44.425352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808137bed0>]}
[0m20:53:44.427035 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.96s]
[0m20:53:44.428726 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m20:53:44.430065 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m20:53:44.431249 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m20:53:44.432766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m20:53:44.434014 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m20:53:44.438817 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m20:53:44.455049 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 20:53:44.436022 => 20:53:44.454116
[0m20:53:44.458340 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m20:53:44.461897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:45.024284 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m20:53:45.041592 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m20:53:48.557537 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:5dc8902b-5999-46dc-a11d-5954f7ad6083&page=queryresults
[0m20:53:48.562992 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 20:53:44.459959 => 20:53:48.562734
[0m20:53:48.565586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808428ae50>]}
[0m20:53:48.568004 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.13s]
[0m20:53:48.572033 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m20:53:48.574162 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m20:53:48.577780 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m20:53:48.580549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m20:53:48.582457 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m20:53:48.591231 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m20:53:48.611423 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 20:53:48.584063 => 20:53:48.610913
[0m20:53:48.613296 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m20:53:48.618981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:49.218713 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m20:53:49.235176 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 1 ELSE 0 END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m20:53:52.993121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:0c84158c-515f-41f1-af70-cf9a503d7f2d&page=queryresults
[0m20:53:53.000355 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 20:53:48.615094 => 20:53:53.000042
[0m20:53:53.003315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8081261810>]}
[0m20:53:53.005530 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.42s]
[0m20:53:53.007640 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m20:53:53.009897 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m20:53:53.012306 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m20:53:53.015390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m20:53:53.017305 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m20:53:53.023083 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m20:53:53.051015 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 20:53:53.019788 => 20:53:53.050685
[0m20:53:53.052897 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m20:53:53.058621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:53.658888 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m20:53:53.673307 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    DISTINCT f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m20:54:07.770962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:8918db2a-49df-4628-9016-e6f4e7bf8275&page=queryresults
[0m20:54:07.776237 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 20:53:53.054893 => 20:54:07.776074
[0m20:54:07.777823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f31f9de-042a-4a36-89cf-c3ddc3d317ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808116be90>]}
[0m20:54:07.779768 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 14.76s]
[0m20:54:07.782898 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m20:54:07.786322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:07.787568 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m20:54:07.789369 [info ] [MainThread]: 
[0m20:54:07.791012 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 34.51 seconds (34.51s).
[0m20:54:07.793152 [debug] [MainThread]: Command end result
[0m20:54:07.827794 [info ] [MainThread]: 
[0m20:54:07.829763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:07.831320 [info ] [MainThread]: 
[0m20:54:07.832890 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:54:07.834742 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:07.834629 after 36.83 seconds
[0m20:54:07.836054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80874e4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8087517e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808737a5d0>]}
[0m20:54:07.837148 [debug] [MainThread]: Flushing usage events
[0m21:17:46.339536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146811a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14682afa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1468409e90>]}


============================== 21:17:46.344877 | 062dd247-d773-44b3-8bd3-60bc93cad389 ==============================
[0m21:17:46.344877 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:17:46.346782 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False'}
[0m21:17:46.379849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '062dd247-d773-44b3-8bd3-60bc93cad389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1468118c50>]}
[0m21:17:46.389390 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7vuwlmku'
[0m21:17:46.391882 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:17:46.562445 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:17:46.565972 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:17:46.654164 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:17:46.665782 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:17:53.881281 [info ] [MainThread]: Installed from version 1.1.1
[0m21:17:53.883196 [info ] [MainThread]: Up to date!
[0m21:17:53.884796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '062dd247-d773-44b3-8bd3-60bc93cad389', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1467f95390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1467f95150>]}
[0m21:17:53.886850 [debug] [MainThread]: Command `dbt deps` succeeded at 21:17:53.886650 after 7.59 seconds
[0m21:17:53.888380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146c01fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14682bb5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1468247510>]}
[0m21:17:53.890022 [debug] [MainThread]: Flushing usage events
[0m21:17:57.753397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187f35cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187f059910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187f35c490>]}


============================== 21:17:57.760725 | 1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45 ==============================
[0m21:17:57.760725 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:17:57.762937 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m21:17:58.193664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187e8d8e10>]}
[0m21:17:58.210620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187e8cb350>]}
[0m21:17:58.213272 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:17:58.273322 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:18:00.144464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:18:00.146122 [debug] [MainThread]: Partial parsing: updated file: international_football://models/transform/fact_tournaments.sql
[0m21:18:00.256307 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_tournaments.sql
[0m21:18:00.286994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187cd2c810>]}
[0m21:18:00.318259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187cc85790>]}
[0m21:18:00.321397 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m21:18:00.323727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1881fabc90>]}
[0m21:18:00.326452 [info ] [MainThread]: 
[0m21:18:00.328740 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:18:00.332211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-data-pipeline-404012'
[0m21:18:00.334056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:01.175857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012, now list_airflow-data-pipeline-404012_international_football)
[0m21:18:01.178324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:02.235650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187fccad90>]}
[0m21:18:02.238022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:02.240178 [info ] [MainThread]: 
[0m21:18:02.263895 [debug] [Thread-1 (]: Began running node model.international_football.dim_teams
[0m21:18:02.266242 [info ] [Thread-1 (]: 1 of 5 START sql table model international_football.dim_teams .................. [RUN]
[0m21:18:02.269185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-data-pipeline-404012_international_football, now model.international_football.dim_teams)
[0m21:18:02.271355 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_teams
[0m21:18:02.293494 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_teams"
[0m21:18:02.334637 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (compile): 21:18:02.273077 => 21:18:02.334114
[0m21:18:02.336595 [debug] [Thread-1 (]: Began executing node model.international_football.dim_teams
[0m21:18:02.358309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:03.060023 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_teams"
[0m21:18:03.081889 [debug] [Thread-1 (]: On model.international_football.dim_teams: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_teams"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_teams`
    
    

    OPTIONS()
    as (
      -- Create the dim_teams table

WITH team_stats AS (
    SELECT
        home_team AS team_name,
        SUM(CASE WHEN home_score > away_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN home_score < away_score THEN 1 ELSE 0 END) AS losses,
        SUM(home_score) AS goals_scored,
        SUM(away_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY home_team
    UNION ALL
    SELECT
        away_team AS team_name,
        SUM(CASE WHEN away_score > home_score THEN 1 ELSE 0 END) AS wins,
        SUM(CASE WHEN away_score < home_score THEN 1 ELSE 0 END) AS losses,
        SUM(away_score) AS goals_scored,
        SUM(home_score) AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    GROUP BY away_team
    UNION ALL
    SELECT
        home_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
    UNION ALL
    SELECT
        away_team AS team_name,
        0 AS wins,
        0 AS losses,
        0 AS goals_scored,
        0 AS goals_conceded
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_shootouts`
)
SELECT
    RANK() OVER (ORDER BY team_name) AS team_id,
    team_name,
    SUM(wins) AS total_wins,
    SUM(losses) AS total_losses,
    SUM(goals_scored) AS total_goals_scored,
    SUM(goals_conceded) AS total_goals_conceded
FROM team_stats
GROUP BY team_name
    );
  
[0m21:18:07.157700 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:47235ac4-3f25-482d-8898-0b79a2ec2b2e&page=queryresults
[0m21:18:07.175265 [debug] [Thread-1 (]: Timing info for model.international_football.dim_teams (execute): 21:18:02.338068 => 21:18:07.174923
[0m21:18:07.177788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187ce25790>]}
[0m21:18:07.179594 [info ] [Thread-1 (]: 1 of 5 OK created sql table model international_football.dim_teams ............. [[32mCREATE TABLE (317.0 rows, 1.6 MiB processed)[0m in 4.91s]
[0m21:18:07.181787 [debug] [Thread-1 (]: Finished running node model.international_football.dim_teams
[0m21:18:07.183922 [debug] [Thread-1 (]: Began running node model.international_football.dim_tournaments
[0m21:18:07.185324 [info ] [Thread-1 (]: 2 of 5 START sql table model international_football.dim_tournaments ............ [RUN]
[0m21:18:07.186858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_teams, now model.international_football.dim_tournaments)
[0m21:18:07.187942 [debug] [Thread-1 (]: Began compiling node model.international_football.dim_tournaments
[0m21:18:07.191479 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.dim_tournaments"
[0m21:18:07.207175 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (compile): 21:18:07.188957 => 21:18:07.206821
[0m21:18:07.209071 [debug] [Thread-1 (]: Began executing node model.international_football.dim_tournaments
[0m21:18:07.212743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:07.830125 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.dim_tournaments"
[0m21:18:07.845807 [debug] [Thread-1 (]: On model.international_football.dim_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.dim_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the dim_tournaments table with references to dim_teams

WITH tournament_eras AS (
    SELECT
        r.tournament,
        r.home_team AS team_name,
        CASE
            WHEN r.date >= '2000-01-01' THEN 'Modern Era'
            WHEN r.date >= '1990-01-01' THEN 'Late 20th Century'
            WHEN r.date >= '1980-01-01' THEN '1980s'
            ELSE 'Earlier'
        END AS era
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results` AS r
)
SELECT
    RANK() OVER (ORDER BY tournament, team_name) AS tournament_id,
    tournament,
    team_name,
    STRING_AGG(DISTINCT era, ', ') AS eras
FROM tournament_eras
GROUP BY tournament, team_name
    );
  
[0m21:18:11.918774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:6da15ee5-ad51-4278-8929-02ac1613bd48&page=queryresults
[0m21:18:11.923746 [debug] [Thread-1 (]: Timing info for model.international_football.dim_tournaments (execute): 21:18:07.210603 => 21:18:11.922921
[0m21:18:11.926352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187cc95b90>]}
[0m21:18:11.928321 [info ] [Thread-1 (]: 2 of 5 OK created sql table model international_football.dim_tournaments ....... [[32mCREATE TABLE (2.1k rows, 1.6 MiB processed)[0m in 4.74s]
[0m21:18:11.931033 [debug] [Thread-1 (]: Finished running node model.international_football.dim_tournaments
[0m21:18:11.933902 [debug] [Thread-1 (]: Began running node model.international_football.fact_results
[0m21:18:11.936223 [info ] [Thread-1 (]: 3 of 5 START sql table model international_football.fact_results ............... [RUN]
[0m21:18:11.939089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.dim_tournaments, now model.international_football.fact_results)
[0m21:18:11.941809 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_results
[0m21:18:11.949131 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_results"
[0m21:18:11.971405 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (compile): 21:18:11.944789 => 21:18:11.970890
[0m21:18:11.974242 [debug] [Thread-1 (]: Began executing node model.international_football.fact_results
[0m21:18:11.978764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:12.553034 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_results"
[0m21:18:12.573161 [debug] [Thread-1 (]: On model.international_football.fact_results: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_results"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_results`
    
    

    OPTIONS()
    as (
      -- Create the fact_results table with references to dim_teams

WITH results AS (
    SELECT
        date,
        home_team,
        away_team,
        home_score,
        away_score
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    date,
    home_team,
    away_team,
    home_score,
    away_score,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM results
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON results.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON results.away_team = t2.team_name
    );
  
[0m21:18:16.311348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:2ff1c946-3a00-4a70-8ae8-28c1c989dd77&page=queryresults
[0m21:18:16.317843 [debug] [Thread-1 (]: Timing info for model.international_football.fact_results (execute): 21:18:11.976135 => 21:18:16.317624
[0m21:18:16.321277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187f358e90>]}
[0m21:18:16.324088 [info ] [Thread-1 (]: 3 of 5 OK created sql table model international_football.fact_results .......... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.38s]
[0m21:18:16.327270 [debug] [Thread-1 (]: Finished running node model.international_football.fact_results
[0m21:18:16.329757 [debug] [Thread-1 (]: Began running node model.international_football.fact_tournaments
[0m21:18:16.331481 [info ] [Thread-1 (]: 4 of 5 START sql table model international_football.fact_tournaments ........... [RUN]
[0m21:18:16.333670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_results, now model.international_football.fact_tournaments)
[0m21:18:16.335316 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_tournaments
[0m21:18:16.346492 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_tournaments"
[0m21:18:16.365572 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (compile): 21:18:16.336854 => 21:18:16.364650
[0m21:18:16.367374 [debug] [Thread-1 (]: Began executing node model.international_football.fact_tournaments
[0m21:18:16.370897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:16.952108 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_tournaments"
[0m21:18:16.968237 [debug] [Thread-1 (]: On model.international_football.fact_tournaments: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_tournaments"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_tournaments`
    
    

    OPTIONS()
    as (
      -- Create the fact_tournaments table with references to dim_teams

WITH tournament_results AS (
    SELECT
        date,
        home_team,
        away_team,
        CASE WHEN home_score > away_score THEN home_team
             WHEN home_score < away_score THEN away_team
             ELSE 'Draw'
        END AS result
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
)
SELECT
    t.date,
    t.home_team,
    t.away_team,
    t.result,
    CASE WHEN t.result = t.home_team THEN 'Yes' ELSE 'No' END AS home_team_win,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id
FROM tournament_results AS t
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON t.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON t.away_team = t2.team_name
    );
  
[0m21:18:20.761881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:c313dffd-0112-4522-b5c9-0e081fbd1ac4&page=queryresults
[0m21:18:20.767367 [debug] [Thread-1 (]: Timing info for model.international_football.fact_tournaments (execute): 21:18:16.368772 => 21:18:20.767092
[0m21:18:20.769928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187cd33ad0>]}
[0m21:18:20.772378 [info ] [Thread-1 (]: 4 of 5 OK created sql table model international_football.fact_tournaments ...... [[32mCREATE TABLE (45.1k rows, 1.9 MiB processed)[0m in 4.44s]
[0m21:18:20.774986 [debug] [Thread-1 (]: Finished running node model.international_football.fact_tournaments
[0m21:18:20.777175 [debug] [Thread-1 (]: Began running node model.international_football.fact_friendlies
[0m21:18:20.779323 [info ] [Thread-1 (]: 5 of 5 START sql table model international_football.fact_friendlies ............ [RUN]
[0m21:18:20.781437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.international_football.fact_tournaments, now model.international_football.fact_friendlies)
[0m21:18:20.782710 [debug] [Thread-1 (]: Began compiling node model.international_football.fact_friendlies
[0m21:18:20.788153 [debug] [Thread-1 (]: Writing injected SQL for node "model.international_football.fact_friendlies"
[0m21:18:20.809324 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (compile): 21:18:20.783867 => 21:18:20.809010
[0m21:18:20.811199 [debug] [Thread-1 (]: Began executing node model.international_football.fact_friendlies
[0m21:18:20.814648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:21.966137 [debug] [Thread-1 (]: Writing runtime sql for node "model.international_football.fact_friendlies"
[0m21:18:21.983000 [debug] [Thread-1 (]: On model.international_football.fact_friendlies: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "international_football", "target_name": "dev", "node_id": "model.international_football.fact_friendlies"} */

  
    

    create or replace table `airflow-data-pipeline-404012`.`international_football`.`fact_friendlies`
    
    

    OPTIONS()
    as (
      -- Create the fact_friendlies table with references to dim_teams and dim_tournaments

WITH friendlies AS (
    SELECT
        DISTINCT date,
        home_team,
        away_team,
        home_score,
        away_score,
        tournament
    FROM `airflow-data-pipeline-404012`.`international_football`.`raw_results`
    WHERE tournament LIKE '%Friendly'
)
SELECT
    DISTINCT f.date,
    f.home_team,
    f.away_team,
    f.tournament,
    CASE WHEN home_score > away_score THEN home_team
         WHEN home_score < away_score THEN away_team
         ELSE 'Draw'
    END AS result,
    t1.team_id AS home_team_id,
    t2.team_id AS away_team_id,
    dt.tournament_id AS tournament_id
FROM friendlies AS f
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t1 ON f.home_team = t1.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_teams` AS t2 ON f.away_team = t2.team_name
JOIN `airflow-data-pipeline-404012`.`international_football`.`dim_tournaments` AS dt ON f.tournament = dt.tournament
    );
  
[0m21:18:36.565268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-data-pipeline-404012&j=bq:US:0285ce7a-c2d8-4e29-8caa-5776fa064aa7&page=queryresults
[0m21:18:36.570804 [debug] [Thread-1 (]: Timing info for model.international_football.fact_friendlies (execute): 21:18:20.812680 => 21:18:36.570546
[0m21:18:36.573438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fe5a8bc-028e-4279-9bc6-1e0a3ccf5e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187cd0e3d0>]}
[0m21:18:36.575902 [info ] [Thread-1 (]: 5 of 5 OK created sql table model international_football.fact_friendlies ....... [[32mCREATE TABLE (4.5m rows, 2.8 MiB processed)[0m in 15.79s]
[0m21:18:36.578473 [debug] [Thread-1 (]: Finished running node model.international_football.fact_friendlies
[0m21:18:36.582519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:36.584247 [debug] [MainThread]: Connection 'model.international_football.fact_friendlies' was properly closed.
[0m21:18:36.585918 [info ] [MainThread]: 
[0m21:18:36.587632 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 36.26 seconds (36.26s).
[0m21:18:36.591788 [debug] [MainThread]: Command end result
[0m21:18:36.626565 [info ] [MainThread]: 
[0m21:18:36.628132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:36.631119 [info ] [MainThread]: 
[0m21:18:36.632776 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:18:36.634804 [debug] [MainThread]: Command `dbt run` succeeded at 21:18:36.634638 after 38.93 seconds
[0m21:18:36.636420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187f0476d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187f229f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1882f5be50>]}
[0m21:18:36.637795 [debug] [MainThread]: Flushing usage events
